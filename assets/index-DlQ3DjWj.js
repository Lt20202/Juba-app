(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(l){if(l.ep)return;l.ep=!0;const o=n(l);fetch(l.href,o)}})();function Mu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var rc={exports:{}},$s={},nc={exports:{}},ee={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var An=Symbol.for("react.element"),Du=Symbol.for("react.portal"),Ou=Symbol.for("react.fragment"),zu=Symbol.for("react.strict_mode"),Bu=Symbol.for("react.profiler"),Vu=Symbol.for("react.provider"),Fu=Symbol.for("react.context"),Wu=Symbol.for("react.forward_ref"),Hu=Symbol.for("react.suspense"),$u=Symbol.for("react.memo"),Uu=Symbol.for("react.lazy"),zi=Symbol.iterator;function Gu(e){return e===null||typeof e!="object"?null:(e=zi&&e[zi]||e["@@iterator"],typeof e=="function"?e:null)}var sc={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},lc=Object.assign,oc={};function Br(e,t,n){this.props=e,this.context=t,this.refs=oc,this.updater=n||sc}Br.prototype.isReactComponent={};Br.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Br.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function ic(){}ic.prototype=Br.prototype;function zo(e,t,n){this.props=e,this.context=t,this.refs=oc,this.updater=n||sc}var Bo=zo.prototype=new ic;Bo.constructor=zo;lc(Bo,Br.prototype);Bo.isPureReactComponent=!0;var Bi=Array.isArray,ac=Object.prototype.hasOwnProperty,Vo={current:null},cc={key:!0,ref:!0,__self:!0,__source:!0};function dc(e,t,n){var s,l={},o=null,i=null;if(t!=null)for(s in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(o=""+t.key),t)ac.call(t,s)&&!cc.hasOwnProperty(s)&&(l[s]=t[s]);var a=arguments.length-2;if(a===1)l.children=n;else if(1<a){for(var c=Array(a),d=0;d<a;d++)c[d]=arguments[d+2];l.children=c}if(e&&e.defaultProps)for(s in a=e.defaultProps,a)l[s]===void 0&&(l[s]=a[s]);return{$$typeof:An,type:e,key:o,ref:i,props:l,_owner:Vo.current}}function Ku(e,t){return{$$typeof:An,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Fo(e){return typeof e=="object"&&e!==null&&e.$$typeof===An}function Qu(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Vi=/\/+/g;function pl(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Qu(""+e.key):t.toString(36)}function is(e,t,n,s,l){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case An:case Du:i=!0}}if(i)return i=e,l=l(i),e=s===""?"."+pl(i,0):s,Bi(l)?(n="",e!=null&&(n=e.replace(Vi,"$&/")+"/"),is(l,t,n,"",function(d){return d})):l!=null&&(Fo(l)&&(l=Ku(l,n+(!l.key||i&&i.key===l.key?"":(""+l.key).replace(Vi,"$&/")+"/")+e)),t.push(l)),1;if(i=0,s=s===""?".":s+":",Bi(e))for(var a=0;a<e.length;a++){o=e[a];var c=s+pl(o,a);i+=is(o,t,n,c,l)}else if(c=Gu(e),typeof c=="function")for(e=c.call(e),a=0;!(o=e.next()).done;)o=o.value,c=s+pl(o,a++),i+=is(o,t,n,c,l);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Hn(e,t,n){if(e==null)return e;var s=[],l=0;return is(e,s,"","",function(o){return t.call(n,o,l++)}),s}function qu(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ae={current:null},as={transition:null},Ju={ReactCurrentDispatcher:Ae,ReactCurrentBatchConfig:as,ReactCurrentOwner:Vo};function uc(){throw Error("act(...) is not supported in production builds of React.")}ee.Children={map:Hn,forEach:function(e,t,n){Hn(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Hn(e,function(){t++}),t},toArray:function(e){return Hn(e,function(t){return t})||[]},only:function(e){if(!Fo(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ee.Component=Br;ee.Fragment=Ou;ee.Profiler=Bu;ee.PureComponent=zo;ee.StrictMode=zu;ee.Suspense=Hu;ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ju;ee.act=uc;ee.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=lc({},e.props),l=e.key,o=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,i=Vo.current),t.key!==void 0&&(l=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(c in t)ac.call(t,c)&&!cc.hasOwnProperty(c)&&(s[c]=t[c]===void 0&&a!==void 0?a[c]:t[c])}var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){a=Array(c);for(var d=0;d<c;d++)a[d]=arguments[d+2];s.children=a}return{$$typeof:An,type:e.type,key:l,ref:o,props:s,_owner:i}};ee.createContext=function(e){return e={$$typeof:Fu,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Vu,_context:e},e.Consumer=e};ee.createElement=dc;ee.createFactory=function(e){var t=dc.bind(null,e);return t.type=e,t};ee.createRef=function(){return{current:null}};ee.forwardRef=function(e){return{$$typeof:Wu,render:e}};ee.isValidElement=Fo;ee.lazy=function(e){return{$$typeof:Uu,_payload:{_status:-1,_result:e},_init:qu}};ee.memo=function(e,t){return{$$typeof:$u,type:e,compare:t===void 0?null:t}};ee.startTransition=function(e){var t=as.transition;as.transition={};try{e()}finally{as.transition=t}};ee.unstable_act=uc;ee.useCallback=function(e,t){return Ae.current.useCallback(e,t)};ee.useContext=function(e){return Ae.current.useContext(e)};ee.useDebugValue=function(){};ee.useDeferredValue=function(e){return Ae.current.useDeferredValue(e)};ee.useEffect=function(e,t){return Ae.current.useEffect(e,t)};ee.useId=function(){return Ae.current.useId()};ee.useImperativeHandle=function(e,t,n){return Ae.current.useImperativeHandle(e,t,n)};ee.useInsertionEffect=function(e,t){return Ae.current.useInsertionEffect(e,t)};ee.useLayoutEffect=function(e,t){return Ae.current.useLayoutEffect(e,t)};ee.useMemo=function(e,t){return Ae.current.useMemo(e,t)};ee.useReducer=function(e,t,n){return Ae.current.useReducer(e,t,n)};ee.useRef=function(e){return Ae.current.useRef(e)};ee.useState=function(e){return Ae.current.useState(e)};ee.useSyncExternalStore=function(e,t,n){return Ae.current.useSyncExternalStore(e,t,n)};ee.useTransition=function(){return Ae.current.useTransition()};ee.version="18.3.1";nc.exports=ee;var j=nc.exports;const fc=Mu(j);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yu=j,Xu=Symbol.for("react.element"),Zu=Symbol.for("react.fragment"),e0=Object.prototype.hasOwnProperty,t0=Yu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r0={key:!0,ref:!0,__self:!0,__source:!0};function mc(e,t,n){var s,l={},o=null,i=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(s in t)e0.call(t,s)&&!r0.hasOwnProperty(s)&&(l[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)l[s]===void 0&&(l[s]=t[s]);return{$$typeof:Xu,type:e,key:o,ref:i,props:l,_owner:t0.current}}$s.Fragment=Zu;$s.jsx=mc;$s.jsxs=mc;rc.exports=$s;var r=rc.exports,pc={exports:{}},Ue={},hc={exports:{}},xc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(_,W){var B=_.length;_.push(W);e:for(;0<B;){var H=B-1>>>1,F=_[H];if(0<l(F,W))_[H]=W,_[B]=F,B=H;else break e}}function n(_){return _.length===0?null:_[0]}function s(_){if(_.length===0)return null;var W=_[0],B=_.pop();if(B!==W){_[0]=B;e:for(var H=0,F=_.length,$=F>>>1;H<$;){var X=2*(H+1)-1,G=_[X],ie=X+1,D=_[ie];if(0>l(G,B))ie<F&&0>l(D,G)?(_[H]=D,_[ie]=B,H=ie):(_[H]=G,_[X]=B,H=X);else if(ie<F&&0>l(D,B))_[H]=D,_[ie]=B,H=ie;else break e}}return W}function l(_,W){var B=_.sortIndex-W.sortIndex;return B!==0?B:_.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();e.unstable_now=function(){return i.now()-a}}var c=[],d=[],v=1,u=null,h=3,x=!1,b=!1,y=!1,L=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(_){for(var W=n(d);W!==null;){if(W.callback===null)s(d);else if(W.startTime<=_)s(d),W.sortIndex=W.expirationTime,t(c,W);else break;W=n(d)}}function g(_){if(y=!1,m(_),!b)if(n(c)!==null)b=!0,Y(C);else{var W=n(d);W!==null&&Q(g,W.startTime-_)}}function C(_,W){b=!1,y&&(y=!1,p(k),k=-1),x=!0;var B=h;try{for(m(W),u=n(c);u!==null&&(!(u.expirationTime>W)||_&&!w());){var H=u.callback;if(typeof H=="function"){u.callback=null,h=u.priorityLevel;var F=H(u.expirationTime<=W);W=e.unstable_now(),typeof F=="function"?u.callback=F:u===n(c)&&s(c),m(W)}else s(c);u=n(c)}if(u!==null)var $=!0;else{var X=n(d);X!==null&&Q(g,X.startTime-W),$=!1}return $}finally{u=null,h=B,x=!1}}var R=!1,N=null,k=-1,I=5,E=-1;function w(){return!(e.unstable_now()-E<I)}function S(){if(N!==null){var _=e.unstable_now();E=_;var W=!0;try{W=N(!0,_)}finally{W?P():(R=!1,N=null)}}else R=!1}var P;if(typeof f=="function")P=function(){f(S)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,U=M.port2;M.port1.onmessage=S,P=function(){U.postMessage(null)}}else P=function(){L(S,0)};function Y(_){N=_,R||(R=!0,P())}function Q(_,W){k=L(function(){_(e.unstable_now())},W)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(_){_.callback=null},e.unstable_continueExecution=function(){b||x||(b=!0,Y(C))},e.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<_?Math.floor(1e3/_):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(_){switch(h){case 1:case 2:case 3:var W=3;break;default:W=h}var B=h;h=W;try{return _()}finally{h=B}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(_,W){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var B=h;h=_;try{return W()}finally{h=B}},e.unstable_scheduleCallback=function(_,W,B){var H=e.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?H+B:H):B=H,_){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=B+F,_={id:v++,callback:W,priorityLevel:_,startTime:B,expirationTime:F,sortIndex:-1},B>H?(_.sortIndex=B,t(d,_),n(c)===null&&_===n(d)&&(y?(p(k),k=-1):y=!0,Q(g,B-H))):(_.sortIndex=F,t(c,_),b||x||(b=!0,Y(C))),_},e.unstable_shouldYield=w,e.unstable_wrapCallback=function(_){var W=h;return function(){var B=h;h=W;try{return _.apply(this,arguments)}finally{h=B}}}})(xc);hc.exports=xc;var n0=hc.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s0=j,$e=n0;function T(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var gc=new Set,xn={};function dr(e,t){Tr(e,t),Tr(e+"Capture",t)}function Tr(e,t){for(xn[e]=t,e=0;e<t.length;e++)gc.add(t[e])}var bt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vl=Object.prototype.hasOwnProperty,l0=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Fi={},Wi={};function o0(e){return Vl.call(Wi,e)?!0:Vl.call(Fi,e)?!1:l0.test(e)?Wi[e]=!0:(Fi[e]=!0,!1)}function i0(e,t,n,s){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function a0(e,t,n,s){if(t===null||typeof t>"u"||i0(e,t,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Pe(e,t,n,s,l,o,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=l,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var Se={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Se[e]=new Pe(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Se[t]=new Pe(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Se[e]=new Pe(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Se[e]=new Pe(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Se[e]=new Pe(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Se[e]=new Pe(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Se[e]=new Pe(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Se[e]=new Pe(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Se[e]=new Pe(e,5,!1,e.toLowerCase(),null,!1,!1)});var Wo=/[\-:]([a-z])/g;function Ho(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Wo,Ho);Se[t]=new Pe(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Wo,Ho);Se[t]=new Pe(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Wo,Ho);Se[t]=new Pe(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Se[e]=new Pe(e,1,!1,e.toLowerCase(),null,!1,!1)});Se.xlinkHref=new Pe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Se[e]=new Pe(e,1,!1,e.toLowerCase(),null,!0,!0)});function $o(e,t,n,s){var l=Se.hasOwnProperty(t)?Se[t]:null;(l!==null?l.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(a0(t,n,l,s)&&(n=null),s||l===null?o0(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):l.mustUseProperty?e[l.propertyName]=n===null?l.type===3?!1:"":n:(t=l.attributeName,s=l.attributeNamespace,n===null?e.removeAttribute(t):(l=l.type,n=l===3||l===4&&n===!0?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}var kt=s0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$n=Symbol.for("react.element"),pr=Symbol.for("react.portal"),hr=Symbol.for("react.fragment"),Uo=Symbol.for("react.strict_mode"),Fl=Symbol.for("react.profiler"),yc=Symbol.for("react.provider"),vc=Symbol.for("react.context"),Go=Symbol.for("react.forward_ref"),Wl=Symbol.for("react.suspense"),Hl=Symbol.for("react.suspense_list"),Ko=Symbol.for("react.memo"),Et=Symbol.for("react.lazy"),bc=Symbol.for("react.offscreen"),Hi=Symbol.iterator;function Gr(e){return e===null||typeof e!="object"?null:(e=Hi&&e[Hi]||e["@@iterator"],typeof e=="function"?e:null)}var pe=Object.assign,hl;function rn(e){if(hl===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);hl=t&&t[1]||""}return`
`+hl+e}var xl=!1;function gl(e,t){if(!e||xl)return"";xl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var s=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){s=d}e.call(t.prototype)}else{try{throw Error()}catch(d){s=d}e()}}catch(d){if(d&&s&&typeof d.stack=="string"){for(var l=d.stack.split(`
`),o=s.stack.split(`
`),i=l.length-1,a=o.length-1;1<=i&&0<=a&&l[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(l[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||l[i]!==o[a]){var c=`
`+l[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=a);break}}}finally{xl=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?rn(e):""}function c0(e){switch(e.tag){case 5:return rn(e.type);case 16:return rn("Lazy");case 13:return rn("Suspense");case 19:return rn("SuspenseList");case 0:case 2:case 15:return e=gl(e.type,!1),e;case 11:return e=gl(e.type.render,!1),e;case 1:return e=gl(e.type,!0),e;default:return""}}function $l(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case hr:return"Fragment";case pr:return"Portal";case Fl:return"Profiler";case Uo:return"StrictMode";case Wl:return"Suspense";case Hl:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case vc:return(e.displayName||"Context")+".Consumer";case yc:return(e._context.displayName||"Context")+".Provider";case Go:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ko:return t=e.displayName||null,t!==null?t:$l(e.type)||"Memo";case Et:t=e._payload,e=e._init;try{return $l(e(t))}catch{}}return null}function d0(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $l(t);case 8:return t===Uo?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Wt(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function wc(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function u0(e){var t=wc(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var l=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(i){s=""+i,o.call(this,i)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(i){s=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Un(e){e._valueTracker||(e._valueTracker=u0(e))}function jc(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=wc(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function bs(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ul(e,t){var n=t.checked;return pe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function $i(e,t){var n=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;n=Wt(t.value!=null?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Nc(e,t){t=t.checked,t!=null&&$o(e,"checked",t,!1)}function Gl(e,t){Nc(e,t);var n=Wt(t.value),s=t.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Kl(e,t.type,n):t.hasOwnProperty("defaultValue")&&Kl(e,t.type,Wt(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ui(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Kl(e,t,n){(t!=="number"||bs(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var nn=Array.isArray;function Cr(e,t,n,s){if(e=e.options,t){t={};for(var l=0;l<n.length;l++)t["$"+n[l]]=!0;for(n=0;n<e.length;n++)l=t.hasOwnProperty("$"+e[n].value),e[n].selected!==l&&(e[n].selected=l),l&&s&&(e[n].defaultSelected=!0)}else{for(n=""+Wt(n),t=null,l=0;l<e.length;l++){if(e[l].value===n){e[l].selected=!0,s&&(e[l].defaultSelected=!0);return}t!==null||e[l].disabled||(t=e[l])}t!==null&&(t.selected=!0)}}function Ql(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(T(91));return pe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Gi(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(T(92));if(nn(n)){if(1<n.length)throw Error(T(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Wt(n)}}function kc(e,t){var n=Wt(t.value),s=Wt(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function Ki(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Sc(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ql(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Sc(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Gn,Cc=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,s,l){MSApp.execUnsafeLocalFunction(function(){return e(t,n,s,l)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Gn=Gn||document.createElement("div"),Gn.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Gn.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function gn(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var on={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},f0=["Webkit","ms","Moz","O"];Object.keys(on).forEach(function(e){f0.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),on[t]=on[e]})});function Lc(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||on.hasOwnProperty(e)&&on[e]?(""+t).trim():t+"px"}function Ec(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var s=n.indexOf("--")===0,l=Lc(n,t[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,l):e[n]=l}}var m0=pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Jl(e,t){if(t){if(m0[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(T(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(T(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(T(61))}if(t.style!=null&&typeof t.style!="object")throw Error(T(62))}}function Yl(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xl=null;function Qo(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Zl=null,Lr=null,Er=null;function Qi(e){if(e=Dn(e)){if(typeof Zl!="function")throw Error(T(280));var t=e.stateNode;t&&(t=qs(t),Zl(e.stateNode,e.type,t))}}function Ic(e){Lr?Er?Er.push(e):Er=[e]:Lr=e}function Rc(){if(Lr){var e=Lr,t=Er;if(Er=Lr=null,Qi(e),t)for(e=0;e<t.length;e++)Qi(t[e])}}function _c(e,t){return e(t)}function Tc(){}var yl=!1;function Ac(e,t,n){if(yl)return e(t,n);yl=!0;try{return _c(e,t,n)}finally{yl=!1,(Lr!==null||Er!==null)&&(Tc(),Rc())}}function yn(e,t){var n=e.stateNode;if(n===null)return null;var s=qs(n);if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(T(231,t,typeof n));return n}var eo=!1;if(bt)try{var Kr={};Object.defineProperty(Kr,"passive",{get:function(){eo=!0}}),window.addEventListener("test",Kr,Kr),window.removeEventListener("test",Kr,Kr)}catch{eo=!1}function p0(e,t,n,s,l,o,i,a,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(v){this.onError(v)}}var an=!1,ws=null,js=!1,to=null,h0={onError:function(e){an=!0,ws=e}};function x0(e,t,n,s,l,o,i,a,c){an=!1,ws=null,p0.apply(h0,arguments)}function g0(e,t,n,s,l,o,i,a,c){if(x0.apply(this,arguments),an){if(an){var d=ws;an=!1,ws=null}else throw Error(T(198));js||(js=!0,to=d)}}function ur(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Pc(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function qi(e){if(ur(e)!==e)throw Error(T(188))}function y0(e){var t=e.alternate;if(!t){if(t=ur(e),t===null)throw Error(T(188));return t!==e?null:e}for(var n=e,s=t;;){var l=n.return;if(l===null)break;var o=l.alternate;if(o===null){if(s=l.return,s!==null){n=s;continue}break}if(l.child===o.child){for(o=l.child;o;){if(o===n)return qi(l),e;if(o===s)return qi(l),t;o=o.sibling}throw Error(T(188))}if(n.return!==s.return)n=l,s=o;else{for(var i=!1,a=l.child;a;){if(a===n){i=!0,n=l,s=o;break}if(a===s){i=!0,s=l,n=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===n){i=!0,n=o,s=l;break}if(a===s){i=!0,s=o,n=l;break}a=a.sibling}if(!i)throw Error(T(189))}}if(n.alternate!==s)throw Error(T(190))}if(n.tag!==3)throw Error(T(188));return n.stateNode.current===n?e:t}function Mc(e){return e=y0(e),e!==null?Dc(e):null}function Dc(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Dc(e);if(t!==null)return t;e=e.sibling}return null}var Oc=$e.unstable_scheduleCallback,Ji=$e.unstable_cancelCallback,v0=$e.unstable_shouldYield,b0=$e.unstable_requestPaint,xe=$e.unstable_now,w0=$e.unstable_getCurrentPriorityLevel,qo=$e.unstable_ImmediatePriority,zc=$e.unstable_UserBlockingPriority,Ns=$e.unstable_NormalPriority,j0=$e.unstable_LowPriority,Bc=$e.unstable_IdlePriority,Us=null,ft=null;function N0(e){if(ft&&typeof ft.onCommitFiberRoot=="function")try{ft.onCommitFiberRoot(Us,e,void 0,(e.current.flags&128)===128)}catch{}}var st=Math.clz32?Math.clz32:C0,k0=Math.log,S0=Math.LN2;function C0(e){return e>>>=0,e===0?32:31-(k0(e)/S0|0)|0}var Kn=64,Qn=4194304;function sn(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ks(e,t){var n=e.pendingLanes;if(n===0)return 0;var s=0,l=e.suspendedLanes,o=e.pingedLanes,i=n&268435455;if(i!==0){var a=i&~l;a!==0?s=sn(a):(o&=i,o!==0&&(s=sn(o)))}else i=n&~l,i!==0?s=sn(i):o!==0&&(s=sn(o));if(s===0)return 0;if(t!==0&&t!==s&&!(t&l)&&(l=s&-s,o=t&-t,l>=o||l===16&&(o&4194240)!==0))return t;if(s&4&&(s|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)n=31-st(t),l=1<<n,s|=e[n],t&=~l;return s}function L0(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function E0(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,l=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-st(o),a=1<<i,c=l[i];c===-1?(!(a&n)||a&s)&&(l[i]=L0(a,t)):c<=t&&(e.expiredLanes|=a),o&=~a}}function ro(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Vc(){var e=Kn;return Kn<<=1,!(Kn&4194240)&&(Kn=64),e}function vl(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Pn(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-st(t),e[t]=n}function I0(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var l=31-st(n),o=1<<l;t[l]=0,s[l]=-1,e[l]=-1,n&=~o}}function Jo(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-st(n),l=1<<s;l&t|e[s]&t&&(e[s]|=t),n&=~l}}var se=0;function Fc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Wc,Yo,Hc,$c,Uc,no=!1,qn=[],Pt=null,Mt=null,Dt=null,vn=new Map,bn=new Map,Rt=[],R0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yi(e,t){switch(e){case"focusin":case"focusout":Pt=null;break;case"dragenter":case"dragleave":Mt=null;break;case"mouseover":case"mouseout":Dt=null;break;case"pointerover":case"pointerout":vn.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":bn.delete(t.pointerId)}}function Qr(e,t,n,s,l,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:o,targetContainers:[l]},t!==null&&(t=Dn(t),t!==null&&Yo(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,l!==null&&t.indexOf(l)===-1&&t.push(l),e)}function _0(e,t,n,s,l){switch(t){case"focusin":return Pt=Qr(Pt,e,t,n,s,l),!0;case"dragenter":return Mt=Qr(Mt,e,t,n,s,l),!0;case"mouseover":return Dt=Qr(Dt,e,t,n,s,l),!0;case"pointerover":var o=l.pointerId;return vn.set(o,Qr(vn.get(o)||null,e,t,n,s,l)),!0;case"gotpointercapture":return o=l.pointerId,bn.set(o,Qr(bn.get(o)||null,e,t,n,s,l)),!0}return!1}function Gc(e){var t=Zt(e.target);if(t!==null){var n=ur(t);if(n!==null){if(t=n.tag,t===13){if(t=Pc(n),t!==null){e.blockedOn=t,Uc(e.priority,function(){Hc(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function cs(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=so(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);Xl=s,n.target.dispatchEvent(s),Xl=null}else return t=Dn(n),t!==null&&Yo(t),e.blockedOn=n,!1;t.shift()}return!0}function Xi(e,t,n){cs(e)&&n.delete(t)}function T0(){no=!1,Pt!==null&&cs(Pt)&&(Pt=null),Mt!==null&&cs(Mt)&&(Mt=null),Dt!==null&&cs(Dt)&&(Dt=null),vn.forEach(Xi),bn.forEach(Xi)}function qr(e,t){e.blockedOn===t&&(e.blockedOn=null,no||(no=!0,$e.unstable_scheduleCallback($e.unstable_NormalPriority,T0)))}function wn(e){function t(l){return qr(l,e)}if(0<qn.length){qr(qn[0],e);for(var n=1;n<qn.length;n++){var s=qn[n];s.blockedOn===e&&(s.blockedOn=null)}}for(Pt!==null&&qr(Pt,e),Mt!==null&&qr(Mt,e),Dt!==null&&qr(Dt,e),vn.forEach(t),bn.forEach(t),n=0;n<Rt.length;n++)s=Rt[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<Rt.length&&(n=Rt[0],n.blockedOn===null);)Gc(n),n.blockedOn===null&&Rt.shift()}var Ir=kt.ReactCurrentBatchConfig,Ss=!0;function A0(e,t,n,s){var l=se,o=Ir.transition;Ir.transition=null;try{se=1,Xo(e,t,n,s)}finally{se=l,Ir.transition=o}}function P0(e,t,n,s){var l=se,o=Ir.transition;Ir.transition=null;try{se=4,Xo(e,t,n,s)}finally{se=l,Ir.transition=o}}function Xo(e,t,n,s){if(Ss){var l=so(e,t,n,s);if(l===null)Il(e,t,s,Cs,n),Yi(e,s);else if(_0(l,e,t,n,s))s.stopPropagation();else if(Yi(e,s),t&4&&-1<R0.indexOf(e)){for(;l!==null;){var o=Dn(l);if(o!==null&&Wc(o),o=so(e,t,n,s),o===null&&Il(e,t,s,Cs,n),o===l)break;l=o}l!==null&&s.stopPropagation()}else Il(e,t,s,null,n)}}var Cs=null;function so(e,t,n,s){if(Cs=null,e=Qo(s),e=Zt(e),e!==null)if(t=ur(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Pc(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Cs=e,null}function Kc(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(w0()){case qo:return 1;case zc:return 4;case Ns:case j0:return 16;case Bc:return 536870912;default:return 16}default:return 16}}var Tt=null,Zo=null,ds=null;function Qc(){if(ds)return ds;var e,t=Zo,n=t.length,s,l="value"in Tt?Tt.value:Tt.textContent,o=l.length;for(e=0;e<n&&t[e]===l[e];e++);var i=n-e;for(s=1;s<=i&&t[n-s]===l[o-s];s++);return ds=l.slice(e,1<s?1-s:void 0)}function us(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Jn(){return!0}function Zi(){return!1}function Ge(e){function t(n,s,l,o,i){this._reactName=n,this._targetInst=l,this.type=s,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Jn:Zi,this.isPropagationStopped=Zi,this}return pe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Jn)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Jn)},persist:function(){},isPersistent:Jn}),t}var Vr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ei=Ge(Vr),Mn=pe({},Vr,{view:0,detail:0}),M0=Ge(Mn),bl,wl,Jr,Gs=pe({},Mn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ti,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Jr&&(Jr&&e.type==="mousemove"?(bl=e.screenX-Jr.screenX,wl=e.screenY-Jr.screenY):wl=bl=0,Jr=e),bl)},movementY:function(e){return"movementY"in e?e.movementY:wl}}),ea=Ge(Gs),D0=pe({},Gs,{dataTransfer:0}),O0=Ge(D0),z0=pe({},Mn,{relatedTarget:0}),jl=Ge(z0),B0=pe({},Vr,{animationName:0,elapsedTime:0,pseudoElement:0}),V0=Ge(B0),F0=pe({},Vr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),W0=Ge(F0),H0=pe({},Vr,{data:0}),ta=Ge(H0),$0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},U0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},G0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function K0(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=G0[e])?!!t[e]:!1}function ti(){return K0}var Q0=pe({},Mn,{key:function(e){if(e.key){var t=$0[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=us(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?U0[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ti,charCode:function(e){return e.type==="keypress"?us(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?us(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),q0=Ge(Q0),J0=pe({},Gs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ra=Ge(J0),Y0=pe({},Mn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ti}),X0=Ge(Y0),Z0=pe({},Vr,{propertyName:0,elapsedTime:0,pseudoElement:0}),ef=Ge(Z0),tf=pe({},Gs,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),rf=Ge(tf),nf=[9,13,27,32],ri=bt&&"CompositionEvent"in window,cn=null;bt&&"documentMode"in document&&(cn=document.documentMode);var sf=bt&&"TextEvent"in window&&!cn,qc=bt&&(!ri||cn&&8<cn&&11>=cn),na=" ",sa=!1;function Jc(e,t){switch(e){case"keyup":return nf.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yc(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var xr=!1;function lf(e,t){switch(e){case"compositionend":return Yc(t);case"keypress":return t.which!==32?null:(sa=!0,na);case"textInput":return e=t.data,e===na&&sa?null:e;default:return null}}function of(e,t){if(xr)return e==="compositionend"||!ri&&Jc(e,t)?(e=Qc(),ds=Zo=Tt=null,xr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return qc&&t.locale!=="ko"?null:t.data;default:return null}}var af={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function la(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!af[e.type]:t==="textarea"}function Xc(e,t,n,s){Ic(s),t=Ls(t,"onChange"),0<t.length&&(n=new ei("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var dn=null,jn=null;function cf(e){cd(e,0)}function Ks(e){var t=vr(e);if(jc(t))return e}function df(e,t){if(e==="change")return t}var Zc=!1;if(bt){var Nl;if(bt){var kl="oninput"in document;if(!kl){var oa=document.createElement("div");oa.setAttribute("oninput","return;"),kl=typeof oa.oninput=="function"}Nl=kl}else Nl=!1;Zc=Nl&&(!document.documentMode||9<document.documentMode)}function ia(){dn&&(dn.detachEvent("onpropertychange",ed),jn=dn=null)}function ed(e){if(e.propertyName==="value"&&Ks(jn)){var t=[];Xc(t,jn,e,Qo(e)),Ac(cf,t)}}function uf(e,t,n){e==="focusin"?(ia(),dn=t,jn=n,dn.attachEvent("onpropertychange",ed)):e==="focusout"&&ia()}function ff(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ks(jn)}function mf(e,t){if(e==="click")return Ks(t)}function pf(e,t){if(e==="input"||e==="change")return Ks(t)}function hf(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ot=typeof Object.is=="function"?Object.is:hf;function Nn(e,t){if(ot(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var l=n[s];if(!Vl.call(t,l)||!ot(e[l],t[l]))return!1}return!0}function aa(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ca(e,t){var n=aa(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=aa(n)}}function td(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?td(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function rd(){for(var e=window,t=bs();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=bs(e.document)}return t}function ni(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function xf(e){var t=rd(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&td(n.ownerDocument.documentElement,n)){if(s!==null&&ni(n)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var l=n.textContent.length,o=Math.min(s.start,l);s=s.end===void 0?o:Math.min(s.end,l),!e.extend&&o>s&&(l=s,s=o,o=l),l=ca(n,o);var i=ca(n,s);l&&i&&(e.rangeCount!==1||e.anchorNode!==l.node||e.anchorOffset!==l.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(l.node,l.offset),e.removeAllRanges(),o>s?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gf=bt&&"documentMode"in document&&11>=document.documentMode,gr=null,lo=null,un=null,oo=!1;function da(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;oo||gr==null||gr!==bs(s)||(s=gr,"selectionStart"in s&&ni(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),un&&Nn(un,s)||(un=s,s=Ls(lo,"onSelect"),0<s.length&&(t=new ei("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=gr)))}function Yn(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var yr={animationend:Yn("Animation","AnimationEnd"),animationiteration:Yn("Animation","AnimationIteration"),animationstart:Yn("Animation","AnimationStart"),transitionend:Yn("Transition","TransitionEnd")},Sl={},nd={};bt&&(nd=document.createElement("div").style,"AnimationEvent"in window||(delete yr.animationend.animation,delete yr.animationiteration.animation,delete yr.animationstart.animation),"TransitionEvent"in window||delete yr.transitionend.transition);function Qs(e){if(Sl[e])return Sl[e];if(!yr[e])return e;var t=yr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in nd)return Sl[e]=t[n];return e}var sd=Qs("animationend"),ld=Qs("animationiteration"),od=Qs("animationstart"),id=Qs("transitionend"),ad=new Map,ua="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $t(e,t){ad.set(e,t),dr(t,[e])}for(var Cl=0;Cl<ua.length;Cl++){var Ll=ua[Cl],yf=Ll.toLowerCase(),vf=Ll[0].toUpperCase()+Ll.slice(1);$t(yf,"on"+vf)}$t(sd,"onAnimationEnd");$t(ld,"onAnimationIteration");$t(od,"onAnimationStart");$t("dblclick","onDoubleClick");$t("focusin","onFocus");$t("focusout","onBlur");$t(id,"onTransitionEnd");Tr("onMouseEnter",["mouseout","mouseover"]);Tr("onMouseLeave",["mouseout","mouseover"]);Tr("onPointerEnter",["pointerout","pointerover"]);Tr("onPointerLeave",["pointerout","pointerover"]);dr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));dr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));dr("onBeforeInput",["compositionend","keypress","textInput","paste"]);dr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));dr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));dr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ln="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bf=new Set("cancel close invalid load scroll toggle".split(" ").concat(ln));function fa(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,g0(s,t,void 0,e),e.currentTarget=null}function cd(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],l=s.event;s=s.listeners;e:{var o=void 0;if(t)for(var i=s.length-1;0<=i;i--){var a=s[i],c=a.instance,d=a.currentTarget;if(a=a.listener,c!==o&&l.isPropagationStopped())break e;fa(l,a,d),o=c}else for(i=0;i<s.length;i++){if(a=s[i],c=a.instance,d=a.currentTarget,a=a.listener,c!==o&&l.isPropagationStopped())break e;fa(l,a,d),o=c}}}if(js)throw e=to,js=!1,to=null,e}function ae(e,t){var n=t[fo];n===void 0&&(n=t[fo]=new Set);var s=e+"__bubble";n.has(s)||(dd(t,e,2,!1),n.add(s))}function El(e,t,n){var s=0;t&&(s|=4),dd(n,e,s,t)}var Xn="_reactListening"+Math.random().toString(36).slice(2);function kn(e){if(!e[Xn]){e[Xn]=!0,gc.forEach(function(n){n!=="selectionchange"&&(bf.has(n)||El(n,!1,e),El(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Xn]||(t[Xn]=!0,El("selectionchange",!1,t))}}function dd(e,t,n,s){switch(Kc(t)){case 1:var l=A0;break;case 4:l=P0;break;default:l=Xo}n=l.bind(null,t,n,e),l=void 0,!eo||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(l=!0),s?l!==void 0?e.addEventListener(t,n,{capture:!0,passive:l}):e.addEventListener(t,n,!0):l!==void 0?e.addEventListener(t,n,{passive:l}):e.addEventListener(t,n,!1)}function Il(e,t,n,s,l){var o=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var i=s.tag;if(i===3||i===4){var a=s.stateNode.containerInfo;if(a===l||a.nodeType===8&&a.parentNode===l)break;if(i===4)for(i=s.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===l||c.nodeType===8&&c.parentNode===l))return;i=i.return}for(;a!==null;){if(i=Zt(a),i===null)return;if(c=i.tag,c===5||c===6){s=o=i;continue e}a=a.parentNode}}s=s.return}Ac(function(){var d=o,v=Qo(n),u=[];e:{var h=ad.get(e);if(h!==void 0){var x=ei,b=e;switch(e){case"keypress":if(us(n)===0)break e;case"keydown":case"keyup":x=q0;break;case"focusin":b="focus",x=jl;break;case"focusout":b="blur",x=jl;break;case"beforeblur":case"afterblur":x=jl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=ea;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=O0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=X0;break;case sd:case ld:case od:x=V0;break;case id:x=ef;break;case"scroll":x=M0;break;case"wheel":x=rf;break;case"copy":case"cut":case"paste":x=W0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=ra}var y=(t&4)!==0,L=!y&&e==="scroll",p=y?h!==null?h+"Capture":null:h;y=[];for(var f=d,m;f!==null;){m=f;var g=m.stateNode;if(m.tag===5&&g!==null&&(m=g,p!==null&&(g=yn(f,p),g!=null&&y.push(Sn(f,g,m)))),L)break;f=f.return}0<y.length&&(h=new x(h,b,null,n,v),u.push({event:h,listeners:y}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",h&&n!==Xl&&(b=n.relatedTarget||n.fromElement)&&(Zt(b)||b[wt]))break e;if((x||h)&&(h=v.window===v?v:(h=v.ownerDocument)?h.defaultView||h.parentWindow:window,x?(b=n.relatedTarget||n.toElement,x=d,b=b?Zt(b):null,b!==null&&(L=ur(b),b!==L||b.tag!==5&&b.tag!==6)&&(b=null)):(x=null,b=d),x!==b)){if(y=ea,g="onMouseLeave",p="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(y=ra,g="onPointerLeave",p="onPointerEnter",f="pointer"),L=x==null?h:vr(x),m=b==null?h:vr(b),h=new y(g,f+"leave",x,n,v),h.target=L,h.relatedTarget=m,g=null,Zt(v)===d&&(y=new y(p,f+"enter",b,n,v),y.target=m,y.relatedTarget=L,g=y),L=g,x&&b)t:{for(y=x,p=b,f=0,m=y;m;m=fr(m))f++;for(m=0,g=p;g;g=fr(g))m++;for(;0<f-m;)y=fr(y),f--;for(;0<m-f;)p=fr(p),m--;for(;f--;){if(y===p||p!==null&&y===p.alternate)break t;y=fr(y),p=fr(p)}y=null}else y=null;x!==null&&ma(u,h,x,y,!1),b!==null&&L!==null&&ma(u,L,b,y,!0)}}e:{if(h=d?vr(d):window,x=h.nodeName&&h.nodeName.toLowerCase(),x==="select"||x==="input"&&h.type==="file")var C=df;else if(la(h))if(Zc)C=pf;else{C=ff;var R=uf}else(x=h.nodeName)&&x.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(C=mf);if(C&&(C=C(e,d))){Xc(u,C,n,v);break e}R&&R(e,h,d),e==="focusout"&&(R=h._wrapperState)&&R.controlled&&h.type==="number"&&Kl(h,"number",h.value)}switch(R=d?vr(d):window,e){case"focusin":(la(R)||R.contentEditable==="true")&&(gr=R,lo=d,un=null);break;case"focusout":un=lo=gr=null;break;case"mousedown":oo=!0;break;case"contextmenu":case"mouseup":case"dragend":oo=!1,da(u,n,v);break;case"selectionchange":if(gf)break;case"keydown":case"keyup":da(u,n,v)}var N;if(ri)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else xr?Jc(e,n)&&(k="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(qc&&n.locale!=="ko"&&(xr||k!=="onCompositionStart"?k==="onCompositionEnd"&&xr&&(N=Qc()):(Tt=v,Zo="value"in Tt?Tt.value:Tt.textContent,xr=!0)),R=Ls(d,k),0<R.length&&(k=new ta(k,e,null,n,v),u.push({event:k,listeners:R}),N?k.data=N:(N=Yc(n),N!==null&&(k.data=N)))),(N=sf?lf(e,n):of(e,n))&&(d=Ls(d,"onBeforeInput"),0<d.length&&(v=new ta("onBeforeInput","beforeinput",null,n,v),u.push({event:v,listeners:d}),v.data=N))}cd(u,t)})}function Sn(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ls(e,t){for(var n=t+"Capture",s=[];e!==null;){var l=e,o=l.stateNode;l.tag===5&&o!==null&&(l=o,o=yn(e,n),o!=null&&s.unshift(Sn(e,o,l)),o=yn(e,t),o!=null&&s.push(Sn(e,o,l))),e=e.return}return s}function fr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function ma(e,t,n,s,l){for(var o=t._reactName,i=[];n!==null&&n!==s;){var a=n,c=a.alternate,d=a.stateNode;if(c!==null&&c===s)break;a.tag===5&&d!==null&&(a=d,l?(c=yn(n,o),c!=null&&i.unshift(Sn(n,c,a))):l||(c=yn(n,o),c!=null&&i.push(Sn(n,c,a)))),n=n.return}i.length!==0&&e.push({event:t,listeners:i})}var wf=/\r\n?/g,jf=/\u0000|\uFFFD/g;function pa(e){return(typeof e=="string"?e:""+e).replace(wf,`
`).replace(jf,"")}function Zn(e,t,n){if(t=pa(t),pa(e)!==t&&n)throw Error(T(425))}function Es(){}var io=null,ao=null;function co(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var uo=typeof setTimeout=="function"?setTimeout:void 0,Nf=typeof clearTimeout=="function"?clearTimeout:void 0,ha=typeof Promise=="function"?Promise:void 0,kf=typeof queueMicrotask=="function"?queueMicrotask:typeof ha<"u"?function(e){return ha.resolve(null).then(e).catch(Sf)}:uo;function Sf(e){setTimeout(function(){throw e})}function Rl(e,t){var n=t,s=0;do{var l=n.nextSibling;if(e.removeChild(n),l&&l.nodeType===8)if(n=l.data,n==="/$"){if(s===0){e.removeChild(l),wn(t);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=l}while(n);wn(t)}function Ot(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function xa(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Fr=Math.random().toString(36).slice(2),ut="__reactFiber$"+Fr,Cn="__reactProps$"+Fr,wt="__reactContainer$"+Fr,fo="__reactEvents$"+Fr,Cf="__reactListeners$"+Fr,Lf="__reactHandles$"+Fr;function Zt(e){var t=e[ut];if(t)return t;for(var n=e.parentNode;n;){if(t=n[wt]||n[ut]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=xa(e);e!==null;){if(n=e[ut])return n;e=xa(e)}return t}e=n,n=e.parentNode}return null}function Dn(e){return e=e[ut]||e[wt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function vr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(T(33))}function qs(e){return e[Cn]||null}var mo=[],br=-1;function Ut(e){return{current:e}}function ce(e){0>br||(e.current=mo[br],mo[br]=null,br--)}function oe(e,t){br++,mo[br]=e.current,e.current=t}var Ht={},Re=Ut(Ht),Oe=Ut(!1),lr=Ht;function Ar(e,t){var n=e.type.contextTypes;if(!n)return Ht;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var l={},o;for(o in n)l[o]=t[o];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=l),l}function ze(e){return e=e.childContextTypes,e!=null}function Is(){ce(Oe),ce(Re)}function ga(e,t,n){if(Re.current!==Ht)throw Error(T(168));oe(Re,t),oe(Oe,n)}function ud(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var l in s)if(!(l in t))throw Error(T(108,d0(e)||"Unknown",l));return pe({},n,s)}function Rs(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ht,lr=Re.current,oe(Re,e),oe(Oe,Oe.current),!0}function ya(e,t,n){var s=e.stateNode;if(!s)throw Error(T(169));n?(e=ud(e,t,lr),s.__reactInternalMemoizedMergedChildContext=e,ce(Oe),ce(Re),oe(Re,e)):ce(Oe),oe(Oe,n)}var xt=null,Js=!1,_l=!1;function fd(e){xt===null?xt=[e]:xt.push(e)}function Ef(e){Js=!0,fd(e)}function Gt(){if(!_l&&xt!==null){_l=!0;var e=0,t=se;try{var n=xt;for(se=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}xt=null,Js=!1}catch(l){throw xt!==null&&(xt=xt.slice(e+1)),Oc(qo,Gt),l}finally{se=t,_l=!1}}return null}var wr=[],jr=0,_s=null,Ts=0,Qe=[],qe=0,or=null,gt=1,yt="";function Jt(e,t){wr[jr++]=Ts,wr[jr++]=_s,_s=e,Ts=t}function md(e,t,n){Qe[qe++]=gt,Qe[qe++]=yt,Qe[qe++]=or,or=e;var s=gt;e=yt;var l=32-st(s)-1;s&=~(1<<l),n+=1;var o=32-st(t)+l;if(30<o){var i=l-l%5;o=(s&(1<<i)-1).toString(32),s>>=i,l-=i,gt=1<<32-st(t)+l|n<<l|s,yt=o+e}else gt=1<<o|n<<l|s,yt=e}function si(e){e.return!==null&&(Jt(e,1),md(e,1,0))}function li(e){for(;e===_s;)_s=wr[--jr],wr[jr]=null,Ts=wr[--jr],wr[jr]=null;for(;e===or;)or=Qe[--qe],Qe[qe]=null,yt=Qe[--qe],Qe[qe]=null,gt=Qe[--qe],Qe[qe]=null}var He=null,We=null,de=!1,nt=null;function pd(e,t){var n=Je(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function va(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,He=e,We=Ot(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,He=e,We=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=or!==null?{id:gt,overflow:yt}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Je(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,He=e,We=null,!0):!1;default:return!1}}function po(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ho(e){if(de){var t=We;if(t){var n=t;if(!va(e,t)){if(po(e))throw Error(T(418));t=Ot(n.nextSibling);var s=He;t&&va(e,t)?pd(s,n):(e.flags=e.flags&-4097|2,de=!1,He=e)}}else{if(po(e))throw Error(T(418));e.flags=e.flags&-4097|2,de=!1,He=e}}}function ba(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;He=e}function es(e){if(e!==He)return!1;if(!de)return ba(e),de=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!co(e.type,e.memoizedProps)),t&&(t=We)){if(po(e))throw hd(),Error(T(418));for(;t;)pd(e,t),t=Ot(t.nextSibling)}if(ba(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(T(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){We=Ot(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}We=null}}else We=He?Ot(e.stateNode.nextSibling):null;return!0}function hd(){for(var e=We;e;)e=Ot(e.nextSibling)}function Pr(){We=He=null,de=!1}function oi(e){nt===null?nt=[e]:nt.push(e)}var If=kt.ReactCurrentBatchConfig;function Yr(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(T(309));var s=n.stateNode}if(!s)throw Error(T(147,e));var l=s,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(i){var a=l.refs;i===null?delete a[o]:a[o]=i},t._stringRef=o,t)}if(typeof e!="string")throw Error(T(284));if(!n._owner)throw Error(T(290,e))}return e}function ts(e,t){throw e=Object.prototype.toString.call(t),Error(T(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function wa(e){var t=e._init;return t(e._payload)}function xd(e){function t(p,f){if(e){var m=p.deletions;m===null?(p.deletions=[f],p.flags|=16):m.push(f)}}function n(p,f){if(!e)return null;for(;f!==null;)t(p,f),f=f.sibling;return null}function s(p,f){for(p=new Map;f!==null;)f.key!==null?p.set(f.key,f):p.set(f.index,f),f=f.sibling;return p}function l(p,f){return p=Ft(p,f),p.index=0,p.sibling=null,p}function o(p,f,m){return p.index=m,e?(m=p.alternate,m!==null?(m=m.index,m<f?(p.flags|=2,f):m):(p.flags|=2,f)):(p.flags|=1048576,f)}function i(p){return e&&p.alternate===null&&(p.flags|=2),p}function a(p,f,m,g){return f===null||f.tag!==6?(f=zl(m,p.mode,g),f.return=p,f):(f=l(f,m),f.return=p,f)}function c(p,f,m,g){var C=m.type;return C===hr?v(p,f,m.props.children,g,m.key):f!==null&&(f.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Et&&wa(C)===f.type)?(g=l(f,m.props),g.ref=Yr(p,f,m),g.return=p,g):(g=ys(m.type,m.key,m.props,null,p.mode,g),g.ref=Yr(p,f,m),g.return=p,g)}function d(p,f,m,g){return f===null||f.tag!==4||f.stateNode.containerInfo!==m.containerInfo||f.stateNode.implementation!==m.implementation?(f=Bl(m,p.mode,g),f.return=p,f):(f=l(f,m.children||[]),f.return=p,f)}function v(p,f,m,g,C){return f===null||f.tag!==7?(f=sr(m,p.mode,g,C),f.return=p,f):(f=l(f,m),f.return=p,f)}function u(p,f,m){if(typeof f=="string"&&f!==""||typeof f=="number")return f=zl(""+f,p.mode,m),f.return=p,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case $n:return m=ys(f.type,f.key,f.props,null,p.mode,m),m.ref=Yr(p,null,f),m.return=p,m;case pr:return f=Bl(f,p.mode,m),f.return=p,f;case Et:var g=f._init;return u(p,g(f._payload),m)}if(nn(f)||Gr(f))return f=sr(f,p.mode,m,null),f.return=p,f;ts(p,f)}return null}function h(p,f,m,g){var C=f!==null?f.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return C!==null?null:a(p,f,""+m,g);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case $n:return m.key===C?c(p,f,m,g):null;case pr:return m.key===C?d(p,f,m,g):null;case Et:return C=m._init,h(p,f,C(m._payload),g)}if(nn(m)||Gr(m))return C!==null?null:v(p,f,m,g,null);ts(p,m)}return null}function x(p,f,m,g,C){if(typeof g=="string"&&g!==""||typeof g=="number")return p=p.get(m)||null,a(f,p,""+g,C);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case $n:return p=p.get(g.key===null?m:g.key)||null,c(f,p,g,C);case pr:return p=p.get(g.key===null?m:g.key)||null,d(f,p,g,C);case Et:var R=g._init;return x(p,f,m,R(g._payload),C)}if(nn(g)||Gr(g))return p=p.get(m)||null,v(f,p,g,C,null);ts(f,g)}return null}function b(p,f,m,g){for(var C=null,R=null,N=f,k=f=0,I=null;N!==null&&k<m.length;k++){N.index>k?(I=N,N=null):I=N.sibling;var E=h(p,N,m[k],g);if(E===null){N===null&&(N=I);break}e&&N&&E.alternate===null&&t(p,N),f=o(E,f,k),R===null?C=E:R.sibling=E,R=E,N=I}if(k===m.length)return n(p,N),de&&Jt(p,k),C;if(N===null){for(;k<m.length;k++)N=u(p,m[k],g),N!==null&&(f=o(N,f,k),R===null?C=N:R.sibling=N,R=N);return de&&Jt(p,k),C}for(N=s(p,N);k<m.length;k++)I=x(N,p,k,m[k],g),I!==null&&(e&&I.alternate!==null&&N.delete(I.key===null?k:I.key),f=o(I,f,k),R===null?C=I:R.sibling=I,R=I);return e&&N.forEach(function(w){return t(p,w)}),de&&Jt(p,k),C}function y(p,f,m,g){var C=Gr(m);if(typeof C!="function")throw Error(T(150));if(m=C.call(m),m==null)throw Error(T(151));for(var R=C=null,N=f,k=f=0,I=null,E=m.next();N!==null&&!E.done;k++,E=m.next()){N.index>k?(I=N,N=null):I=N.sibling;var w=h(p,N,E.value,g);if(w===null){N===null&&(N=I);break}e&&N&&w.alternate===null&&t(p,N),f=o(w,f,k),R===null?C=w:R.sibling=w,R=w,N=I}if(E.done)return n(p,N),de&&Jt(p,k),C;if(N===null){for(;!E.done;k++,E=m.next())E=u(p,E.value,g),E!==null&&(f=o(E,f,k),R===null?C=E:R.sibling=E,R=E);return de&&Jt(p,k),C}for(N=s(p,N);!E.done;k++,E=m.next())E=x(N,p,k,E.value,g),E!==null&&(e&&E.alternate!==null&&N.delete(E.key===null?k:E.key),f=o(E,f,k),R===null?C=E:R.sibling=E,R=E);return e&&N.forEach(function(S){return t(p,S)}),de&&Jt(p,k),C}function L(p,f,m,g){if(typeof m=="object"&&m!==null&&m.type===hr&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case $n:e:{for(var C=m.key,R=f;R!==null;){if(R.key===C){if(C=m.type,C===hr){if(R.tag===7){n(p,R.sibling),f=l(R,m.props.children),f.return=p,p=f;break e}}else if(R.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Et&&wa(C)===R.type){n(p,R.sibling),f=l(R,m.props),f.ref=Yr(p,R,m),f.return=p,p=f;break e}n(p,R);break}else t(p,R);R=R.sibling}m.type===hr?(f=sr(m.props.children,p.mode,g,m.key),f.return=p,p=f):(g=ys(m.type,m.key,m.props,null,p.mode,g),g.ref=Yr(p,f,m),g.return=p,p=g)}return i(p);case pr:e:{for(R=m.key;f!==null;){if(f.key===R)if(f.tag===4&&f.stateNode.containerInfo===m.containerInfo&&f.stateNode.implementation===m.implementation){n(p,f.sibling),f=l(f,m.children||[]),f.return=p,p=f;break e}else{n(p,f);break}else t(p,f);f=f.sibling}f=Bl(m,p.mode,g),f.return=p,p=f}return i(p);case Et:return R=m._init,L(p,f,R(m._payload),g)}if(nn(m))return b(p,f,m,g);if(Gr(m))return y(p,f,m,g);ts(p,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,f!==null&&f.tag===6?(n(p,f.sibling),f=l(f,m),f.return=p,p=f):(n(p,f),f=zl(m,p.mode,g),f.return=p,p=f),i(p)):n(p,f)}return L}var Mr=xd(!0),gd=xd(!1),As=Ut(null),Ps=null,Nr=null,ii=null;function ai(){ii=Nr=Ps=null}function ci(e){var t=As.current;ce(As),e._currentValue=t}function xo(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function Rr(e,t){Ps=e,ii=Nr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(De=!0),e.firstContext=null)}function Xe(e){var t=e._currentValue;if(ii!==e)if(e={context:e,memoizedValue:t,next:null},Nr===null){if(Ps===null)throw Error(T(308));Nr=e,Ps.dependencies={lanes:0,firstContext:e}}else Nr=Nr.next=e;return t}var er=null;function di(e){er===null?er=[e]:er.push(e)}function yd(e,t,n,s){var l=t.interleaved;return l===null?(n.next=n,di(t)):(n.next=l.next,l.next=n),t.interleaved=n,jt(e,s)}function jt(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var It=!1;function ui(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vd(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function vt(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zt(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,ne&2){var l=s.pending;return l===null?t.next=t:(t.next=l.next,l.next=t),s.pending=t,jt(e,n)}return l=s.interleaved,l===null?(t.next=t,di(s)):(t.next=l.next,l.next=t),s.interleaved=t,jt(e,n)}function fs(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Jo(e,n)}}function ja(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var l=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?l=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?l=o=t:o=o.next=t}else l=o=t;n={baseState:s.baseState,firstBaseUpdate:l,lastBaseUpdate:o,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ms(e,t,n,s){var l=e.updateQueue;It=!1;var o=l.firstBaseUpdate,i=l.lastBaseUpdate,a=l.shared.pending;if(a!==null){l.shared.pending=null;var c=a,d=c.next;c.next=null,i===null?o=d:i.next=d,i=c;var v=e.alternate;v!==null&&(v=v.updateQueue,a=v.lastBaseUpdate,a!==i&&(a===null?v.firstBaseUpdate=d:a.next=d,v.lastBaseUpdate=c))}if(o!==null){var u=l.baseState;i=0,v=d=c=null,a=o;do{var h=a.lane,x=a.eventTime;if((s&h)===h){v!==null&&(v=v.next={eventTime:x,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var b=e,y=a;switch(h=t,x=n,y.tag){case 1:if(b=y.payload,typeof b=="function"){u=b.call(x,u,h);break e}u=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=y.payload,h=typeof b=="function"?b.call(x,u,h):b,h==null)break e;u=pe({},u,h);break e;case 2:It=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,h=l.effects,h===null?l.effects=[a]:h.push(a))}else x={eventTime:x,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},v===null?(d=v=x,c=u):v=v.next=x,i|=h;if(a=a.next,a===null){if(a=l.shared.pending,a===null)break;h=a,a=h.next,h.next=null,l.lastBaseUpdate=h,l.shared.pending=null}}while(!0);if(v===null&&(c=u),l.baseState=c,l.firstBaseUpdate=d,l.lastBaseUpdate=v,t=l.shared.interleaved,t!==null){l=t;do i|=l.lane,l=l.next;while(l!==t)}else o===null&&(l.shared.lanes=0);ar|=i,e.lanes=i,e.memoizedState=u}}function Na(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],l=s.callback;if(l!==null){if(s.callback=null,s=n,typeof l!="function")throw Error(T(191,l));l.call(s)}}}var On={},mt=Ut(On),Ln=Ut(On),En=Ut(On);function tr(e){if(e===On)throw Error(T(174));return e}function fi(e,t){switch(oe(En,t),oe(Ln,e),oe(mt,On),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ql(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ql(t,e)}ce(mt),oe(mt,t)}function Dr(){ce(mt),ce(Ln),ce(En)}function bd(e){tr(En.current);var t=tr(mt.current),n=ql(t,e.type);t!==n&&(oe(Ln,e),oe(mt,n))}function mi(e){Ln.current===e&&(ce(mt),ce(Ln))}var ue=Ut(0);function Ds(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Tl=[];function pi(){for(var e=0;e<Tl.length;e++)Tl[e]._workInProgressVersionPrimary=null;Tl.length=0}var ms=kt.ReactCurrentDispatcher,Al=kt.ReactCurrentBatchConfig,ir=0,me=null,ve=null,we=null,Os=!1,fn=!1,In=0,Rf=0;function Le(){throw Error(T(321))}function hi(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ot(e[n],t[n]))return!1;return!0}function xi(e,t,n,s,l,o){if(ir=o,me=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ms.current=e===null||e.memoizedState===null?Pf:Mf,e=n(s,l),fn){o=0;do{if(fn=!1,In=0,25<=o)throw Error(T(301));o+=1,we=ve=null,t.updateQueue=null,ms.current=Df,e=n(s,l)}while(fn)}if(ms.current=zs,t=ve!==null&&ve.next!==null,ir=0,we=ve=me=null,Os=!1,t)throw Error(T(300));return e}function gi(){var e=In!==0;return In=0,e}function dt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return we===null?me.memoizedState=we=e:we=we.next=e,we}function Ze(){if(ve===null){var e=me.alternate;e=e!==null?e.memoizedState:null}else e=ve.next;var t=we===null?me.memoizedState:we.next;if(t!==null)we=t,ve=e;else{if(e===null)throw Error(T(310));ve=e,e={memoizedState:ve.memoizedState,baseState:ve.baseState,baseQueue:ve.baseQueue,queue:ve.queue,next:null},we===null?me.memoizedState=we=e:we=we.next=e}return we}function Rn(e,t){return typeof t=="function"?t(e):t}function Pl(e){var t=Ze(),n=t.queue;if(n===null)throw Error(T(311));n.lastRenderedReducer=e;var s=ve,l=s.baseQueue,o=n.pending;if(o!==null){if(l!==null){var i=l.next;l.next=o.next,o.next=i}s.baseQueue=l=o,n.pending=null}if(l!==null){o=l.next,s=s.baseState;var a=i=null,c=null,d=o;do{var v=d.lane;if((ir&v)===v)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:e(s,d.action);else{var u={lane:v,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(a=c=u,i=s):c=c.next=u,me.lanes|=v,ar|=v}d=d.next}while(d!==null&&d!==o);c===null?i=s:c.next=a,ot(s,t.memoizedState)||(De=!0),t.memoizedState=s,t.baseState=i,t.baseQueue=c,n.lastRenderedState=s}if(e=n.interleaved,e!==null){l=e;do o=l.lane,me.lanes|=o,ar|=o,l=l.next;while(l!==e)}else l===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ml(e){var t=Ze(),n=t.queue;if(n===null)throw Error(T(311));n.lastRenderedReducer=e;var s=n.dispatch,l=n.pending,o=t.memoizedState;if(l!==null){n.pending=null;var i=l=l.next;do o=e(o,i.action),i=i.next;while(i!==l);ot(o,t.memoizedState)||(De=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,s]}function wd(){}function jd(e,t){var n=me,s=Ze(),l=t(),o=!ot(s.memoizedState,l);if(o&&(s.memoizedState=l,De=!0),s=s.queue,yi(Sd.bind(null,n,s,e),[e]),s.getSnapshot!==t||o||we!==null&&we.memoizedState.tag&1){if(n.flags|=2048,_n(9,kd.bind(null,n,s,l,t),void 0,null),je===null)throw Error(T(349));ir&30||Nd(n,t,l)}return l}function Nd(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=me.updateQueue,t===null?(t={lastEffect:null,stores:null},me.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function kd(e,t,n,s){t.value=n,t.getSnapshot=s,Cd(t)&&Ld(e)}function Sd(e,t,n){return n(function(){Cd(t)&&Ld(e)})}function Cd(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ot(e,n)}catch{return!0}}function Ld(e){var t=jt(e,1);t!==null&&lt(t,e,1,-1)}function ka(e){var t=dt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Rn,lastRenderedState:e},t.queue=e,e=e.dispatch=Af.bind(null,me,e),[t.memoizedState,e]}function _n(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},t=me.updateQueue,t===null?(t={lastEffect:null,stores:null},me.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e)),e}function Ed(){return Ze().memoizedState}function ps(e,t,n,s){var l=dt();me.flags|=e,l.memoizedState=_n(1|t,n,void 0,s===void 0?null:s)}function Ys(e,t,n,s){var l=Ze();s=s===void 0?null:s;var o=void 0;if(ve!==null){var i=ve.memoizedState;if(o=i.destroy,s!==null&&hi(s,i.deps)){l.memoizedState=_n(t,n,o,s);return}}me.flags|=e,l.memoizedState=_n(1|t,n,o,s)}function Sa(e,t){return ps(8390656,8,e,t)}function yi(e,t){return Ys(2048,8,e,t)}function Id(e,t){return Ys(4,2,e,t)}function Rd(e,t){return Ys(4,4,e,t)}function _d(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Td(e,t,n){return n=n!=null?n.concat([e]):null,Ys(4,4,_d.bind(null,t,e),n)}function vi(){}function Ad(e,t){var n=Ze();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&hi(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function Pd(e,t){var n=Ze();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&hi(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function Md(e,t,n){return ir&21?(ot(n,t)||(n=Vc(),me.lanes|=n,ar|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,De=!0),e.memoizedState=n)}function _f(e,t){var n=se;se=n!==0&&4>n?n:4,e(!0);var s=Al.transition;Al.transition={};try{e(!1),t()}finally{se=n,Al.transition=s}}function Dd(){return Ze().memoizedState}function Tf(e,t,n){var s=Vt(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},Od(e))zd(t,n);else if(n=yd(e,t,n,s),n!==null){var l=Te();lt(n,e,s,l),Bd(n,t,s)}}function Af(e,t,n){var s=Vt(e),l={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(Od(e))zd(t,l);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var i=t.lastRenderedState,a=o(i,n);if(l.hasEagerState=!0,l.eagerState=a,ot(a,i)){var c=t.interleaved;c===null?(l.next=l,di(t)):(l.next=c.next,c.next=l),t.interleaved=l;return}}catch{}finally{}n=yd(e,t,l,s),n!==null&&(l=Te(),lt(n,e,s,l),Bd(n,t,s))}}function Od(e){var t=e.alternate;return e===me||t!==null&&t===me}function zd(e,t){fn=Os=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Bd(e,t,n){if(n&4194240){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Jo(e,n)}}var zs={readContext:Xe,useCallback:Le,useContext:Le,useEffect:Le,useImperativeHandle:Le,useInsertionEffect:Le,useLayoutEffect:Le,useMemo:Le,useReducer:Le,useRef:Le,useState:Le,useDebugValue:Le,useDeferredValue:Le,useTransition:Le,useMutableSource:Le,useSyncExternalStore:Le,useId:Le,unstable_isNewReconciler:!1},Pf={readContext:Xe,useCallback:function(e,t){return dt().memoizedState=[e,t===void 0?null:t],e},useContext:Xe,useEffect:Sa,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ps(4194308,4,_d.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ps(4194308,4,e,t)},useInsertionEffect:function(e,t){return ps(4,2,e,t)},useMemo:function(e,t){var n=dt();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=dt();return t=n!==void 0?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=Tf.bind(null,me,e),[s.memoizedState,e]},useRef:function(e){var t=dt();return e={current:e},t.memoizedState=e},useState:ka,useDebugValue:vi,useDeferredValue:function(e){return dt().memoizedState=e},useTransition:function(){var e=ka(!1),t=e[0];return e=_f.bind(null,e[1]),dt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=me,l=dt();if(de){if(n===void 0)throw Error(T(407));n=n()}else{if(n=t(),je===null)throw Error(T(349));ir&30||Nd(s,t,n)}l.memoizedState=n;var o={value:n,getSnapshot:t};return l.queue=o,Sa(Sd.bind(null,s,o,e),[e]),s.flags|=2048,_n(9,kd.bind(null,s,o,n,t),void 0,null),n},useId:function(){var e=dt(),t=je.identifierPrefix;if(de){var n=yt,s=gt;n=(s&~(1<<32-st(s)-1)).toString(32)+n,t=":"+t+"R"+n,n=In++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Rf++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Mf={readContext:Xe,useCallback:Ad,useContext:Xe,useEffect:yi,useImperativeHandle:Td,useInsertionEffect:Id,useLayoutEffect:Rd,useMemo:Pd,useReducer:Pl,useRef:Ed,useState:function(){return Pl(Rn)},useDebugValue:vi,useDeferredValue:function(e){var t=Ze();return Md(t,ve.memoizedState,e)},useTransition:function(){var e=Pl(Rn)[0],t=Ze().memoizedState;return[e,t]},useMutableSource:wd,useSyncExternalStore:jd,useId:Dd,unstable_isNewReconciler:!1},Df={readContext:Xe,useCallback:Ad,useContext:Xe,useEffect:yi,useImperativeHandle:Td,useInsertionEffect:Id,useLayoutEffect:Rd,useMemo:Pd,useReducer:Ml,useRef:Ed,useState:function(){return Ml(Rn)},useDebugValue:vi,useDeferredValue:function(e){var t=Ze();return ve===null?t.memoizedState=e:Md(t,ve.memoizedState,e)},useTransition:function(){var e=Ml(Rn)[0],t=Ze().memoizedState;return[e,t]},useMutableSource:wd,useSyncExternalStore:jd,useId:Dd,unstable_isNewReconciler:!1};function tt(e,t){if(e&&e.defaultProps){t=pe({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function go(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:pe({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Xs={isMounted:function(e){return(e=e._reactInternals)?ur(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=Te(),l=Vt(e),o=vt(s,l);o.payload=t,n!=null&&(o.callback=n),t=zt(e,o,l),t!==null&&(lt(t,e,l,s),fs(t,e,l))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=Te(),l=Vt(e),o=vt(s,l);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=zt(e,o,l),t!==null&&(lt(t,e,l,s),fs(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Te(),s=Vt(e),l=vt(n,s);l.tag=2,t!=null&&(l.callback=t),t=zt(e,l,s),t!==null&&(lt(t,e,s,n),fs(t,e,s))}};function Ca(e,t,n,s,l,o,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,o,i):t.prototype&&t.prototype.isPureReactComponent?!Nn(n,s)||!Nn(l,o):!0}function Vd(e,t,n){var s=!1,l=Ht,o=t.contextType;return typeof o=="object"&&o!==null?o=Xe(o):(l=ze(t)?lr:Re.current,s=t.contextTypes,o=(s=s!=null)?Ar(e,l):Ht),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Xs,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=o),t}function La(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Xs.enqueueReplaceState(t,t.state,null)}function yo(e,t,n,s){var l=e.stateNode;l.props=n,l.state=e.memoizedState,l.refs={},ui(e);var o=t.contextType;typeof o=="object"&&o!==null?l.context=Xe(o):(o=ze(t)?lr:Re.current,l.context=Ar(e,o)),l.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(go(e,t,o,n),l.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(t=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),t!==l.state&&Xs.enqueueReplaceState(l,l.state,null),Ms(e,n,l,s),l.state=e.memoizedState),typeof l.componentDidMount=="function"&&(e.flags|=4194308)}function Or(e,t){try{var n="",s=t;do n+=c0(s),s=s.return;while(s);var l=n}catch(o){l=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:l,digest:null}}function Dl(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function vo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Of=typeof WeakMap=="function"?WeakMap:Map;function Fd(e,t,n){n=vt(-1,n),n.tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){Vs||(Vs=!0,Io=s),vo(e,t)},n}function Wd(e,t,n){n=vt(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var l=t.value;n.payload=function(){return s(l)},n.callback=function(){vo(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){vo(e,t),typeof s!="function"&&(Bt===null?Bt=new Set([this]):Bt.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),n}function Ea(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new Of;var l=new Set;s.set(t,l)}else l=s.get(t),l===void 0&&(l=new Set,s.set(t,l));l.has(n)||(l.add(n),e=Yf.bind(null,e,t,n),t.then(e,e))}function Ia(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Ra(e,t,n,s,l){return e.mode&1?(e.flags|=65536,e.lanes=l,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=vt(-1,1),t.tag=2,zt(n,t,1))),n.lanes|=1),e)}var zf=kt.ReactCurrentOwner,De=!1;function _e(e,t,n,s){t.child=e===null?gd(t,null,n,s):Mr(t,e.child,n,s)}function _a(e,t,n,s,l){n=n.render;var o=t.ref;return Rr(t,l),s=xi(e,t,n,s,o,l),n=gi(),e!==null&&!De?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,Nt(e,t,l)):(de&&n&&si(t),t.flags|=1,_e(e,t,s,l),t.child)}function Ta(e,t,n,s,l){if(e===null){var o=n.type;return typeof o=="function"&&!Li(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,Hd(e,t,o,s,l)):(e=ys(n.type,null,s,t,t.mode,l),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&l)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:Nn,n(i,s)&&e.ref===t.ref)return Nt(e,t,l)}return t.flags|=1,e=Ft(o,s),e.ref=t.ref,e.return=t,t.child=e}function Hd(e,t,n,s,l){if(e!==null){var o=e.memoizedProps;if(Nn(o,s)&&e.ref===t.ref)if(De=!1,t.pendingProps=s=o,(e.lanes&l)!==0)e.flags&131072&&(De=!0);else return t.lanes=e.lanes,Nt(e,t,l)}return bo(e,t,n,s,l)}function $d(e,t,n){var s=t.pendingProps,l=s.children,o=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},oe(Sr,Fe),Fe|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,oe(Sr,Fe),Fe|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=o!==null?o.baseLanes:n,oe(Sr,Fe),Fe|=s}else o!==null?(s=o.baseLanes|n,t.memoizedState=null):s=n,oe(Sr,Fe),Fe|=s;return _e(e,t,l,n),t.child}function Ud(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function bo(e,t,n,s,l){var o=ze(n)?lr:Re.current;return o=Ar(t,o),Rr(t,l),n=xi(e,t,n,s,o,l),s=gi(),e!==null&&!De?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,Nt(e,t,l)):(de&&s&&si(t),t.flags|=1,_e(e,t,n,l),t.child)}function Aa(e,t,n,s,l){if(ze(n)){var o=!0;Rs(t)}else o=!1;if(Rr(t,l),t.stateNode===null)hs(e,t),Vd(t,n,s),yo(t,n,s,l),s=!0;else if(e===null){var i=t.stateNode,a=t.memoizedProps;i.props=a;var c=i.context,d=n.contextType;typeof d=="object"&&d!==null?d=Xe(d):(d=ze(n)?lr:Re.current,d=Ar(t,d));var v=n.getDerivedStateFromProps,u=typeof v=="function"||typeof i.getSnapshotBeforeUpdate=="function";u||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==s||c!==d)&&La(t,i,s,d),It=!1;var h=t.memoizedState;i.state=h,Ms(t,s,i,l),c=t.memoizedState,a!==s||h!==c||Oe.current||It?(typeof v=="function"&&(go(t,n,v,s),c=t.memoizedState),(a=It||Ca(t,n,a,s,h,c,d))?(u||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=c),i.props=s,i.state=c,i.context=d,s=a):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{i=t.stateNode,vd(e,t),a=t.memoizedProps,d=t.type===t.elementType?a:tt(t.type,a),i.props=d,u=t.pendingProps,h=i.context,c=n.contextType,typeof c=="object"&&c!==null?c=Xe(c):(c=ze(n)?lr:Re.current,c=Ar(t,c));var x=n.getDerivedStateFromProps;(v=typeof x=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==u||h!==c)&&La(t,i,s,c),It=!1,h=t.memoizedState,i.state=h,Ms(t,s,i,l);var b=t.memoizedState;a!==u||h!==b||Oe.current||It?(typeof x=="function"&&(go(t,n,x,s),b=t.memoizedState),(d=It||Ca(t,n,d,s,h,b,c)||!1)?(v||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(s,b,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(s,b,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=b),i.props=s,i.state=b,i.context=c,s=d):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),s=!1)}return wo(e,t,n,s,o,l)}function wo(e,t,n,s,l,o){Ud(e,t);var i=(t.flags&128)!==0;if(!s&&!i)return l&&ya(t,n,!1),Nt(e,t,o);s=t.stateNode,zf.current=t;var a=i&&typeof n.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&i?(t.child=Mr(t,e.child,null,o),t.child=Mr(t,null,a,o)):_e(e,t,a,o),t.memoizedState=s.state,l&&ya(t,n,!0),t.child}function Gd(e){var t=e.stateNode;t.pendingContext?ga(e,t.pendingContext,t.pendingContext!==t.context):t.context&&ga(e,t.context,!1),fi(e,t.containerInfo)}function Pa(e,t,n,s,l){return Pr(),oi(l),t.flags|=256,_e(e,t,n,s),t.child}var jo={dehydrated:null,treeContext:null,retryLane:0};function No(e){return{baseLanes:e,cachePool:null,transitions:null}}function Kd(e,t,n){var s=t.pendingProps,l=ue.current,o=!1,i=(t.flags&128)!==0,a;if((a=i)||(a=e!==null&&e.memoizedState===null?!1:(l&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(l|=1),oe(ue,l&1),e===null)return ho(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=s.children,e=s.fallback,o?(s=t.mode,o=t.child,i={mode:"hidden",children:i},!(s&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=tl(i,s,0,null),e=sr(e,s,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=No(n),t.memoizedState=jo,e):bi(t,i));if(l=e.memoizedState,l!==null&&(a=l.dehydrated,a!==null))return Bf(e,t,i,s,a,l,n);if(o){o=s.fallback,i=t.mode,l=e.child,a=l.sibling;var c={mode:"hidden",children:s.children};return!(i&1)&&t.child!==l?(s=t.child,s.childLanes=0,s.pendingProps=c,t.deletions=null):(s=Ft(l,c),s.subtreeFlags=l.subtreeFlags&14680064),a!==null?o=Ft(a,o):(o=sr(o,i,n,null),o.flags|=2),o.return=t,s.return=t,s.sibling=o,t.child=s,s=o,o=t.child,i=e.child.memoizedState,i=i===null?No(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=e.childLanes&~n,t.memoizedState=jo,s}return o=e.child,e=o.sibling,s=Ft(o,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=n),s.return=t,s.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function bi(e,t){return t=tl({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function rs(e,t,n,s){return s!==null&&oi(s),Mr(t,e.child,null,n),e=bi(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Bf(e,t,n,s,l,o,i){if(n)return t.flags&256?(t.flags&=-257,s=Dl(Error(T(422))),rs(e,t,i,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=s.fallback,l=t.mode,s=tl({mode:"visible",children:s.children},l,0,null),o=sr(o,l,i,null),o.flags|=2,s.return=t,o.return=t,s.sibling=o,t.child=s,t.mode&1&&Mr(t,e.child,null,i),t.child.memoizedState=No(i),t.memoizedState=jo,o);if(!(t.mode&1))return rs(e,t,i,null);if(l.data==="$!"){if(s=l.nextSibling&&l.nextSibling.dataset,s)var a=s.dgst;return s=a,o=Error(T(419)),s=Dl(o,s,void 0),rs(e,t,i,s)}if(a=(i&e.childLanes)!==0,De||a){if(s=je,s!==null){switch(i&-i){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=l&(s.suspendedLanes|i)?0:l,l!==0&&l!==o.retryLane&&(o.retryLane=l,jt(e,l),lt(s,e,l,-1))}return Ci(),s=Dl(Error(T(421))),rs(e,t,i,s)}return l.data==="$?"?(t.flags|=128,t.child=e.child,t=Xf.bind(null,e),l._reactRetry=t,null):(e=o.treeContext,We=Ot(l.nextSibling),He=t,de=!0,nt=null,e!==null&&(Qe[qe++]=gt,Qe[qe++]=yt,Qe[qe++]=or,gt=e.id,yt=e.overflow,or=t),t=bi(t,s.children),t.flags|=4096,t)}function Ma(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),xo(e.return,t,n)}function Ol(e,t,n,s,l){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:l}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=s,o.tail=n,o.tailMode=l)}function Qd(e,t,n){var s=t.pendingProps,l=s.revealOrder,o=s.tail;if(_e(e,t,s.children,n),s=ue.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Ma(e,n,t);else if(e.tag===19)Ma(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(oe(ue,s),!(t.mode&1))t.memoizedState=null;else switch(l){case"forwards":for(n=t.child,l=null;n!==null;)e=n.alternate,e!==null&&Ds(e)===null&&(l=n),n=n.sibling;n=l,n===null?(l=t.child,t.child=null):(l=n.sibling,n.sibling=null),Ol(t,!1,l,n,o);break;case"backwards":for(n=null,l=t.child,t.child=null;l!==null;){if(e=l.alternate,e!==null&&Ds(e)===null){t.child=l;break}e=l.sibling,l.sibling=n,n=l,l=e}Ol(t,!0,n,null,o);break;case"together":Ol(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function hs(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Nt(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ar|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(T(153));if(t.child!==null){for(e=t.child,n=Ft(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Ft(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Vf(e,t,n){switch(t.tag){case 3:Gd(t),Pr();break;case 5:bd(t);break;case 1:ze(t.type)&&Rs(t);break;case 4:fi(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,l=t.memoizedProps.value;oe(As,s._currentValue),s._currentValue=l;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(oe(ue,ue.current&1),t.flags|=128,null):n&t.child.childLanes?Kd(e,t,n):(oe(ue,ue.current&1),e=Nt(e,t,n),e!==null?e.sibling:null);oe(ue,ue.current&1);break;case 19:if(s=(n&t.childLanes)!==0,e.flags&128){if(s)return Qd(e,t,n);t.flags|=128}if(l=t.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),oe(ue,ue.current),s)break;return null;case 22:case 23:return t.lanes=0,$d(e,t,n)}return Nt(e,t,n)}var qd,ko,Jd,Yd;qd=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ko=function(){};Jd=function(e,t,n,s){var l=e.memoizedProps;if(l!==s){e=t.stateNode,tr(mt.current);var o=null;switch(n){case"input":l=Ul(e,l),s=Ul(e,s),o=[];break;case"select":l=pe({},l,{value:void 0}),s=pe({},s,{value:void 0}),o=[];break;case"textarea":l=Ql(e,l),s=Ql(e,s),o=[];break;default:typeof l.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=Es)}Jl(n,s);var i;n=null;for(d in l)if(!s.hasOwnProperty(d)&&l.hasOwnProperty(d)&&l[d]!=null)if(d==="style"){var a=l[d];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(xn.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in s){var c=s[d];if(a=l!=null?l[d]:void 0,s.hasOwnProperty(d)&&c!==a&&(c!=null||a!=null))if(d==="style")if(a){for(i in a)!a.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&a[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(o=o||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(xn.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&ae("scroll",e),o||a===c||(o=[])):(o=o||[]).push(d,c))}n&&(o=o||[]).push("style",n);var d=o;(t.updateQueue=d)&&(t.flags|=4)}};Yd=function(e,t,n,s){n!==s&&(t.flags|=4)};function Xr(e,t){if(!de)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Ee(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var l=e.child;l!==null;)n|=l.lanes|l.childLanes,s|=l.subtreeFlags&14680064,s|=l.flags&14680064,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)n|=l.lanes|l.childLanes,s|=l.subtreeFlags,s|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function Ff(e,t,n){var s=t.pendingProps;switch(li(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ee(t),null;case 1:return ze(t.type)&&Is(),Ee(t),null;case 3:return s=t.stateNode,Dr(),ce(Oe),ce(Re),pi(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(es(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,nt!==null&&(To(nt),nt=null))),ko(e,t),Ee(t),null;case 5:mi(t);var l=tr(En.current);if(n=t.type,e!==null&&t.stateNode!=null)Jd(e,t,n,s,l),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(T(166));return Ee(t),null}if(e=tr(mt.current),es(t)){s=t.stateNode,n=t.type;var o=t.memoizedProps;switch(s[ut]=t,s[Cn]=o,e=(t.mode&1)!==0,n){case"dialog":ae("cancel",s),ae("close",s);break;case"iframe":case"object":case"embed":ae("load",s);break;case"video":case"audio":for(l=0;l<ln.length;l++)ae(ln[l],s);break;case"source":ae("error",s);break;case"img":case"image":case"link":ae("error",s),ae("load",s);break;case"details":ae("toggle",s);break;case"input":$i(s,o),ae("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!o.multiple},ae("invalid",s);break;case"textarea":Gi(s,o),ae("invalid",s)}Jl(n,o),l=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?s.textContent!==a&&(o.suppressHydrationWarning!==!0&&Zn(s.textContent,a,e),l=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Zn(s.textContent,a,e),l=["children",""+a]):xn.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&ae("scroll",s)}switch(n){case"input":Un(s),Ui(s,o,!0);break;case"textarea":Un(s),Ki(s);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(s.onclick=Es)}s=l,t.updateQueue=s,s!==null&&(t.flags|=4)}else{i=l.nodeType===9?l:l.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Sc(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=i.createElement(n,{is:s.is}):(e=i.createElement(n),n==="select"&&(i=e,s.multiple?i.multiple=!0:s.size&&(i.size=s.size))):e=i.createElementNS(e,n),e[ut]=t,e[Cn]=s,qd(e,t,!1,!1),t.stateNode=e;e:{switch(i=Yl(n,s),n){case"dialog":ae("cancel",e),ae("close",e),l=s;break;case"iframe":case"object":case"embed":ae("load",e),l=s;break;case"video":case"audio":for(l=0;l<ln.length;l++)ae(ln[l],e);l=s;break;case"source":ae("error",e),l=s;break;case"img":case"image":case"link":ae("error",e),ae("load",e),l=s;break;case"details":ae("toggle",e),l=s;break;case"input":$i(e,s),l=Ul(e,s),ae("invalid",e);break;case"option":l=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},l=pe({},s,{value:void 0}),ae("invalid",e);break;case"textarea":Gi(e,s),l=Ql(e,s),ae("invalid",e);break;default:l=s}Jl(n,l),a=l;for(o in a)if(a.hasOwnProperty(o)){var c=a[o];o==="style"?Ec(e,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Cc(e,c)):o==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&gn(e,c):typeof c=="number"&&gn(e,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(xn.hasOwnProperty(o)?c!=null&&o==="onScroll"&&ae("scroll",e):c!=null&&$o(e,o,c,i))}switch(n){case"input":Un(e),Ui(e,s,!1);break;case"textarea":Un(e),Ki(e);break;case"option":s.value!=null&&e.setAttribute("value",""+Wt(s.value));break;case"select":e.multiple=!!s.multiple,o=s.value,o!=null?Cr(e,!!s.multiple,o,!1):s.defaultValue!=null&&Cr(e,!!s.multiple,s.defaultValue,!0);break;default:typeof l.onClick=="function"&&(e.onclick=Es)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ee(t),null;case 6:if(e&&t.stateNode!=null)Yd(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(T(166));if(n=tr(En.current),tr(mt.current),es(t)){if(s=t.stateNode,n=t.memoizedProps,s[ut]=t,(o=s.nodeValue!==n)&&(e=He,e!==null))switch(e.tag){case 3:Zn(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Zn(s.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[ut]=t,t.stateNode=s}return Ee(t),null;case 13:if(ce(ue),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(de&&We!==null&&t.mode&1&&!(t.flags&128))hd(),Pr(),t.flags|=98560,o=!1;else if(o=es(t),s!==null&&s.dehydrated!==null){if(e===null){if(!o)throw Error(T(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(T(317));o[ut]=t}else Pr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ee(t),o=!1}else nt!==null&&(To(nt),nt=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||ue.current&1?be===0&&(be=3):Ci())),t.updateQueue!==null&&(t.flags|=4),Ee(t),null);case 4:return Dr(),ko(e,t),e===null&&kn(t.stateNode.containerInfo),Ee(t),null;case 10:return ci(t.type._context),Ee(t),null;case 17:return ze(t.type)&&Is(),Ee(t),null;case 19:if(ce(ue),o=t.memoizedState,o===null)return Ee(t),null;if(s=(t.flags&128)!==0,i=o.rendering,i===null)if(s)Xr(o,!1);else{if(be!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Ds(e),i!==null){for(t.flags|=128,Xr(o,!1),s=i.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;n!==null;)o=n,e=s,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return oe(ue,ue.current&1|2),t.child}e=e.sibling}o.tail!==null&&xe()>zr&&(t.flags|=128,s=!0,Xr(o,!1),t.lanes=4194304)}else{if(!s)if(e=Ds(i),e!==null){if(t.flags|=128,s=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Xr(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!de)return Ee(t),null}else 2*xe()-o.renderingStartTime>zr&&n!==1073741824&&(t.flags|=128,s=!0,Xr(o,!1),t.lanes=4194304);o.isBackwards?(i.sibling=t.child,t.child=i):(n=o.last,n!==null?n.sibling=i:t.child=i,o.last=i)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=xe(),t.sibling=null,n=ue.current,oe(ue,s?n&1|2:n&1),t):(Ee(t),null);case 22:case 23:return Si(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?Fe&1073741824&&(Ee(t),t.subtreeFlags&6&&(t.flags|=8192)):Ee(t),null;case 24:return null;case 25:return null}throw Error(T(156,t.tag))}function Wf(e,t){switch(li(t),t.tag){case 1:return ze(t.type)&&Is(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Dr(),ce(Oe),ce(Re),pi(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return mi(t),null;case 13:if(ce(ue),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(T(340));Pr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ce(ue),null;case 4:return Dr(),null;case 10:return ci(t.type._context),null;case 22:case 23:return Si(),null;case 24:return null;default:return null}}var ns=!1,Ie=!1,Hf=typeof WeakSet=="function"?WeakSet:Set,O=null;function kr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){he(e,t,s)}else n.current=null}function So(e,t,n){try{n()}catch(s){he(e,t,s)}}var Da=!1;function $f(e,t){if(io=Ss,e=rd(),ni(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var l=s.anchorOffset,o=s.focusNode;s=s.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,a=-1,c=-1,d=0,v=0,u=e,h=null;t:for(;;){for(var x;u!==n||l!==0&&u.nodeType!==3||(a=i+l),u!==o||s!==0&&u.nodeType!==3||(c=i+s),u.nodeType===3&&(i+=u.nodeValue.length),(x=u.firstChild)!==null;)h=u,u=x;for(;;){if(u===e)break t;if(h===n&&++d===l&&(a=i),h===o&&++v===s&&(c=i),(x=u.nextSibling)!==null)break;u=h,h=u.parentNode}u=x}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ao={focusedElem:e,selectionRange:n},Ss=!1,O=t;O!==null;)if(t=O,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,O=e;else for(;O!==null;){t=O;try{var b=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var y=b.memoizedProps,L=b.memoizedState,p=t.stateNode,f=p.getSnapshotBeforeUpdate(t.elementType===t.type?y:tt(t.type,y),L);p.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var m=t.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(T(163))}}catch(g){he(t,t.return,g)}if(e=t.sibling,e!==null){e.return=t.return,O=e;break}O=t.return}return b=Da,Da=!1,b}function mn(e,t,n){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var l=s=s.next;do{if((l.tag&e)===e){var o=l.destroy;l.destroy=void 0,o!==void 0&&So(t,n,o)}l=l.next}while(l!==s)}}function Zs(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function Co(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Xd(e){var t=e.alternate;t!==null&&(e.alternate=null,Xd(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ut],delete t[Cn],delete t[fo],delete t[Cf],delete t[Lf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Zd(e){return e.tag===5||e.tag===3||e.tag===4}function Oa(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Zd(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Lo(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Es));else if(s!==4&&(e=e.child,e!==null))for(Lo(e,t,n),e=e.sibling;e!==null;)Lo(e,t,n),e=e.sibling}function Eo(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Eo(e,t,n),e=e.sibling;e!==null;)Eo(e,t,n),e=e.sibling}var Ne=null,rt=!1;function Lt(e,t,n){for(n=n.child;n!==null;)eu(e,t,n),n=n.sibling}function eu(e,t,n){if(ft&&typeof ft.onCommitFiberUnmount=="function")try{ft.onCommitFiberUnmount(Us,n)}catch{}switch(n.tag){case 5:Ie||kr(n,t);case 6:var s=Ne,l=rt;Ne=null,Lt(e,t,n),Ne=s,rt=l,Ne!==null&&(rt?(e=Ne,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Ne.removeChild(n.stateNode));break;case 18:Ne!==null&&(rt?(e=Ne,n=n.stateNode,e.nodeType===8?Rl(e.parentNode,n):e.nodeType===1&&Rl(e,n),wn(e)):Rl(Ne,n.stateNode));break;case 4:s=Ne,l=rt,Ne=n.stateNode.containerInfo,rt=!0,Lt(e,t,n),Ne=s,rt=l;break;case 0:case 11:case 14:case 15:if(!Ie&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){l=s=s.next;do{var o=l,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&So(n,t,i),l=l.next}while(l!==s)}Lt(e,t,n);break;case 1:if(!Ie&&(kr(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){he(n,t,a)}Lt(e,t,n);break;case 21:Lt(e,t,n);break;case 22:n.mode&1?(Ie=(s=Ie)||n.memoizedState!==null,Lt(e,t,n),Ie=s):Lt(e,t,n);break;default:Lt(e,t,n)}}function za(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Hf),t.forEach(function(s){var l=Zf.bind(null,e,s);n.has(s)||(n.add(s),s.then(l,l))})}}function et(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var l=n[s];try{var o=e,i=t,a=i;e:for(;a!==null;){switch(a.tag){case 5:Ne=a.stateNode,rt=!1;break e;case 3:Ne=a.stateNode.containerInfo,rt=!0;break e;case 4:Ne=a.stateNode.containerInfo,rt=!0;break e}a=a.return}if(Ne===null)throw Error(T(160));eu(o,i,l),Ne=null,rt=!1;var c=l.alternate;c!==null&&(c.return=null),l.return=null}catch(d){he(l,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)tu(t,e),t=t.sibling}function tu(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(et(t,e),ct(e),s&4){try{mn(3,e,e.return),Zs(3,e)}catch(y){he(e,e.return,y)}try{mn(5,e,e.return)}catch(y){he(e,e.return,y)}}break;case 1:et(t,e),ct(e),s&512&&n!==null&&kr(n,n.return);break;case 5:if(et(t,e),ct(e),s&512&&n!==null&&kr(n,n.return),e.flags&32){var l=e.stateNode;try{gn(l,"")}catch(y){he(e,e.return,y)}}if(s&4&&(l=e.stateNode,l!=null)){var o=e.memoizedProps,i=n!==null?n.memoizedProps:o,a=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&Nc(l,o),Yl(a,i);var d=Yl(a,o);for(i=0;i<c.length;i+=2){var v=c[i],u=c[i+1];v==="style"?Ec(l,u):v==="dangerouslySetInnerHTML"?Cc(l,u):v==="children"?gn(l,u):$o(l,v,u,d)}switch(a){case"input":Gl(l,o);break;case"textarea":kc(l,o);break;case"select":var h=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!o.multiple;var x=o.value;x!=null?Cr(l,!!o.multiple,x,!1):h!==!!o.multiple&&(o.defaultValue!=null?Cr(l,!!o.multiple,o.defaultValue,!0):Cr(l,!!o.multiple,o.multiple?[]:"",!1))}l[Cn]=o}catch(y){he(e,e.return,y)}}break;case 6:if(et(t,e),ct(e),s&4){if(e.stateNode===null)throw Error(T(162));l=e.stateNode,o=e.memoizedProps;try{l.nodeValue=o}catch(y){he(e,e.return,y)}}break;case 3:if(et(t,e),ct(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{wn(t.containerInfo)}catch(y){he(e,e.return,y)}break;case 4:et(t,e),ct(e);break;case 13:et(t,e),ct(e),l=e.child,l.flags&8192&&(o=l.memoizedState!==null,l.stateNode.isHidden=o,!o||l.alternate!==null&&l.alternate.memoizedState!==null||(Ni=xe())),s&4&&za(e);break;case 22:if(v=n!==null&&n.memoizedState!==null,e.mode&1?(Ie=(d=Ie)||v,et(t,e),Ie=d):et(t,e),ct(e),s&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!v&&e.mode&1)for(O=e,v=e.child;v!==null;){for(u=O=v;O!==null;){switch(h=O,x=h.child,h.tag){case 0:case 11:case 14:case 15:mn(4,h,h.return);break;case 1:kr(h,h.return);var b=h.stateNode;if(typeof b.componentWillUnmount=="function"){s=h,n=h.return;try{t=s,b.props=t.memoizedProps,b.state=t.memoizedState,b.componentWillUnmount()}catch(y){he(s,n,y)}}break;case 5:kr(h,h.return);break;case 22:if(h.memoizedState!==null){Va(u);continue}}x!==null?(x.return=h,O=x):Va(u)}v=v.sibling}e:for(v=null,u=e;;){if(u.tag===5){if(v===null){v=u;try{l=u.stateNode,d?(o=l.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=u.stateNode,c=u.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=Lc("display",i))}catch(y){he(e,e.return,y)}}}else if(u.tag===6){if(v===null)try{u.stateNode.nodeValue=d?"":u.memoizedProps}catch(y){he(e,e.return,y)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===e)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;u.sibling===null;){if(u.return===null||u.return===e)break e;v===u&&(v=null),u=u.return}v===u&&(v=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:et(t,e),ct(e),s&4&&za(e);break;case 21:break;default:et(t,e),ct(e)}}function ct(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Zd(n)){var s=n;break e}n=n.return}throw Error(T(160))}switch(s.tag){case 5:var l=s.stateNode;s.flags&32&&(gn(l,""),s.flags&=-33);var o=Oa(e);Eo(e,o,l);break;case 3:case 4:var i=s.stateNode.containerInfo,a=Oa(e);Lo(e,a,i);break;default:throw Error(T(161))}}catch(c){he(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Uf(e,t,n){O=e,ru(e)}function ru(e,t,n){for(var s=(e.mode&1)!==0;O!==null;){var l=O,o=l.child;if(l.tag===22&&s){var i=l.memoizedState!==null||ns;if(!i){var a=l.alternate,c=a!==null&&a.memoizedState!==null||Ie;a=ns;var d=Ie;if(ns=i,(Ie=c)&&!d)for(O=l;O!==null;)i=O,c=i.child,i.tag===22&&i.memoizedState!==null?Fa(l):c!==null?(c.return=i,O=c):Fa(l);for(;o!==null;)O=o,ru(o),o=o.sibling;O=l,ns=a,Ie=d}Ba(e)}else l.subtreeFlags&8772&&o!==null?(o.return=l,O=o):Ba(e)}}function Ba(e){for(;O!==null;){var t=O;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ie||Zs(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!Ie)if(n===null)s.componentDidMount();else{var l=t.elementType===t.type?n.memoizedProps:tt(t.type,n.memoizedProps);s.componentDidUpdate(l,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&Na(t,o,s);break;case 3:var i=t.updateQueue;if(i!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Na(t,i,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var v=d.memoizedState;if(v!==null){var u=v.dehydrated;u!==null&&wn(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(T(163))}Ie||t.flags&512&&Co(t)}catch(h){he(t,t.return,h)}}if(t===e){O=null;break}if(n=t.sibling,n!==null){n.return=t.return,O=n;break}O=t.return}}function Va(e){for(;O!==null;){var t=O;if(t===e){O=null;break}var n=t.sibling;if(n!==null){n.return=t.return,O=n;break}O=t.return}}function Fa(e){for(;O!==null;){var t=O;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Zs(4,t)}catch(c){he(t,n,c)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var l=t.return;try{s.componentDidMount()}catch(c){he(t,l,c)}}var o=t.return;try{Co(t)}catch(c){he(t,o,c)}break;case 5:var i=t.return;try{Co(t)}catch(c){he(t,i,c)}}}catch(c){he(t,t.return,c)}if(t===e){O=null;break}var a=t.sibling;if(a!==null){a.return=t.return,O=a;break}O=t.return}}var Gf=Math.ceil,Bs=kt.ReactCurrentDispatcher,wi=kt.ReactCurrentOwner,Ye=kt.ReactCurrentBatchConfig,ne=0,je=null,ye=null,ke=0,Fe=0,Sr=Ut(0),be=0,Tn=null,ar=0,el=0,ji=0,pn=null,Me=null,Ni=0,zr=1/0,ht=null,Vs=!1,Io=null,Bt=null,ss=!1,At=null,Fs=0,hn=0,Ro=null,xs=-1,gs=0;function Te(){return ne&6?xe():xs!==-1?xs:xs=xe()}function Vt(e){return e.mode&1?ne&2&&ke!==0?ke&-ke:If.transition!==null?(gs===0&&(gs=Vc()),gs):(e=se,e!==0||(e=window.event,e=e===void 0?16:Kc(e.type)),e):1}function lt(e,t,n,s){if(50<hn)throw hn=0,Ro=null,Error(T(185));Pn(e,n,s),(!(ne&2)||e!==je)&&(e===je&&(!(ne&2)&&(el|=n),be===4&&_t(e,ke)),Be(e,s),n===1&&ne===0&&!(t.mode&1)&&(zr=xe()+500,Js&&Gt()))}function Be(e,t){var n=e.callbackNode;E0(e,t);var s=ks(e,e===je?ke:0);if(s===0)n!==null&&Ji(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(n!=null&&Ji(n),t===1)e.tag===0?Ef(Wa.bind(null,e)):fd(Wa.bind(null,e)),kf(function(){!(ne&6)&&Gt()}),n=null;else{switch(Fc(s)){case 1:n=qo;break;case 4:n=zc;break;case 16:n=Ns;break;case 536870912:n=Bc;break;default:n=Ns}n=du(n,nu.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function nu(e,t){if(xs=-1,gs=0,ne&6)throw Error(T(327));var n=e.callbackNode;if(_r()&&e.callbackNode!==n)return null;var s=ks(e,e===je?ke:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=Ws(e,s);else{t=s;var l=ne;ne|=2;var o=lu();(je!==e||ke!==t)&&(ht=null,zr=xe()+500,nr(e,t));do try{qf();break}catch(a){su(e,a)}while(!0);ai(),Bs.current=o,ne=l,ye!==null?t=0:(je=null,ke=0,t=be)}if(t!==0){if(t===2&&(l=ro(e),l!==0&&(s=l,t=_o(e,l))),t===1)throw n=Tn,nr(e,0),_t(e,s),Be(e,xe()),n;if(t===6)_t(e,s);else{if(l=e.current.alternate,!(s&30)&&!Kf(l)&&(t=Ws(e,s),t===2&&(o=ro(e),o!==0&&(s=o,t=_o(e,o))),t===1))throw n=Tn,nr(e,0),_t(e,s),Be(e,xe()),n;switch(e.finishedWork=l,e.finishedLanes=s,t){case 0:case 1:throw Error(T(345));case 2:Yt(e,Me,ht);break;case 3:if(_t(e,s),(s&130023424)===s&&(t=Ni+500-xe(),10<t)){if(ks(e,0)!==0)break;if(l=e.suspendedLanes,(l&s)!==s){Te(),e.pingedLanes|=e.suspendedLanes&l;break}e.timeoutHandle=uo(Yt.bind(null,e,Me,ht),t);break}Yt(e,Me,ht);break;case 4:if(_t(e,s),(s&4194240)===s)break;for(t=e.eventTimes,l=-1;0<s;){var i=31-st(s);o=1<<i,i=t[i],i>l&&(l=i),s&=~o}if(s=l,s=xe()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*Gf(s/1960))-s,10<s){e.timeoutHandle=uo(Yt.bind(null,e,Me,ht),s);break}Yt(e,Me,ht);break;case 5:Yt(e,Me,ht);break;default:throw Error(T(329))}}}return Be(e,xe()),e.callbackNode===n?nu.bind(null,e):null}function _o(e,t){var n=pn;return e.current.memoizedState.isDehydrated&&(nr(e,t).flags|=256),e=Ws(e,t),e!==2&&(t=Me,Me=n,t!==null&&To(t)),e}function To(e){Me===null?Me=e:Me.push.apply(Me,e)}function Kf(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var l=n[s],o=l.getSnapshot;l=l.value;try{if(!ot(o(),l))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function _t(e,t){for(t&=~ji,t&=~el,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),s=1<<n;e[n]=-1,t&=~s}}function Wa(e){if(ne&6)throw Error(T(327));_r();var t=ks(e,0);if(!(t&1))return Be(e,xe()),null;var n=Ws(e,t);if(e.tag!==0&&n===2){var s=ro(e);s!==0&&(t=s,n=_o(e,s))}if(n===1)throw n=Tn,nr(e,0),_t(e,t),Be(e,xe()),n;if(n===6)throw Error(T(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Yt(e,Me,ht),Be(e,xe()),null}function ki(e,t){var n=ne;ne|=1;try{return e(t)}finally{ne=n,ne===0&&(zr=xe()+500,Js&&Gt())}}function cr(e){At!==null&&At.tag===0&&!(ne&6)&&_r();var t=ne;ne|=1;var n=Ye.transition,s=se;try{if(Ye.transition=null,se=1,e)return e()}finally{se=s,Ye.transition=n,ne=t,!(ne&6)&&Gt()}}function Si(){Fe=Sr.current,ce(Sr)}function nr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Nf(n)),ye!==null)for(n=ye.return;n!==null;){var s=n;switch(li(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Is();break;case 3:Dr(),ce(Oe),ce(Re),pi();break;case 5:mi(s);break;case 4:Dr();break;case 13:ce(ue);break;case 19:ce(ue);break;case 10:ci(s.type._context);break;case 22:case 23:Si()}n=n.return}if(je=e,ye=e=Ft(e.current,null),ke=Fe=t,be=0,Tn=null,ji=el=ar=0,Me=pn=null,er!==null){for(t=0;t<er.length;t++)if(n=er[t],s=n.interleaved,s!==null){n.interleaved=null;var l=s.next,o=n.pending;if(o!==null){var i=o.next;o.next=l,s.next=i}n.pending=s}er=null}return e}function su(e,t){do{var n=ye;try{if(ai(),ms.current=zs,Os){for(var s=me.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}Os=!1}if(ir=0,we=ve=me=null,fn=!1,In=0,wi.current=null,n===null||n.return===null){be=1,Tn=t,ye=null;break}e:{var o=e,i=n.return,a=n,c=t;if(t=ke,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,v=a,u=v.tag;if(!(v.mode&1)&&(u===0||u===11||u===15)){var h=v.alternate;h?(v.updateQueue=h.updateQueue,v.memoizedState=h.memoizedState,v.lanes=h.lanes):(v.updateQueue=null,v.memoizedState=null)}var x=Ia(i);if(x!==null){x.flags&=-257,Ra(x,i,a,o,t),x.mode&1&&Ea(o,d,t),t=x,c=d;var b=t.updateQueue;if(b===null){var y=new Set;y.add(c),t.updateQueue=y}else b.add(c);break e}else{if(!(t&1)){Ea(o,d,t),Ci();break e}c=Error(T(426))}}else if(de&&a.mode&1){var L=Ia(i);if(L!==null){!(L.flags&65536)&&(L.flags|=256),Ra(L,i,a,o,t),oi(Or(c,a));break e}}o=c=Or(c,a),be!==4&&(be=2),pn===null?pn=[o]:pn.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var p=Fd(o,c,t);ja(o,p);break e;case 1:a=c;var f=o.type,m=o.stateNode;if(!(o.flags&128)&&(typeof f.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Bt===null||!Bt.has(m)))){o.flags|=65536,t&=-t,o.lanes|=t;var g=Wd(o,a,t);ja(o,g);break e}}o=o.return}while(o!==null)}iu(n)}catch(C){t=C,ye===n&&n!==null&&(ye=n=n.return);continue}break}while(!0)}function lu(){var e=Bs.current;return Bs.current=zs,e===null?zs:e}function Ci(){(be===0||be===3||be===2)&&(be=4),je===null||!(ar&268435455)&&!(el&268435455)||_t(je,ke)}function Ws(e,t){var n=ne;ne|=2;var s=lu();(je!==e||ke!==t)&&(ht=null,nr(e,t));do try{Qf();break}catch(l){su(e,l)}while(!0);if(ai(),ne=n,Bs.current=s,ye!==null)throw Error(T(261));return je=null,ke=0,be}function Qf(){for(;ye!==null;)ou(ye)}function qf(){for(;ye!==null&&!v0();)ou(ye)}function ou(e){var t=cu(e.alternate,e,Fe);e.memoizedProps=e.pendingProps,t===null?iu(e):ye=t,wi.current=null}function iu(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Wf(n,t),n!==null){n.flags&=32767,ye=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{be=6,ye=null;return}}else if(n=Ff(n,t,Fe),n!==null){ye=n;return}if(t=t.sibling,t!==null){ye=t;return}ye=t=e}while(t!==null);be===0&&(be=5)}function Yt(e,t,n){var s=se,l=Ye.transition;try{Ye.transition=null,se=1,Jf(e,t,n,s)}finally{Ye.transition=l,se=s}return null}function Jf(e,t,n,s){do _r();while(At!==null);if(ne&6)throw Error(T(327));n=e.finishedWork;var l=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(T(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(I0(e,o),e===je&&(ye=je=null,ke=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ss||(ss=!0,du(Ns,function(){return _r(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Ye.transition,Ye.transition=null;var i=se;se=1;var a=ne;ne|=4,wi.current=null,$f(e,n),tu(n,e),xf(ao),Ss=!!io,ao=io=null,e.current=n,Uf(n),b0(),ne=a,se=i,Ye.transition=o}else e.current=n;if(ss&&(ss=!1,At=e,Fs=l),o=e.pendingLanes,o===0&&(Bt=null),N0(n.stateNode),Be(e,xe()),t!==null)for(s=e.onRecoverableError,n=0;n<t.length;n++)l=t[n],s(l.value,{componentStack:l.stack,digest:l.digest});if(Vs)throw Vs=!1,e=Io,Io=null,e;return Fs&1&&e.tag!==0&&_r(),o=e.pendingLanes,o&1?e===Ro?hn++:(hn=0,Ro=e):hn=0,Gt(),null}function _r(){if(At!==null){var e=Fc(Fs),t=Ye.transition,n=se;try{if(Ye.transition=null,se=16>e?16:e,At===null)var s=!1;else{if(e=At,At=null,Fs=0,ne&6)throw Error(T(331));var l=ne;for(ne|=4,O=e.current;O!==null;){var o=O,i=o.child;if(O.flags&16){var a=o.deletions;if(a!==null){for(var c=0;c<a.length;c++){var d=a[c];for(O=d;O!==null;){var v=O;switch(v.tag){case 0:case 11:case 15:mn(8,v,o)}var u=v.child;if(u!==null)u.return=v,O=u;else for(;O!==null;){v=O;var h=v.sibling,x=v.return;if(Xd(v),v===d){O=null;break}if(h!==null){h.return=x,O=h;break}O=x}}}var b=o.alternate;if(b!==null){var y=b.child;if(y!==null){b.child=null;do{var L=y.sibling;y.sibling=null,y=L}while(y!==null)}}O=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,O=i;else e:for(;O!==null;){if(o=O,o.flags&2048)switch(o.tag){case 0:case 11:case 15:mn(9,o,o.return)}var p=o.sibling;if(p!==null){p.return=o.return,O=p;break e}O=o.return}}var f=e.current;for(O=f;O!==null;){i=O;var m=i.child;if(i.subtreeFlags&2064&&m!==null)m.return=i,O=m;else e:for(i=f;O!==null;){if(a=O,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Zs(9,a)}}catch(C){he(a,a.return,C)}if(a===i){O=null;break e}var g=a.sibling;if(g!==null){g.return=a.return,O=g;break e}O=a.return}}if(ne=l,Gt(),ft&&typeof ft.onPostCommitFiberRoot=="function")try{ft.onPostCommitFiberRoot(Us,e)}catch{}s=!0}return s}finally{se=n,Ye.transition=t}}return!1}function Ha(e,t,n){t=Or(n,t),t=Fd(e,t,1),e=zt(e,t,1),t=Te(),e!==null&&(Pn(e,1,t),Be(e,t))}function he(e,t,n){if(e.tag===3)Ha(e,e,n);else for(;t!==null;){if(t.tag===3){Ha(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Bt===null||!Bt.has(s))){e=Or(n,e),e=Wd(t,e,1),t=zt(t,e,1),e=Te(),t!==null&&(Pn(t,1,e),Be(t,e));break}}t=t.return}}function Yf(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),t=Te(),e.pingedLanes|=e.suspendedLanes&n,je===e&&(ke&n)===n&&(be===4||be===3&&(ke&130023424)===ke&&500>xe()-Ni?nr(e,0):ji|=n),Be(e,t)}function au(e,t){t===0&&(e.mode&1?(t=Qn,Qn<<=1,!(Qn&130023424)&&(Qn=4194304)):t=1);var n=Te();e=jt(e,t),e!==null&&(Pn(e,t,n),Be(e,n))}function Xf(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),au(e,n)}function Zf(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,l=e.memoizedState;l!==null&&(n=l.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(T(314))}s!==null&&s.delete(t),au(e,n)}var cu;cu=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Oe.current)De=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return De=!1,Vf(e,t,n);De=!!(e.flags&131072)}else De=!1,de&&t.flags&1048576&&md(t,Ts,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;hs(e,t),e=t.pendingProps;var l=Ar(t,Re.current);Rr(t,n),l=xi(null,t,s,e,l,n);var o=gi();return t.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ze(s)?(o=!0,Rs(t)):o=!1,t.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,ui(t),l.updater=Xs,t.stateNode=l,l._reactInternals=t,yo(t,s,e,n),t=wo(null,t,s,!0,o,n)):(t.tag=0,de&&o&&si(t),_e(null,t,l,n),t=t.child),t;case 16:s=t.elementType;e:{switch(hs(e,t),e=t.pendingProps,l=s._init,s=l(s._payload),t.type=s,l=t.tag=tm(s),e=tt(s,e),l){case 0:t=bo(null,t,s,e,n);break e;case 1:t=Aa(null,t,s,e,n);break e;case 11:t=_a(null,t,s,e,n);break e;case 14:t=Ta(null,t,s,tt(s.type,e),n);break e}throw Error(T(306,s,""))}return t;case 0:return s=t.type,l=t.pendingProps,l=t.elementType===s?l:tt(s,l),bo(e,t,s,l,n);case 1:return s=t.type,l=t.pendingProps,l=t.elementType===s?l:tt(s,l),Aa(e,t,s,l,n);case 3:e:{if(Gd(t),e===null)throw Error(T(387));s=t.pendingProps,o=t.memoizedState,l=o.element,vd(e,t),Ms(t,s,null,n);var i=t.memoizedState;if(s=i.element,o.isDehydrated)if(o={element:s,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){l=Or(Error(T(423)),t),t=Pa(e,t,s,n,l);break e}else if(s!==l){l=Or(Error(T(424)),t),t=Pa(e,t,s,n,l);break e}else for(We=Ot(t.stateNode.containerInfo.firstChild),He=t,de=!0,nt=null,n=gd(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Pr(),s===l){t=Nt(e,t,n);break e}_e(e,t,s,n)}t=t.child}return t;case 5:return bd(t),e===null&&ho(t),s=t.type,l=t.pendingProps,o=e!==null?e.memoizedProps:null,i=l.children,co(s,l)?i=null:o!==null&&co(s,o)&&(t.flags|=32),Ud(e,t),_e(e,t,i,n),t.child;case 6:return e===null&&ho(t),null;case 13:return Kd(e,t,n);case 4:return fi(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Mr(t,null,s,n):_e(e,t,s,n),t.child;case 11:return s=t.type,l=t.pendingProps,l=t.elementType===s?l:tt(s,l),_a(e,t,s,l,n);case 7:return _e(e,t,t.pendingProps,n),t.child;case 8:return _e(e,t,t.pendingProps.children,n),t.child;case 12:return _e(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,l=t.pendingProps,o=t.memoizedProps,i=l.value,oe(As,s._currentValue),s._currentValue=i,o!==null)if(ot(o.value,i)){if(o.children===l.children&&!Oe.current){t=Nt(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var c=a.firstContext;c!==null;){if(c.context===s){if(o.tag===1){c=vt(-1,n&-n),c.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var v=d.pending;v===null?c.next=c:(c.next=v.next,v.next=c),d.pending=c}}o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),xo(o.return,n,t),a.lanes|=n;break}c=c.next}}else if(o.tag===10)i=o.type===t.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(T(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),xo(i,n,t),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===t){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}_e(e,t,l.children,n),t=t.child}return t;case 9:return l=t.type,s=t.pendingProps.children,Rr(t,n),l=Xe(l),s=s(l),t.flags|=1,_e(e,t,s,n),t.child;case 14:return s=t.type,l=tt(s,t.pendingProps),l=tt(s.type,l),Ta(e,t,s,l,n);case 15:return Hd(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,l=t.pendingProps,l=t.elementType===s?l:tt(s,l),hs(e,t),t.tag=1,ze(s)?(e=!0,Rs(t)):e=!1,Rr(t,n),Vd(t,s,l),yo(t,s,l,n),wo(null,t,s,!0,e,n);case 19:return Qd(e,t,n);case 22:return $d(e,t,n)}throw Error(T(156,t.tag))};function du(e,t){return Oc(e,t)}function em(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Je(e,t,n,s){return new em(e,t,n,s)}function Li(e){return e=e.prototype,!(!e||!e.isReactComponent)}function tm(e){if(typeof e=="function")return Li(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Go)return 11;if(e===Ko)return 14}return 2}function Ft(e,t){var n=e.alternate;return n===null?(n=Je(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ys(e,t,n,s,l,o){var i=2;if(s=e,typeof e=="function")Li(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case hr:return sr(n.children,l,o,t);case Uo:i=8,l|=8;break;case Fl:return e=Je(12,n,t,l|2),e.elementType=Fl,e.lanes=o,e;case Wl:return e=Je(13,n,t,l),e.elementType=Wl,e.lanes=o,e;case Hl:return e=Je(19,n,t,l),e.elementType=Hl,e.lanes=o,e;case bc:return tl(n,l,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case yc:i=10;break e;case vc:i=9;break e;case Go:i=11;break e;case Ko:i=14;break e;case Et:i=16,s=null;break e}throw Error(T(130,e==null?e:typeof e,""))}return t=Je(i,n,t,l),t.elementType=e,t.type=s,t.lanes=o,t}function sr(e,t,n,s){return e=Je(7,e,s,t),e.lanes=n,e}function tl(e,t,n,s){return e=Je(22,e,s,t),e.elementType=bc,e.lanes=n,e.stateNode={isHidden:!1},e}function zl(e,t,n){return e=Je(6,e,null,t),e.lanes=n,e}function Bl(e,t,n){return t=Je(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function rm(e,t,n,s,l){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vl(0),this.expirationTimes=vl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vl(0),this.identifierPrefix=s,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function Ei(e,t,n,s,l,o,i,a,c){return e=new rm(e,t,n,a,c),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Je(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ui(o),e}function nm(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:pr,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}function uu(e){if(!e)return Ht;e=e._reactInternals;e:{if(ur(e)!==e||e.tag!==1)throw Error(T(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ze(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(T(171))}if(e.tag===1){var n=e.type;if(ze(n))return ud(e,n,t)}return t}function fu(e,t,n,s,l,o,i,a,c){return e=Ei(n,s,!0,e,l,o,i,a,c),e.context=uu(null),n=e.current,s=Te(),l=Vt(n),o=vt(s,l),o.callback=t??null,zt(n,o,l),e.current.lanes=l,Pn(e,l,s),Be(e,s),e}function rl(e,t,n,s){var l=t.current,o=Te(),i=Vt(l);return n=uu(n),t.context===null?t.context=n:t.pendingContext=n,t=vt(o,i),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=zt(l,t,i),e!==null&&(lt(e,l,i,o),fs(e,l,i)),i}function Hs(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function $a(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Ii(e,t){$a(e,t),(e=e.alternate)&&$a(e,t)}function sm(){return null}var mu=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ri(e){this._internalRoot=e}nl.prototype.render=Ri.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(T(409));rl(e,t,null,null)};nl.prototype.unmount=Ri.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;cr(function(){rl(null,e,null,null)}),t[wt]=null}};function nl(e){this._internalRoot=e}nl.prototype.unstable_scheduleHydration=function(e){if(e){var t=$c();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rt.length&&t!==0&&t<Rt[n].priority;n++);Rt.splice(n,0,e),n===0&&Gc(e)}};function _i(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function sl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ua(){}function lm(e,t,n,s,l){if(l){if(typeof s=="function"){var o=s;s=function(){var d=Hs(i);o.call(d)}}var i=fu(t,s,e,0,null,!1,!1,"",Ua);return e._reactRootContainer=i,e[wt]=i.current,kn(e.nodeType===8?e.parentNode:e),cr(),i}for(;l=e.lastChild;)e.removeChild(l);if(typeof s=="function"){var a=s;s=function(){var d=Hs(c);a.call(d)}}var c=Ei(e,0,!1,null,null,!1,!1,"",Ua);return e._reactRootContainer=c,e[wt]=c.current,kn(e.nodeType===8?e.parentNode:e),cr(function(){rl(t,c,n,s)}),c}function ll(e,t,n,s,l){var o=n._reactRootContainer;if(o){var i=o;if(typeof l=="function"){var a=l;l=function(){var c=Hs(i);a.call(c)}}rl(t,i,e,l)}else i=lm(n,t,e,l,s);return Hs(i)}Wc=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=sn(t.pendingLanes);n!==0&&(Jo(t,n|1),Be(t,xe()),!(ne&6)&&(zr=xe()+500,Gt()))}break;case 13:cr(function(){var s=jt(e,1);if(s!==null){var l=Te();lt(s,e,1,l)}}),Ii(e,1)}};Yo=function(e){if(e.tag===13){var t=jt(e,134217728);if(t!==null){var n=Te();lt(t,e,134217728,n)}Ii(e,134217728)}};Hc=function(e){if(e.tag===13){var t=Vt(e),n=jt(e,t);if(n!==null){var s=Te();lt(n,e,t,s)}Ii(e,t)}};$c=function(){return se};Uc=function(e,t){var n=se;try{return se=e,t()}finally{se=n}};Zl=function(e,t,n){switch(t){case"input":if(Gl(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var l=qs(s);if(!l)throw Error(T(90));jc(s),Gl(s,l)}}}break;case"textarea":kc(e,n);break;case"select":t=n.value,t!=null&&Cr(e,!!n.multiple,t,!1)}};_c=ki;Tc=cr;var om={usingClientEntryPoint:!1,Events:[Dn,vr,qs,Ic,Rc,ki]},Zr={findFiberByHostInstance:Zt,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},im={bundleType:Zr.bundleType,version:Zr.version,rendererPackageName:Zr.rendererPackageName,rendererConfig:Zr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:kt.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Mc(e),e===null?null:e.stateNode},findFiberByHostInstance:Zr.findFiberByHostInstance||sm,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ls=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ls.isDisabled&&ls.supportsFiber)try{Us=ls.inject(im),ft=ls}catch{}}Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=om;Ue.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_i(t))throw Error(T(200));return nm(e,t,null,n)};Ue.createRoot=function(e,t){if(!_i(e))throw Error(T(299));var n=!1,s="",l=mu;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),t=Ei(e,1,!1,null,null,n,!1,s,l),e[wt]=t.current,kn(e.nodeType===8?e.parentNode:e),new Ri(t)};Ue.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(T(188)):(e=Object.keys(e).join(","),Error(T(268,e)));return e=Mc(t),e=e===null?null:e.stateNode,e};Ue.flushSync=function(e){return cr(e)};Ue.hydrate=function(e,t,n){if(!sl(t))throw Error(T(200));return ll(null,e,t,!0,n)};Ue.hydrateRoot=function(e,t,n){if(!_i(e))throw Error(T(405));var s=n!=null&&n.hydratedSources||null,l=!1,o="",i=mu;if(n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),t=fu(t,null,e,1,n??null,l,!1,o,i),e[wt]=t.current,kn(e),s)for(e=0;e<s.length;e++)n=s[e],l=n._getVersion,l=l(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,l]:t.mutableSourceEagerHydrationData.push(n,l);return new nl(t)};Ue.render=function(e,t,n){if(!sl(t))throw Error(T(200));return ll(null,e,t,!1,n)};Ue.unmountComponentAtNode=function(e){if(!sl(e))throw Error(T(40));return e._reactRootContainer?(cr(function(){ll(null,null,e,!1,function(){e._reactRootContainer=null,e[wt]=null})}),!0):!1};Ue.unstable_batchedUpdates=ki;Ue.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!sl(n))throw Error(T(200));if(e==null||e._reactInternals===void 0)throw Error(T(38));return ll(e,t,n,!1,s)};Ue.version="18.3.1-next-f1338f8080-20240426";function pu(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(pu)}catch(e){console.error(e)}}pu(),pc.exports=Ue;var am=pc.exports,hu,Ga=am;hu=Ga.createRoot,Ga.hydrateRoot;var fe=(e=>(e.GOOD="Good",e.BAD="Bad",e.ATTENTION="Needs Attention",e.NIL="Nil",e))(fe||{});const Ka={truckNo:"",trailerNo:"",inspectedBy:"",driverName:"",location:"",odometer:"",jobCard:"",timestamp:"",rate:0,remarks:"",inspectorSignature:"",driverSignature:"",photoFront:"",photoLS:"",photoRS:"",photoBack:"",photoDamage:""},en=[{id:"details",title:"Details",label:"Details"},{id:"photos",title:"Photos",label:"Photos"},{id:"checklist_1",title:"Checklist 1",label:"Part 1"},{id:"checklist_2",title:"Checklist 2",label:"Part 2"},{id:"checklist_3",title:"Checklist 3",label:"Part 3"},{id:"signatures",title:"Signatures",label:"Signatures"},{id:"summary",title:"Summary",label:"Summary"}],J={PPE:"PPE & Safety Gear",DOCUMENTATION:"Documentation & Legal",VEHICLE_EXTERIOR:"Vehicle Exterior & Cab",LIGHTS_ELECTRICAL:"Lights & Electrical",MECHANICAL:"Mechanical & Safety Equipment",TRAILER:"Trailer Specifics"},ol=[{id:"reflectiveWorkSuit",label:"Reflective Work Suit",category:J.PPE},{id:"safetyGear",label:"Safety Goggles, Boots, Gloves, Hard Hat",category:J.PPE},{id:"dustMask",label:"Dust Mask (Task Application)",category:J.PPE},{id:"roadFitness",label:"Valid Road Fitness / Road Tax / Insurance",category:J.DOCUMENTATION},{id:"validDriverDocs",label:"Valid Drivers License, DDT Certificate, Driver ID",category:J.DOCUMENTATION},{id:"driverManual",label:"Driver Manual",category:J.DOCUMENTATION},{id:"routeRisk",label:"Route Risk Assessment",category:J.DOCUMENTATION},{id:"windscreen",label:"Windscreen Condition",category:J.VEHICLE_EXTERIOR},{id:"mirrors",label:"Mirrors Condition",category:J.VEHICLE_EXTERIOR},{id:"chevrons",label:"Chevrons, Plate/Reflective Tape",category:J.VEHICLE_EXTERIOR},{id:"generalCondition",label:"General Condition (Interior Cab, Body: Signs of Tear & Wear, Dents)",category:J.VEHICLE_EXTERIOR},{id:"seatBelt",label:"Three-Point Retractable Seat Belt",category:J.VEHICLE_EXTERIOR},{id:"headLamps",label:"Head Lamps Condition",category:J.LIGHTS_ELECTRICAL},{id:"indicators",label:"Indicators Condition",category:J.LIGHTS_ELECTRICAL},{id:"parkingLights",label:"Parking Lights Condition",category:J.LIGHTS_ELECTRICAL},{id:"reverseAlarm",label:"Reverse Alarm, Reverse Lights Condition",category:J.LIGHTS_ELECTRICAL},{id:"hornIgnition",label:"Horn, Ignition & Electrical (Doors/Windows)",category:J.LIGHTS_ELECTRICAL},{id:"brakes",label:"Brakes, Brake Lights, Trailer Lights, Brake Air Pipes",category:J.MECHANICAL},{id:"tyres",label:"Tyres Condition (Not Worn Out, Pressure, Spare)",category:J.MECHANICAL},{id:"wheelNuts",label:"Wheel Nuts, Wheel Pointers",category:J.MECHANICAL},{id:"fluidLeaks",label:"No Leaks of Lubricants/Fluids (Oil, Coolant, etc.)",category:J.MECHANICAL},{id:"fireExtinguisher",label:"Recommended Fire Extinguisher (9Kg & 2.5Kg)",category:J.MECHANICAL},{id:"warningTriangles",label:"Warning Triangles, Two Approved Wheel Chocks",category:J.MECHANICAL},{id:"firstAid",label:"First Aid Kit",category:J.MECHANICAL},{id:"trailerCondition",label:"Trailer Condition",category:J.TRAILER},{id:"fifthWheel",label:"Fifth Wheel Condition",category:J.TRAILER},{id:"landingLegs",label:"Position and Condition of Landing Legs",category:J.TRAILER},{id:"tarpaulins",label:"Tarpaulins, Ropes, Belts or Straps",category:J.TRAILER}],z={TRUCK_EQUIPMENT:"Truck/Tractor and Equipment",TYRES:"Tyres and Horses",PPE_ID:"Drivers Protective Gear & ID",DOCUMENTS:"Documents",ONBOARD:"On Board Equipment"},il=[{id:"petro_1",label:"1. OBC functionality: live",category:z.TRUCK_EQUIPMENT},{id:"petro_2",label:"2. Large exterior mirror for all around vision (incl. parabolic on passenger side)",category:z.TRUCK_EQUIPMENT},{id:"petro_3",label:"3. Single pane laminated windshields (no cracks)",category:z.TRUCK_EQUIPMENT},{id:"petro_4",label:"4. Ergonomically designed seats and head restraints",category:z.TRUCK_EQUIPMENT},{id:"petro_5",label:"5. 3 point seat belts on both seats",category:z.TRUCK_EQUIPMENT},{id:"petro_6",label:"6. Brake Testing required",category:z.TRUCK_EQUIPMENT},{id:"petro_7",label:"7. Functioning, master battery switch & engine cut  off switch on side of cab",category:z.TRUCK_EQUIPMENT},{id:"petro_8",label:"8. Stop Tail, Backing and Turn lights",category:z.TRUCK_EQUIPMENT},{id:"petro_9",label:"9. Cab mounted grab handle for ease of entry exit",category:z.TRUCK_EQUIPMENT},{id:"petro_10",label:"10. Jack, Mats, Wheel Spanner",category:z.TRUCK_EQUIPMENT},{id:"petro_11",label:"11. Cabin Jack",category:z.TRUCK_EQUIPMENT},{id:"petro_12",label:"12. P. window switches",category:z.TRUCK_EQUIPMENT},{id:"petro_13",label:"13. Condition of the fifth wheel (Lock/Lubricants)",category:z.TRUCK_EQUIPMENT},{id:"petro_14",label:"14. Each component outlets (faucet) numbered and marked with fill capacity",category:z.TRUCK_EQUIPMENT},{id:"petro_15",label:"15. 2 bronze grounding bolts compatible with loading rack (permissive) system",category:z.TRUCK_EQUIPMENT},{id:"petro_16",label:"16. Anti  slip walkway along the whole length of the tank",category:z.TRUCK_EQUIPMENT},{id:"petro_17",label:"17. Tank hatch and roll  over protection (coatings)",category:z.TRUCK_EQUIPMENT},{id:"petro_18",label:"18. Double latching lockable man lids, installed with hinges facing forward",category:z.TRUCK_EQUIPMENT},{id:"petro_19",label:"19. Trailer fitted with fall protection harness of handrails",category:z.TRUCK_EQUIPMENT},{id:"petro_20",label:"20. Ullage marks in correct places & sealed, also Doom Cover",category:z.TRUCK_EQUIPMENT},{id:"petro_21",label:"21. Presence of emergency/foot valves",category:z.TRUCK_EQUIPMENT},{id:"petro_22",label:"22. Emergence valves for all components",category:z.TRUCK_EQUIPMENT},{id:"petro_23",label:"23. Condition of landing legs",category:z.TRUCK_EQUIPMENT},{id:"petro_24",label:"24. Minimum tread depth set at the center for all wheel (incl. Spare tyre)",category:z.TYRES},{id:"petro_25",label:"25. Wheel nut indicators",category:z.TYRES},{id:"petro_26",label:"26. Mudguards for all wheels",category:z.TYRES},{id:"petro_27",label:"27. Choke blocks",category:z.TYRES},{id:"petro_28",label:"28. Hoses damaged/fittings? Continuity Test done?",category:z.TYRES},{id:"petro_29",label:"29. Delivery hose(s) for gravity drops",category:z.TYRES},{id:"petro_30",label:"30. Truck/trailer loaded within legal limits (axle weight)?",category:z.TYRES},{id:"petro_31",label:"31. Signs of lubrication loss on wheel",category:z.TYRES},{id:"petro_32",label:"32. Anti-static clothes/Work suite?",category:z.PPE_ID},{id:"petro_33",label:"33. Gloves for hydrocarbon handing Present?",category:z.PPE_ID},{id:"petro_34",label:"34. Safety shoes - hydrocarbon proof Present?",category:z.PPE_ID},{id:"petro_35",label:"35. Hard hat Present?",category:z.PPE_ID},{id:"petro_36",label:"36. Drivers ID Present?",category:z.PPE_ID},{id:"petro_37",label:"37. Road worthiness approval by authorities",category:z.DOCUMENTS},{id:"petro_38",label:"38. Valid drivers DDT certificate",category:z.DOCUMENTS},{id:"petro_39",label:"39. Valid drivers License",category:z.DOCUMENTS},{id:"petro_40",label:"40. Electric certificate",category:z.DOCUMENTS},{id:"petro_41",label:"41. Drivers Manual",category:z.DOCUMENTS},{id:"petro_42",label:"42. Route Risk Assessment",category:z.DOCUMENTS},{id:"petro_43",label:"43. ZCSA certificate",category:z.DOCUMENTS},{id:"petro_44",label:"44. Assize Certificate",category:z.DOCUMENTS},{id:"petro_45",label:"45. TREM Card",category:z.DOCUMENTS},{id:"petro_46",label:"46. Fire extinguisher (2kg dry chemical) fixed & valid X 1",category:z.ONBOARD},{id:"petro_47",label:"47. Fire extinguisher (9kg dry chemical) within inspection X 2",category:z.ONBOARD},{id:"petro_48",label:"48. Barricading tape",category:z.ONBOARD},{id:"petro_49",label:"49. Charge Line",category:z.ONBOARD},{id:"petro_50",label:"50. Torch",category:z.ONBOARD},{id:"petro_51",label:"51. Spill Kit",category:z.ONBOARD},{id:"petro_52",label:"52. First aid kit 4 warning triangles and 3 cones",category:z.ONBOARD},{id:"petro_53",label:"53. On Board camera",category:z.ONBOARD},{id:"petro_54",label:"54. Safe Loading Pass/ Safe to operate/ Tech inspection",category:z.ONBOARD}],q={PPE:"A. Personal Protective Equipment",VEHICLE:"B. Vehicle (Horse & Trailer)",SPILL_KIT:"C. Spill Kit",DOCUMENTATION:"D. Documentation"},rr=[{id:"acid_1",label:"1. Reflective Work Suit (Acid Proof), Gumboots Safety Goggles",category:q.PPE},{id:"acid_2",label:"2. Hard Hat, PVC Gloves, Respirator (Double side), Face shield",category:q.PPE},{id:"acid_3",label:"3. Valid road fitness/road tax/Insurance/permit",category:q.VEHICLE},{id:"acid_4",label:"4. Wind screen condition",category:q.VEHICLE},{id:"acid_5",label:"5. Mirrors in good condition",category:q.VEHICLE},{id:"acid_6",label:"6. Three-point retractable seat belt",category:q.VEHICLE},{id:"acid_7",label:"7. Horn working, ignition switch, electrical (doors/windows)",category:q.VEHICLE},{id:"acid_8",label:"8. Valid Fire extinguisher (9kg=2, 2kg=1)",category:q.VEHICLE},{id:"acid_9",label:"9. Warning triangles, Cones, two approved wheel chokes",category:q.VEHICLE},{id:"acid_10",label:"10. Headlamps working",category:q.VEHICLE},{id:"acid_11",label:"11. Amber beacon",category:q.VEHICLE},{id:"acid_12",label:"12. Brake lights, trailer lights, indicators working",category:q.VEHICLE},{id:"acid_13",label:"13. Brakes, air pipes, air bags OK",category:q.VEHICLE},{id:"acid_14",label:"14. Tyres not worn  out, visual Tyre Pressure, Spare wheel",category:q.VEHICLE},{id:"acid_15",label:"15. Wheel nuts, wheel pointers, bolts, Flanges OK",category:q.VEHICLE},{id:"acid_16",label:"16. Revers alarm, reverse lights working",category:q.VEHICLE},{id:"acid_17",label:"17. Chevrons plate/reflective tape",category:q.VEHICLE},{id:"acid_18",label:"18. Hazchem diamond symbols correct & display on both 2 sides",category:q.VEHICLE},{id:"acid_19",label:"19. Anti-slip protection, Ladder, Hand rails",category:q.VEHICLE},{id:"acid_20",label:"20. Over spill hose connected to containment container",category:q.VEHICLE},{id:"acid_21",label:"21. Hatch, Valves, Vents",category:q.VEHICLE},{id:"acid_22",label:"22. No leaks of chemicals/lubricants (oil, coolants, acid etc.)",category:q.VEHICLE},{id:"acid_23",label:"23. General condition (interior cab, body: signs of Corrosion, Cracks, leaks)",category:q.VEHICLE},{id:"acid_25",label:"25. Lime box filled with lime",category:q.SPILL_KIT},{id:"acid_26",label:"26. First Aid Kit, Diphotrine",category:q.SPILL_KIT},{id:"acid_27",label:"27. Pick and Shovel",category:q.SPILL_KIT},{id:"acid_28",label:"28. Barricading tape",category:q.SPILL_KIT},{id:"acid_29",label:"29. Water (20 liters container)",category:q.SPILL_KIT},{id:"acid_30",label:"30. Pressure/Thickness Test Certificate",category:q.DOCUMENTATION},{id:"acid_31",label:"31. Electric System Certificate",category:q.DOCUMENTATION},{id:"acid_32",label:"32. Tank Cleanliness Certificate",category:q.DOCUMENTATION},{id:"acid_33",label:"33. Driver Manual, Route Risk Assessment/Journey plan",category:q.DOCUMENTATION},{id:"acid_34",label:"34. Valid Driver licence, DDT certificate, ID",category:q.DOCUMENTATION}],V={PRIME_MOVER:"Prime Mover",TRAILER_TANKS:"Trailer/Tanks",DRIVER:"Driver",SAFETY_SIGNS:"Safety & Warning Signs",DOCUMENTS:"Licence & Mandatory Documents"},al=[{id:"petro2_1",label:"1. General: Appearance, Paint, Leaks, Charge line",category:V.PRIME_MOVER},{id:"petro2_2",label:"2. Visibility: Windscreen, Windows, Wipers, Mirrors",category:V.PRIME_MOVER},{id:"petro2_3",label:"3. Lighting: Headlights, Beacon, Turning, Stop, Reverse Lights",category:V.PRIME_MOVER},{id:"petro2_4",label:"4. Provision for Orange Diamond",category:V.PRIME_MOVER},{id:"petro2_5",label:"5. Seat Belt: 3-point Contact, Retractable",category:V.PRIME_MOVER},{id:"petro2_6",label:"6. IVMS /Speed limiting device: installed, working",category:V.PRIME_MOVER},{id:"petro2_7",label:"7. Document Holder/Box : Position, Colour, Labeled",category:V.PRIME_MOVER},{id:"petro2_8",label:"8. Tools: Jack, Wheel Spanner, Cabin, Triangles (4), Cones (3)",category:V.PRIME_MOVER},{id:"petro2_9",label:"9. Equipment: Spill Kit, First Aid Kit, Barricading Tape, Fire Extinguisher (Cabin, Trailer x2)",category:V.PRIME_MOVER},{id:"petro2_10",label:"10. Electrical: Battery Master Switch, Battery Box, Terminals, Wiring",category:V.PRIME_MOVER},{id:"petro2_11",label:"11. Tyres: No Retread, Combination, Spray Suppression, Wheels",category:V.PRIME_MOVER},{id:"petro2_12",label:"12. Brake System: ABS, Wheel Pointers, Brake Testing Required?",category:V.PRIME_MOVER},{id:"petro2_13",label:"13. Shielding of Engine, Rear Window Non-opening",category:V.PRIME_MOVER},{id:"petro2_14",label:"14. Exhaust: Discharge on Right Side, Tank outlet 100mm Clearance",category:V.PRIME_MOVER},{id:"petro2_15",label:"15. Condition of the Fifth Wheel (Lock/Lubrication)",category:V.PRIME_MOVER},{id:"petro2_16",label:"16. Compartment Capacities: labeled, < 7000L per compartment",category:V.TRAILER_TANKS},{id:"petro2_17",label:"17. Under Run Protection: Sides, Rear End",category:V.TRAILER_TANKS},{id:"petro2_18",label:"18. Overturn Damage Protection",category:V.TRAILER_TANKS},{id:"petro2_19",label:"19. Valves: Discharge, Actuator, Dust Cups, Colour Coding",category:V.TRAILER_TANKS},{id:"petro2_20",label:"20. Emergency Shut Off: Main, Side(s)/ Brake Interlock System",category:V.TRAILER_TANKS},{id:"petro2_21",label:"21. Electrical Bonding: Cable, Bronze Earthing Studs",category:V.TRAILER_TANKS},{id:"petro2_22",label:"22. Spill Tray, Hose Storage Rack, Fire Extinguisher Holders",category:V.TRAILER_TANKS},{id:"petro2_23",label:"23. Tyres: Tread Depth, Spare Tyre, Non-retread, Combination",category:V.TRAILER_TANKS},{id:"petro2_24",label:"24. Mudguards for all Wheels, Spray Suppressors",category:V.TRAILER_TANKS},{id:"petro2_25",label:"25. Landing Legs",category:V.TRAILER_TANKS},{id:"petro2_26",label:"26. Reversing Alarm",category:V.TRAILER_TANKS},{id:"petro2_27",label:"27. Delivery Hose(s): State, Continuity, Colour Coded, Dust Cups",category:V.TRAILER_TANKS},{id:"petro2_28",label:"28. Lighting: Brakes, Reverse, Warning, Emergency Lighting",category:V.TRAILER_TANKS},{id:"petro2_29",label:"29. Rear Bumper: > 300mm Beyond Tank",category:V.TRAILER_TANKS},{id:"petro2_30",label:"30. Fall Protection: Access Ladder, Anti-slip Walkway, Handrail",category:V.TRAILER_TANKS},{id:"petro2_31",label:"31. Manholes: Dia, Center, Secured, Standard (EN 13317)",category:V.TRAILER_TANKS},{id:"petro2_32",label:"32. Fittings: Ullage Marks, Overfill Protection, Pressure Release",category:V.TRAILER_TANKS},{id:"petro2_33",label:"33. Work Suit: Anti-static, Reflective",category:V.DRIVER},{id:"petro2_34",label:"34. Safety Gloves: For Hydrocarbon Handing",category:V.DRIVER},{id:"petro2_35",label:"35. Safety Boot: With Toe Cap, Oil Resistant",category:V.DRIVER},{id:"petro2_36",label:"36. Safety Helmet: 2- 4-Point Chin Strap",category:V.DRIVER},{id:"petro2_37",label:"37. Drivers ID: Identity Card, Driver Blue Tag",category:V.DRIVER},{id:"petro2_38",label:"38. Hazchem: Both Sides, Rear",category:V.SAFETY_SIGNS},{id:"petro2_39",label:"39. No Smocking, Naked Flame, Cell Phone",category:V.SAFETY_SIGNS},{id:"petro2_40",label:"40. Orange Reflectors: Continuous",category:V.SAFETY_SIGNS},{id:"petro2_41",label:"41. Chevron, Red Reflectors at Rear",category:V.SAFETY_SIGNS},{id:"petro2_42",label:"42. Number Plate: ZABS Approved, Lighting",category:V.SAFETY_SIGNS},{id:"petro2_43",label:"43. Speed Limit Sign: 80 km/h",category:V.SAFETY_SIGNS},{id:"petro2_44",label:"44. Data Plate: Pressure Test",category:V.SAFETY_SIGNS},{id:"petro2_45",label:"45. Road Tax, Certificate of Fitness, Insurance, Identity",category:V.DOCUMENTS},{id:"petro2_46",label:"46. Defensive Driver Training (DDT): Dangerous Goods Certificate",category:V.DOCUMENTS},{id:"petro2_47",label:"47. Drivers License: Validity of Dangerous Goods, CE",category:V.DOCUMENTS},{id:"petro2_48",label:"48. Electric Certificate",category:V.DOCUMENTS},{id:"petro2_49",label:"49. Drivers Manual",category:V.DOCUMENTS},{id:"petro2_50",label:"50. Route Risk Assessment Guide",category:V.DOCUMENTS},{id:"petro2_51",label:"51. ZCSA Certificate",category:V.DOCUMENTS},{id:"petro2_52",label:"52. Assize Certificate",category:V.DOCUMENTS},{id:"petro2_53",label:"53. TREM Card",category:V.DOCUMENTS}],cl=["id","timestamp","truckNo","trailerNo","inspectedBy","driverName","location","odometer","rate","remarks","inspectorSignature","driverSignature","photoFront","photoLS","photoRS","photoBack","photoDamage","jobCard"],xu=[...cl,...ol.map(e=>e.id)],gu=[...cl,...il.map(e=>e.id)],yu=[...cl,...al.map(e=>e.id)],vu=[...cl,...rr.map(e=>e.id)],cm=`
// =========================================================
// 1. CONTROLLER (Main Entry & Routing)
// =========================================================

function doPost(e) {
  const lock = LockService.getScriptLock();
  lock.tryLock(30000); 
  
  try {
    const ss = SpreadsheetApp.getActiveSpreadsheet();
    const body = e.postData ? JSON.parse(e.postData.contents) : {};
    return routeRequest(ss, body);
  } catch (err) {
    return ResponseBuilder.error(err.toString());
  } finally {
    lock.releaseLock();
  }
}

function doGet(e) {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  return DataHandlers.handleGetRequest(ss);
}

function routeRequest(ss, body) {
  const action = body.action;
  const routes = {
    'login': () => AuthHandlers.handleLogin(ss, body),
    'register_user': () => AuthHandlers.handleRegisterUser(ss, body),
    'get_users': () => AuthHandlers.handleGetUsers(ss),
    'delete_user': () => AuthHandlers.handleDeleteUser(ss, body),
    'update_user': () => AuthHandlers.handleUpdateUser(ss, body),
    'acknowledge_issue': () => SystemHandlers.handleAcknowledgeIssue(ss, body),
    'request_inspection': () => SystemHandlers.handleRequestInspection(ss, body),
    'get_acknowledgements': () => SystemHandlers.handleGetAcknowledgements(ss),
    'mark_notification_read': () => SystemHandlers.handleMarkNotificationRead(ss, body),
    'update_settings': () => SystemHandlers.handleUpdateSettings(ss, body),
    'broadcast': () => SystemHandlers.handleBroadcast(ss, body),
    'check_subscription': () => SubscriptionHandlers.handleCheckSubscription(ss),
    'extend_subscription': () => SubscriptionHandlers.handleExtendSubscription(ss, body),
    'submit_support_ticket': () => SupportHandlers.handleSubmitSupport(ss, body),
    'get_tickets': () => SupportHandlers.handleGetTickets(ss, body),
    'update_ticket': () => SupportHandlers.handleUpdateTicket(ss, body)
  };
  
  if (!action || action === 'create' || !routes[action]) {
    return DataHandlers.handleDataSubmission(ss, body);
  }
  return routes[action]();
}
`,dm=`
// =========================================================
// 2. AUTHENTICATION & USER MANAGEMENT
// =========================================================

const AuthHandlers = {
  handleLogin: function(ss, body) {
    const username = body.username ? String(body.username).trim().toLowerCase() : "";
    const password = body.password ? String(body.password) : "";
    let userSheet = ss.getSheetByName('Users');
    if (!userSheet || userSheet.getLastRow() <= 1) return ResponseBuilder.error("No users found in database.", "NO_USERS");

    const data = userSheet.getDataRange().getValues();
    for (let i = 1; i < data.length; i++) {
        const row = data[i];
        if (String(row[0]).trim().toLowerCase() === username && String(row[1]) === password) {
             let prefs = {};
             try { if (row[6]) prefs = JSON.parse(row[6]); } catch(e) {}
             const user = { username: row[0], name: row[2], role: String(row[3]).trim(), position: row[4] || '', preferences: prefs };
             userSheet.getRange(i + 1, 6).setValue(new Date().toISOString());
             return ResponseBuilder.success({ user: user });
        }
    }
    return ResponseBuilder.error("Invalid username or password.", "INVALID_CREDENTIALS");
  },

  handleRegisterUser: function(ss, body) {
    let userSheet = ss.getSheetByName('Users');
    if (!userSheet) {
        userSheet = ss.insertSheet('Users');
        userSheet.appendRow(["Username", "Password", "Name", "Role", "Position", "Last_Login", "Preferences"]);
        userSheet.setFrozenRows(1);
        userSheet.getRange(1, 1, 1, 7).setFontWeight("bold");
    }
    const username = body.username ? String(body.username).trim().toLowerCase() : "";
    const data = userSheet.getDataRange().getValues();
    for(let i=1; i<data.length; i++) {
        if(String(data[i][0]).trim().toLowerCase() === username) return ResponseBuilder.error("Username already exists.");
    }
    const defaultPrefs = JSON.stringify({ emailNotifications: true, notifyGeneral: true, notifyPetroleum: true, notifyPetroleumV2: true, notifyAcid: true });
    userSheet.appendRow([username, body.password, body.name, String(body.role).trim(), body.position || "", new Date().toISOString(), defaultPrefs]);
    
    if (body.name) Validation.updateSingle(ss, 'Inspector_Name', body.name);
    if (body.position) Validation.updateSingle(ss, 'Position', body.position);
    return ResponseBuilder.success({ message: "User created." });
  },

  handleGetUsers: function(ss) {
    let userSheet = ss.getSheetByName('Users');
    if (!userSheet) return ResponseBuilder.success({ users: [] });
    const data = userSheet.getDataRange().getValues();
    const users = [];
    for (let i = 1; i < data.length; i++) {
        const row = data[i];
        if (row[0]) {
            let prefs = {};
            try { if(row[6]) prefs = JSON.parse(row[6]); } catch(e){}
            users.push({ username: row[0], password: row[1], name: row[2], role: String(row[3]).trim(), position: row[4], lastLogin: row[5], preferences: prefs });
        }
    }
    return ResponseBuilder.success({ users: users });
  },

  handleDeleteUser: function(ss, body) {
    let userSheet = ss.getSheetByName('Users');
    if (!userSheet) return ResponseBuilder.error("Database not found.");
    const username = body.username ? String(body.username).trim().toLowerCase() : "";
    const data = userSheet.getDataRange().getValues();
    for (let i = 1; i < data.length; i++) {
        if (String(data[i][0]).trim().toLowerCase() === username) {
            userSheet.deleteRow(i + 1);
            return ResponseBuilder.success({ message: "User deleted." });
        }
    }
    return ResponseBuilder.error("User not found.");
  },

  handleUpdateUser: function(ss, body) {
    let userSheet = ss.getSheetByName('Users');
    if (!userSheet) return ResponseBuilder.error("Database not found.");
    const currentUsername = body.originalUsername ? String(body.originalUsername).trim().toLowerCase() : String(body.username).trim().toLowerCase();
    const data = userSheet.getDataRange().getValues();
    for (let i = 1; i < data.length; i++) {
        if (String(data[i][0]).trim().toLowerCase() === currentUsername) {
            if (body.username) userSheet.getRange(i + 1, 1).setValue(String(body.username).trim().toLowerCase());
            if (body.name) userSheet.getRange(i + 1, 3).setValue(body.name);
            if (body.role) userSheet.getRange(i + 1, 4).setValue(String(body.role).trim());
            if (body.position !== undefined) userSheet.getRange(i + 1, 5).setValue(body.position);
            if (body.preferences) userSheet.getRange(i + 1, 7).setValue(JSON.stringify(body.preferences));
            if (body.password) userSheet.getRange(i + 1, 2).setValue(body.password);
            
            if (body.name) Validation.updateSingle(ss, 'Inspector_Name', body.name);
            if (body.position) Validation.updateSingle(ss, 'Position', body.position);
            return ResponseBuilder.success({ message: "User updated." });
        }
    }
    return ResponseBuilder.error("User not found.");
  }
};
`,um=`
// =========================================================
// 3. CORE OPERATIONS (Data, Systems, Subscription)
// =========================================================

const DataHandlers = {
  handleDataSubmission: function(ss, body) {
    const sheetName = body.sheet;
    const headers = body.headers;
    const rowData = body.row;
    let sheet = ss.getSheetByName(sheetName);
    if (!sheet) {
      sheet = ss.insertSheet(sheetName);
      if (headers && Array.isArray(headers)) {
        sheet.appendRow(headers);
        sheet.getRange(1, 1, 1, headers.length).setFontWeight("bold");
        sheet.setFrozenRows(1);
      }
    }
    const safeRow = rowData.map(r => (r === null || r === undefined) ? "" : String(r));
    sheet.appendRow(safeRow);

    // --- REQUEST FULFILLMENT LOGIC ---
    if (body.requestId) {
        try {
            let reqSheet = ss.getSheetByName('Inspection_Requests');
            if (reqSheet) {
                const rData = reqSheet.getDataRange().getValues();
                const idColIndex = 0; // Request_ID is first
                const statusColIndex = 10; // Status is 10th (column K, index 10 in getRange)
                // Iterate to find ID
                for(let i=1; i<rData.length; i++) {
                    if(String(rData[i][idColIndex]) === String(body.requestId)) {
                        // Mark as Completed
                        reqSheet.getRange(i+1, statusColIndex).setValue('Completed');
                        break; 
                    }
                }
            }
        } catch(e) { Logger.log(ss, "REQ_UPDATE_ERROR", e.toString()); }
    }

    const skipValidation = ['System_Settings', 'Validation_Data', 'Users', 'Acknowledgements', 'SystemNotification', 'Subscription_Data', 'Support_Tickets', 'Inspection_Requests'];
    if (!skipValidation.includes(sheetName)) {
       Validation.updateFromRow(ss, body);
       try { 
          EmailHandlers.sendEmailNotifications(ss, body, sheetName); 
       } catch (e) { 
          Logger.log(ss, "EMAIL_FAILURE", "CRITICAL: " + e.toString()); 
       }
    }
    return ResponseBuilder.success({ sheet: sheetName });
  },

  handleGetRequest: function(ss) {
    const sheets = ss.getSheets();
    const data = {};
    sheets.forEach(sheet => {
      const name = sheet.getName();
      if (name === 'Users') return;
      const lastRow = sheet.getLastRow();
      
      if (name === 'Validation_Data') {
         if (lastRow > 1) {
            const range = sheet.getRange(2, 1, lastRow - 1, sheet.getLastColumn());
            const values = range.getValues();
            const columns = {};
            const headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
            headers.forEach((h, colIndex) => {
               columns[h] = [...new Set(values.map(row => row[colIndex]).filter(c => c !== ""))]; 
            });
            data[name] = columns;
         } else { data[name] = {}; }
      } else if (name === 'Acknowledgements') {
          data[name] = lastRow > 1 ? sheet.getRange(2, 1, lastRow - 1, 1).getValues().flat() : [];
      } else if (name === 'System_Settings') {
          data[name] = lastRow > 0 ? sheet.getRange(1, 1, lastRow, sheet.getLastColumn()).getValues() : [];
      } else if (name === 'Subscription_Data') {
          if (lastRow > 1) {
               const values = sheet.getRange(lastRow, 1, 1, 4).getValues()[0];
               data[name] = { status: values[0], plan: values[1], expiryDate: values[2] };
          } else { data[name] = null; }
      } else {
         if (lastRow > 0) {
            const startRow = Math.max(1, lastRow - 200);
            const values = sheet.getRange(startRow, 1, lastRow - startRow + 1, sheet.getLastColumn()).getValues();
            if (startRow > 1) values.unshift(sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0]);
            data[name] = values;
         } else { data[name] = []; }
      }
    });
    return ContentService.createTextOutput(JSON.stringify(data)).setMimeType(ContentService.MimeType.JSON);
  }
};

const SystemHandlers = {
  handleBroadcast: function(ss, body) {
    let notifSheet = ss.getSheetByName('SystemNotification');
    if (!notifSheet) {
        notifSheet = ss.insertSheet('SystemNotification');
        notifSheet.appendRow(["Notification_ID", "Recipient", "Type", "Message", "Timestamp", "IsRead", "ActionLink"]);
        notifSheet.setFrozenRows(1);
    }
    const notifId = "SYS-BCAST-" + Date.now();
    notifSheet.appendRow([
        notifId, 
        "All", 
        body.type || "info", 
        body.message, 
        new Date().toISOString(), 
        "FALSE", 
        body.actionLink || ""
    ]);
    return ResponseBuilder.success({ message: "Broadcast sent", id: notifId });
  },

  handleRequestInspection: function(ss, body) {
    let reqSheet = ss.getSheetByName('Inspection_Requests');
    if (!reqSheet) {
        reqSheet = ss.insertSheet('Inspection_Requests');
        reqSheet.appendRow(['Request_ID', 'Requester', 'Role', 'Truck_No', 'Trailer_No', 'Type', 'Reason', 'Priority', 'Assigned_Inspector', 'Status', 'Timestamp']);
        reqSheet.setFrozenRows(1);
    }
    const reqId = "REQ-" + Date.now();
    reqSheet.appendRow([
        reqId, 
        body.requester, 
        body.role, 
        body.truckNo, 
        body.trailerNo, 
        body.type, 
        body.reason, 
        body.priority,
        body.assignedInspector || 'Unassigned', 
        'Pending', 
        new Date().toISOString()
    ]);

    let notifSheet = ss.getSheetByName('SystemNotification');
    if (!notifSheet) {
        notifSheet = ss.insertSheet('SystemNotification');
        notifSheet.appendRow(["Notification_ID", "Recipient", "Type", "Message", "Timestamp", "IsRead", "ActionLink"]);
    }
    
    // Updated Link to include Request ID at the end
    const actionLink = "request:start_inspection|" + body.type + "|" + body.truckNo + "|" + body.trailerNo + "|" + body.requester + "|" + body.reason + "|" + reqId;
    
    notifSheet.appendRow([
        "NOTIF-" + reqId, 
        "Inspector", 
        "warning", 
        "New Inspection Request: " + body.truckNo + " (" + body.priority + ")", 
        new Date().toISOString(), 
        "FALSE", 
        actionLink
    ]);

    return ResponseBuilder.success({ message: "Request Submitted" });
  },

  handleAcknowledgeIssue: function(ss, body) {
    let ackSheet = ss.getSheetByName('Acknowledgements');
    if (!ackSheet) {
        ackSheet = ss.insertSheet('Acknowledgements');
        ackSheet.appendRow(['Issue_ID', 'Acknowledged_By', 'Role', 'Timestamp']);
        ackSheet.setFrozenRows(1);
    }
    const issueId = String(body.issueId);
    const data = ackSheet.getDataRange().getValues();
    if (!data.some(row => String(row[0]) === issueId)) {
         ackSheet.appendRow([issueId, body.user || 'Unknown', body.role || 'Unknown', new Date().toISOString()]);
    }
    return ResponseBuilder.success({ message: "Issue acknowledged." });
  },

  handleGetAcknowledgements: function(ss) {
    let ackSheet = ss.getSheetByName('Acknowledgements');
    if (!ackSheet) return ResponseBuilder.success({ ids: [] });
    const data = ackSheet.getDataRange().getValues();
    const ids = [];
    for (let i = 1; i < data.length; i++) if (data[i][0]) ids.push(String(data[i][0]));
    return ResponseBuilder.success({ ids: ids });
  },

  handleMarkNotificationRead: function(ss, body) {
    const sheet = ss.getSheetByName('SystemNotification');
    if (!sheet) return ResponseBuilder.error("Notification sheet not found");
    const idToMark = String(body.id);
    const data = sheet.getDataRange().getValues();
    for (let i = 1; i < data.length; i++) {
        if (String(data[i][0]) === idToMark) {
            sheet.getRange(i + 1, 6).setValue("TRUE");
            return ResponseBuilder.success({ message: "Marked as read" });
        }
    }
    return ResponseBuilder.error("ID not found");
  },

  handleUpdateSettings: function(ss, body) {
    let settingsSheet = ss.getSheetByName('System_Settings');
    if (!settingsSheet) {
        settingsSheet = ss.insertSheet('System_Settings');
        settingsSheet.appendRow(["CompanyName", "ManagerEmail", "UpdatedBy", "Timestamp", "LogoBase64", "MobileApkLink", "WebAppUrl", "MaintenanceMode", "MaintenanceMessage"]);
        settingsSheet.setFrozenRows(1);
    }
    settingsSheet.appendRow([
        body.companyName, 
        body.managerEmail, 
        "System", 
        new Date().toISOString(), 
        body.companyLogo || "", 
        body.mobileApkLink || "", 
        body.webAppUrl || "",
        body.maintenanceMode ? "TRUE" : "FALSE",
        body.maintenanceMessage || ""
    ]);
    return ResponseBuilder.success({ message: "Settings updated" });
  }
};

const SubscriptionHandlers = {
  handleCheckSubscription: function(ss) {
    let subSheet = ss.getSheetByName('Subscription_Data');
    if (!subSheet) {
        subSheet = ss.insertSheet('Subscription_Data');
        subSheet.appendRow(["Status", "Plan", "Expiry_Date", "Last_Updated"]);
        subSheet.setFrozenRows(1);
    }
    if (subSheet.getLastRow() < 2) {
        const defaultExpiry = new Date();
        defaultExpiry.setDate(defaultExpiry.getDate() + 30);
        subSheet.appendRow(["Active", "Trial", defaultExpiry.toISOString(), new Date().toISOString()]);
    }
    const lastRow = subSheet.getLastRow();
    const data = subSheet.getRange(lastRow, 1, 1, 4).getValues()[0];
    let status = data[0];
    const expiry = new Date(data[2]);
    const now = new Date();
    if (status === 'Active' && !isNaN(expiry.getTime()) && now > expiry) {
        status = 'Expired';
        subSheet.getRange(lastRow, 1).setValue('Expired');
    }
    return ResponseBuilder.success({ 
        subscription: {
            status: status,
            plan: data[1],
            expiryDate: data[2],
            daysRemaining: Math.ceil((expiry.getTime() - now.getTime()) / (1000 * 60 * 60 * 24))
        }
    });
  },

  handleExtendSubscription: function(ss, body) {
    let subSheet = ss.getSheetByName('Subscription_Data');
    if (!subSheet) {
        subSheet = ss.insertSheet('Subscription_Data');
        subSheet.appendRow(["Status", "Plan", "Expiry_Date", "Last_Updated"]);
    }
    if (subSheet.getLastRow() < 2) {
        const expiredDate = new Date();
        expiredDate.setDate(expiredDate.getDate() - 1); 
        subSheet.appendRow(["Expired", "Trial", expiredDate.toISOString(), new Date().toISOString()]);
    }
    const daysToAdd = parseInt(body.days || 30);
    const lastRow = subSheet.getLastRow();
    const currentData = subSheet.getRange(lastRow, 1, 1, 4).getValues()[0];
    let currentExpiry = new Date(currentData[2]);
    const now = new Date();
    if (!currentData[2] || isNaN(currentExpiry.getTime()) || currentExpiry < now) currentExpiry = now;
    currentExpiry.setDate(currentExpiry.getDate() + daysToAdd);
    
    subSheet.getRange(lastRow, 1).setValue('Active');
    subSheet.getRange(lastRow, 3).setValue(currentExpiry.toISOString());
    subSheet.getRange(lastRow, 4).setValue(new Date().toISOString());
    return ResponseBuilder.success({ message: "Subscription Extended" });
  }
};
`,fm=`
// =========================================================
// 4. SUPPORT TICKET MODULE
// =========================================================

const SupportHandlers = {
  handleSubmitSupport: function(ss, body) {
    let ticketSheet = ss.getSheetByName('Support_Tickets');
    if (!ticketSheet) {
        ticketSheet = ss.insertSheet('Support_Tickets');
        ticketSheet.appendRow(["Ticket_ID", "Type", "Subject", "Description", "Priority", "User", "Email", "Role", "Timestamp", "Status", "Comments", "Assigned_Agent", "Attachment"]);
        ticketSheet.setFrozenRows(1);
    }
    const ticketId = "TKT-" + Math.floor(1000 + Math.random() * 9000);
    ticketSheet.appendRow([
        ticketId, body.type, body.subject, body.description, body.priority,
        body.user, String(body.email).toLowerCase().trim(), body.role,
        new Date().toISOString(), "Open", "[]", "", body.attachment || ""
    ]);
    
    try {
        GmailApp.sendEmail(
            "notifications@sallychanza.com", 
            "New Ticket: " + ticketId + " [" + body.priority + "]", 
            "User: " + body.user + " (" + body.role + ")\\n" +
            "Type: " + body.type + "\\n" +
            "Subject: " + body.subject + "\\n\\n" +
            "Description:\\n" + body.description
        );
    } catch(e) {
        Logger.log(ss, "EMAIL_ERROR", "Support Ticket Email Failed: " + e.toString());
    }

    let notifSheet = ss.getSheetByName('SystemNotification');
    if (!notifSheet) {
        notifSheet = ss.insertSheet('SystemNotification');
        notifSheet.appendRow(["Notification_ID", "Recipient", "Type", "Message", "Timestamp", "IsRead", "ActionLink"]);
    }
    
    notifSheet.appendRow(["NOTIF-" + Date.now() + "-A", "Admin", "info", "New Ticket: " + ticketId + " (" + body.subject + ")", new Date().toISOString(), "FALSE", "view:support"]);
    notifSheet.appendRow(["NOTIF-" + Date.now() + "-U", String(body.email).toLowerCase().trim(), "success", "Ticket Received: " + ticketId, new Date().toISOString(), "FALSE", "view:support"]);

    if (String(body.priority) === 'Critical') {
         const broadcastMsg = "CRITICAL ALERT: " + body.user + " (" + body.role + ") reported a critical system issue. ID: " + ticketId;
         notifSheet.appendRow([
            "NOTIF-" + Date.now() + "-ALL", 
            "All", 
            "critical", 
            broadcastMsg, 
            new Date().toISOString(), 
            "FALSE", 
            "view:support"
        ]);
    }

    return ResponseBuilder.success({ ticketId: ticketId });
  },

  handleGetTickets: function(ss, body) {
    let ticketSheet = ss.getSheetByName('Support_Tickets');
    if (!ticketSheet || ticketSheet.getLastRow() <= 1) return ResponseBuilder.success({ tickets: [] });
    const data = ticketSheet.getDataRange().getValues();
    const tickets = [];
    const userRole = body.role ? String(body.role).toLowerCase() : "";
    const userEmail = body.email ? String(body.email).toLowerCase().trim() : ""; 
    const isAdmin = userRole === 'admin' || userRole === 'superadmin';
    
    for (let i = 1; i < data.length; i++) {
        const row = data[i];
        if(!row[0]) continue;
        const ticketOwnerEmail = row[6] ? String(row[6]).toLowerCase().trim() : "";
        if (isAdmin || (userEmail && ticketOwnerEmail === userEmail) || (ticketOwnerEmail && userEmail && ticketOwnerEmail.includes(userEmail))) {
            let comments = [];
            try { comments = row[10] ? JSON.parse(row[10]) : []; } catch(e) {}
            tickets.push({
                ticketId: row[0], type: row[1], subject: row[2], description: row[3],
                priority: row[4], user: row[5], email: row[6], role: row[7],
                timestamp: row[8], status: row[9], comments: comments,
                assignedTo: row[11] || "", attachment: row[12] || ""
            });
        }
    }
    return ResponseBuilder.success({ tickets: tickets.reverse() });
  },

  handleUpdateTicket: function(ss, body) {
    let ticketSheet = ss.getSheetByName('Support_Tickets');
    if (!ticketSheet) return ResponseBuilder.error("DB Error");
    const data = ticketSheet.getDataRange().getValues();
    const ticketId = body.ticketId;
    let targetRowIndex = -1;
    let ticketOwnerEmail = "";
    
    for (let i = 1; i < data.length; i++) {
        if (String(data[i][0]) === ticketId) {
            targetRowIndex = i + 1;
            ticketOwnerEmail = String(data[i][6]);
            break;
        }
    }
    
    if (targetRowIndex > -1) {
        let notifSheet = ss.getSheetByName('SystemNotification');
        if (!notifSheet) {
            notifSheet = ss.insertSheet('SystemNotification');
            notifSheet.appendRow(["Notification_ID", "Recipient", "Type", "Message", "Timestamp", "IsRead", "ActionLink"]);
        }
        if (body.status) {
            ticketSheet.getRange(targetRowIndex, 10).setValue(body.status);
            notifSheet.appendRow(["NOTIF-" + Date.now(), ticketOwnerEmail.toLowerCase().trim(), "info", "Ticket " + ticketId + " status: " + body.status, new Date().toISOString(), "FALSE", "view:support"]);
        }
        if (body.assignedTo) {
            if (ticketSheet.getLastColumn() < 12) ticketSheet.getRange(1, 12).setValue("Assigned_Agent");
            ticketSheet.getRange(targetRowIndex, 12).setValue(body.assignedTo);
            notifSheet.appendRow(["NOTIF-" + Date.now() + "-U", ticketOwnerEmail.toLowerCase().trim(), "info", "Ticket " + ticketId + " assigned to: " + body.assignedTo, new Date().toISOString(), "FALSE", "view:support"]);
        }
        if (body.comment) {
            const currentCommentsJson = ticketSheet.getRange(targetRowIndex, 11).getValue();
            let comments = [];
            try { comments = currentCommentsJson ? JSON.parse(currentCommentsJson) : []; } catch(e) {}
            comments.push(body.comment);
            ticketSheet.getRange(targetRowIndex, 11).setValue(JSON.stringify(comments));
            
            const isResponderAdmin = String(body.comment.role).toLowerCase() === 'admin' || String(body.comment.role).toLowerCase() === 'superadmin';
            let recipient = isResponderAdmin ? ticketOwnerEmail.toLowerCase().trim() : 'Admin';
            notifSheet.appendRow(["NOTIF-" + Date.now(), recipient, "info", "New update on Ticket " + ticketId, new Date().toISOString(), "FALSE", "view:support"]);
        }
        return ResponseBuilder.success();
    }
    return ResponseBuilder.error("Ticket not found");
  }
};
`,mm=`
// =========================================================
// 5. UTILITIES & LIBRARIES (Helpers, Email, PDF)
// =========================================================

const ResponseBuilder = {
  success: function(data = {}) { return this.build({ status: "success", ...data }); },
  error: function(message, code = null) {
    const response = { status: "error", message: message };
    if (code) response.code = code;
    return this.build(response);
  },
  build: function(data) {
    return ContentService.createTextOutput(JSON.stringify(data)).setMimeType(ContentService.MimeType.JSON);
  }
};

const Validation = {
  updateFromRow: function(ss, body) {
     try {
       const row = body.row;
       const sheetName = body.sheet;
       let truck, trailer, driver, inspector, location;
       if (sheetName === 'General') {
           truck = row[2]; trailer = row[3]; inspector = row[4]; driver = row[5]; location = row[6];
       } else {
           truck = row[2]; trailer = row[3]; location = row[5]; inspector = row[7]; driver = row[8];
       }
       this.updateSingle(ss, 'Truck_Reg_No', truck);
       this.updateSingle(ss, 'Trailer_Reg_No', trailer);
       this.updateSingle(ss, 'Driver_Name', driver);
       this.updateSingle(ss, 'Inspector_Name', inspector);
       this.updateSingle(ss, 'Location', location);
     } catch (e) {}
  },
  updateSingle: function(ss, headerName, value) {
     if (!value || String(value).trim() === "") return;
     const valStr = String(value).trim();
     let vSheet = ss.getSheetByName('Validation_Data');
     if (!vSheet) {
        vSheet = ss.insertSheet('Validation_Data');
        vSheet.appendRow(['Truck_Reg_No', 'Trailer_Reg_No', 'Driver_Name', 'Inspector_Name', 'Location', 'Position']);
        vSheet.setFrozenRows(1);
     }
     const headers = vSheet.getRange(1, 1, 1, vSheet.getLastColumn()).getValues()[0];
     let colIndex = headers.indexOf(headerName) + 1;
     if (colIndex < 1) {
         colIndex = headers.length + 1;
         vSheet.getRange(1, colIndex).setValue(headerName);
     }
     const fullCol = vSheet.getRange(1, colIndex, vSheet.getMaxRows(), 1).getValues().flat().map(String);
     if (!fullCol.includes(valStr)) {
         let targetRow = 1;
         for(let i=1; i<fullCol.length; i++) {
             if(fullCol[i] === "") { targetRow = i + 1; break; }
         }
         if (targetRow === 1) targetRow = vSheet.getLastRow() + 1;
         vSheet.getRange(targetRow, colIndex).setValue(valStr);
     }
  }
};

const Logger = {
  log: function(ss, action, details) {
    let logSheet = ss.getSheetByName('System_Logs');
    if (!logSheet) {
        logSheet = ss.insertSheet('System_Logs');
        logSheet.appendRow(["Timestamp", "Action", "Details"]);
        logSheet.setFrozenRows(1);
    }
    logSheet.appendRow([new Date(), action, details]);
  }
};

const EmailHandlers = {
  sendEmailNotifications: function(ss, data, moduleName) {
    Logger.log(ss, "EMAIL_START", "Module: " + moduleName);
    
    try {
      var userSheet = ss.getSheetByName("Users");
      if (!userSheet) return;

      var users = userSheet.getDataRange().getValues();
      var recipients = [];
      
      for (var i = 1; i < users.length; i++) {
         var userEmail = String(users[i][0]).trim(); 
         var rawPrefs = users[i][6];
         
         if (userEmail && userEmail.indexOf("@") > -1) {
             try {
                 var prefs = rawPrefs ? JSON.parse(rawPrefs) : {};
                 var emailsEnabled = (prefs.emailNotifications !== false); 
                 
                 if (emailsEnabled) {
                     var shouldSend = false;
                     if (moduleName === "General" && (prefs.notifyGeneral !== false)) shouldSend = true;
                     if (moduleName === "Petroleum" && (prefs.notifyPetroleum !== false)) shouldSend = true;
                     if (moduleName === "Petroleum_V2" && (prefs.notifyPetroleumV2 !== false)) shouldSend = true;
                     if (moduleName === "Acid" && (prefs.notifyAcid !== false)) shouldSend = true;
                     
                     if (shouldSend) recipients.push(userEmail);
                 }
             } catch(e) {
                 recipients.push(userEmail);
             }
         }
      }

      if (recipients.length === 0) return;
      
      var row = data.row;
      var truckNo = "N/A", driver = "N/A", inspector = "N/A", rating = "N/A";
      
      if (moduleName === "General") {
          truckNo = row[2]; driver = row[5]; inspector = row[4]; rating = row[8];
      } else {
          truckNo = row[2]; driver = row[8]; inspector = row[7]; rating = row[9];
      }

      var statusColor = "#10b981";
      var statusText = "PASSED";
      if (rating <= 3) { statusColor = "#f59e0b"; statusText = "WARNING"; } 
      if (rating <= 2) { statusColor = "#ef4444"; statusText = "CRITICAL FAIL"; }

      var htmlBody = 
          "<div style='font-family: Helvetica, Arial, sans-serif; max-width: 600px; margin: 0 auto; border: 1px solid #e2e8f0; border-radius: 8px; overflow: hidden; background-color: #ffffff;'>" +
              "<div style='background-color: #0f172a; padding: 25px; text-align: center;'>" +
                  "<h2 style='color: white; margin: 0; font-size: 20px; font-weight: 600; letter-spacing: 0.5px;'>INSPECTION ALERT</h2>" +
              "</div>" +
              "<div style='padding: 30px; color: #334155;'>" +
                  "<p style='margin-top: 0; font-size: 15px; color: #475569;'>A new " + moduleName + " inspection report has been submitted.</p>" +
                  "<div style='background-color: #f8fafc; padding: 20px; border-radius: 8px; border: 1px solid #e2e8f0; margin: 20px 0;'>" +
                      "<table style='width: 100%; border-collapse: collapse;'>" +
                          "<tr>" +
                              "<td style='padding: 5px 0; color: #64748b; font-size: 12px; font-weight: 700; text-transform: uppercase;'>Vehicle</td>" +
                              "<td style='padding: 5px 0; color: #0f172a; font-size: 14px; font-weight: 600; text-align: right;'>" + truckNo + "</td>" +
                          "</tr>" +
                          "<tr>" +
                              "<td style='padding: 5px 0; color: #64748b; font-size: 12px; font-weight: 700; text-transform: uppercase;'>Inspector</td>" +
                              "<td style='padding: 5px 0; color: #0f172a; font-size: 14px; font-weight: 600; text-align: right;'>" + inspector + "</td>" +
                          "</tr>" +
                          "<tr>" +
                              "<td style='padding: 5px 0; color: #64748b; font-size: 12px; font-weight: 700; text-transform: uppercase;'>Result</td>" +
                              "<td style='padding: 5px 0; text-align: right;'>" +
                                  "<span style='color: " + statusColor + "; font-weight: 800; font-size: 14px;'>" + statusText + " (" + rating + "/5)</span>" +
                              "</td>" +
                          "</tr>" +
                      "</table>" +
                  "</div>" +
                  "<p style='font-size: 14px; line-height: 1.5;'>The official PDF report is attached to this email.</p>" +
                  "<hr style='border: 0; border-top: 1px solid #e2e8f0; margin: 30px 0;' />" +
                  "<p style='font-size: 11px; color: #94a3b8; text-align: center; margin: 0;'>Sent by SafetyCheck Pro Alerts System.</p>" +
              "</div>" +
          "</div>";

      var blobs = [];
      // (PDF Generation logic omitted for brevity in template, preserved in actual execution if present)
      
      var subject = "Inspection Report: " + truckNo + " [" + statusText + "]";
      var senderEmail = "notification@sallychanza.com";

      var emailOptions = {
          htmlBody: htmlBody,
          name: "Alerts", 
          attachments: blobs,
          bcc: recipients.slice(1).join(","),
          replyTo: senderEmail,
          from: senderEmail
      };

      try {
          GmailApp.sendEmail(recipients[0], subject, "HTML Required", emailOptions);
      } catch (e1) {
          Logger.log(ss, "EMAIL_FAILURE", "Alias failed: " + e1.toString());
      }

    } catch (err) {
        Logger.log(ss, "GLOBAL_EMAIL_ERROR", err.toString());
    }
  }
};

const PDFGenerator = {
  // Simplified PDF generator stub for template compactness. 
  // In real deployment, include full generator logic from previous versions or use libraries.
  create: function(data) { return "<html><body>PDF Content Placeholder</body></html>"; }
};
`,vs={"1_Controller.gs":cm,"2_AuthAndAdmin.gs":dm,"3_CoreOperations.gs":um,"4_SupportModule.gs":fm,"5_LibAndUtils.gs":mm},Ao=Object.values(vs).join(`

`),Qa="https://script.google.com/macros/s/AKfycbxb83lTxpK8v8gDuy_CZkkVJZROnm8IwyXbyApcbaK9od20EKQdzmtUeNm2zTqGnKWKfQ/exec",pm=3e5,hm=30*60*1e3,qa=12*60*60*1e3,xm=()=>{const[e,t]=j.useState(null),[n,s]=j.useState(null),l=j.useRef(Date.now()),o=j.useRef(Date.now()),i=j.useRef(null);j.useEffect(()=>{const x=localStorage.getItem("safetyCheck_user"),b=localStorage.getItem("safetyCheck_session_start");if(x)try{if(b){if(Date.now()-parseInt(b)>qa){h("max_duration");return}o.current=parseInt(b)}else localStorage.setItem("safetyCheck_session_start",Date.now().toString());const y=JSON.parse(x),L=y.role?String(y.role).trim().toLowerCase():"";L==="admin"?y.role="Admin":L==="operations"?y.role="Operations":L==="maintenance"?y.role="Maintenance":L==="secretary"?y.role="Secretary":L==="other"?y.role="Other":L==="superadmin"?y.role="SuperAdmin":y.role="Inspector",t(y),c()}catch{h()}},[]);const a=j.useCallback(()=>{if(!e)return;const x=Date.now();x-l.current>1e3&&(l.current=x,localStorage.setItem("safetyCheck_last_activity",x.toString()))},[e]),c=()=>{window.addEventListener("mousemove",a),window.addEventListener("keydown",a),window.addEventListener("touchstart",a),window.addEventListener("click",a),window.addEventListener("scroll",a),i.current&&window.clearInterval(i.current),i.current=window.setInterval(v,6e4)},d=()=>{window.removeEventListener("mousemove",a),window.removeEventListener("keydown",a),window.removeEventListener("touchstart",a),window.removeEventListener("click",a),window.removeEventListener("scroll",a),i.current&&(window.clearInterval(i.current),i.current=null)},v=()=>{const x=Date.now();if(x-l.current>hm){h("idle");return}if(x-o.current>qa){h("max_duration");return}},u=x=>{const b=Date.now();t(x),localStorage.setItem("safetyCheck_user",JSON.stringify(x)),localStorage.setItem("safetyCheck_session_start",b.toString()),localStorage.setItem("safetyCheck_last_activity",b.toString()),o.current=b,l.current=b,s(null),c()},h=x=>{d(),t(null),x&&s(x);const b=["safetyCheck_user","safetyCheck_session_start","safetyCheck_last_activity","sc_validation_lists"];for(let y=0;y<localStorage.length;y++){const L=localStorage.key(y);L&&(L.startsWith("sc_draft_")||L.startsWith("sc_history_")||L.startsWith("sc_read_notifications_")||L.startsWith("sc_dismissed_notifications_")||L.startsWith("sc_support_tickets_"))&&b.push(L)}b.forEach(y=>localStorage.removeItem(y))};return{currentUser:e,setCurrentUser:t,handleLogin:u,handleLogout:h,sessionExpired:n,setSessionExpired:s}},gm=()=>{const[e,t]=j.useState(()=>Qa.length>0?Qa:typeof window<"u"&&localStorage.getItem("safetyCheck_scriptUrl")||""),[n,s]=j.useState(()=>{if(typeof window<"u"){const c=localStorage.getItem("safetyCheck_settings");if(c)try{return JSON.parse(c)}catch(d){console.error("Failed to parse local settings",d)}}return{companyName:"My Transport Co.",managerEmail:""}}),[l,o]=j.useState(!1);j.useEffect(()=>{e&&i(e)},[e]);const i=async c=>{if(!(!c||typeof c!="string"||!c.startsWith("http"))&&navigator.onLine)try{const d=await fetch(`${c}?t=${new Date().getTime()}`);if(!d.ok)return;const u=(await d.json()).System_Settings;if(u&&Array.isArray(u)&&u.length>1){const h=u[u.length-1];if(h&&h.length>=2){const x={companyName:h[0]||"My Transport Co.",managerEmail:h[1]||"",companyLogo:h[4]&&String(h[4]).length>100?h[4]:void 0,mobileApkLink:h[5]||"",webAppUrl:h[6]||"",maintenanceMode:h[7]==="TRUE",maintenanceMessage:h[8]||""};s(b=>({...b,...x}));try{localStorage.setItem("safetyCheck_settings",JSON.stringify(x))}catch{}}}}catch{}};return{settings:n,setSettings:s,appScriptUrl:e,setAppScriptUrl:t,isSavingSettings:l,setIsSavingSettings:o,fetchSystemSettings:i,handleSaveSettings:async()=>{o(!0);try{localStorage.setItem("safetyCheck_settings",JSON.stringify(n)),localStorage.setItem("safetyCheck_scriptUrl",e),e&&e.startsWith("http")&&navigator.onLine&&await fetch(e,{method:"POST",body:JSON.stringify({action:"update_settings",companyName:n.companyName,managerEmail:n.managerEmail,companyLogo:n.companyLogo,mobileApkLink:n.mobileApkLink,webAppUrl:n.webAppUrl,maintenanceMode:n.maintenanceMode,maintenanceMessage:n.maintenanceMessage})})}catch(c){console.error("Save Settings Failed",c)}finally{setTimeout(()=>{o(!1)},800)}}}},Ja=50,bu=(e,t,n)=>{const[s,l]=j.useState([]),[o,i]=j.useState([]),[a,c]=j.useState([]),[d,v]=j.useState([]),[u,h]=j.useState([]),[x,b]=j.useState(!1);j.useEffect(()=>{if(!t)return;const k=t.username+"_",I=localStorage.getItem(`sc_read_notifications_${k}`),E=localStorage.getItem(`sc_dismissed_notifications_${k}`);I&&i(JSON.parse(I)),E&&c(JSON.parse(E)),"Notification"in window&&Notification.permission==="granted"&&b(!0)},[t]);const y=async()=>{if(!("Notification"in window))return n("This browser does not support system notifications.","error"),!1;try{return await Notification.requestPermission()==="granted"?(b(!0),L("Notifications Enabled",{body:"You will now receive system alerts for critical inspection updates.",icon:"https://cdn-icons-png.flaticon.com/512/716/716766.png"}),!0):(b(!1),!1)}catch(k){return console.error("Permission request error",k),!1}},L=(k,I)=>{if(Notification.permission==="granted")try{"serviceWorker"in navigator&&navigator.serviceWorker.ready?navigator.serviceWorker.ready.then(E=>{E.showNotification(k,I)}):new Notification(k,I)}catch(E){console.error("Notification trigger failed",E)}},p=k=>{if(!t)return;const I=t.username+"_";localStorage.setItem(`sc_read_notifications_${I}`,JSON.stringify(k)),i(k)},f=k=>{if(!t)return;const I=t.username+"_";localStorage.setItem(`sc_dismissed_notifications_${I}`,JSON.stringify(k)),c(k)};return{notifications:s,fetchNotifications:async()=>{if(!(!e||typeof e!="string"||!e.startsWith("http"))&&!(!navigator.onLine||!t))try{const k=await fetch(`${e}?t=${new Date().getTime()}`);if(!k.ok)return;const I=await k.text();if(!I||I.trim().startsWith("<"))return;let E;try{E=JSON.parse(I)}catch{return}const w=E.Acknowledgements||[];v(w);let S=[];const P=(F,$)=>{if(!Array.isArray(F)||F.length<=1)return[];const X=$==="General"?8:9,G=2,ie=[];return F.slice(Math.max(1,F.length-100)).forEach(K=>{const te=Number(K[X]),Z=K[G]||"Unknown Truck",ge=K[1],it=`${$}_${new Date(ge).getTime()}_${Z.replace(/\s/g,"")}`;if(a.includes(it)||w.includes(it))return;const Kt=o.includes(it);te<=2?ie.push({id:it,title:`Critical: ${Z}`,message:`${$} Check rated ${te}/5. Urgent attention needed.`,type:"critical",timestamp:ge,read:Kt,module:$}):te===3&&ie.push({id:it,title:`Warning: ${Z}`,message:`${$} Check rated ${te}/5. Maintenance review required.`,type:"warning",timestamp:ge,read:Kt,module:$})}),ie},M=E.SystemNotification||[],U=t.username.toLowerCase().trim(),Y=t.role.toLowerCase().trim(),Q=Y==="superadmin";Array.isArray(M)&&M.length>1&&M.slice(Math.max(1,M.length-50)).forEach($=>{const X=String($[0]),G=String($[1]).trim().toLowerCase();if(!(String($[5]).toUpperCase()==="TRUE")&&(G===U||(G===Y||Q&&G==="admin")||G==="all")){if(a.includes(X))return;const Z=String($[2]).toLowerCase();let ge="info";Z==="critical"?ge="critical":Z==="warning"?ge="warning":Z==="success"&&(ge="success"),S.push({id:X,title:Z==="success"?"System Update":"Notification",message:String($[3]),type:ge,timestamp:$[4],read:o.includes(X),actionLink:$[6],isServerEvent:!0,module:"System"})}});const _=E.Support_Tickets||[];Array.isArray(_)&&_.length>1&&_.slice(Math.max(1,_.length-50)).forEach(F=>{const $=F[0],X=F[2],G=F[9],ie=F[11]?String(F[11]):null,D=ie&&ie.toLowerCase()===t.name.toLowerCase();if((Q||Y==="admin"||D)&&(G==="Open"||G==="In Progress")){const te=`ticket_active_${$}_${G}`,Z=S.some(ge=>ge.message.includes($));!a.includes(te)&&!Z&&S.push({id:te,title:G==="Open"?"New Ticket":"Ticket In Progress",message:`#${$}: ${X}`,type:"info",timestamp:F[8],read:o.includes(te),module:"Support",actionLink:"view:support"})}});const W=E.Subscription_Data;if(W&&W.status){const F=new Date(W.expiryDate),$=new Date,X=Math.ceil((F.getTime()-$.getTime())/(1e3*60*60*24)),G=`sub_alert_${W.expiryDate}`;a.includes(G)||(W.status==="Expired"?S.push({id:G,title:"License Expired",message:"System is locked. Please renew subscription immediately.",type:"critical",timestamp:new Date().toISOString(),read:o.includes(G),module:"Billing",actionLink:"view:settings"}):X<=7&&S.push({id:G,title:"License Expiring",message:`Subscription expires in ${X} days. Renew to avoid lockout.`,type:"warning",timestamp:new Date().toISOString(),read:o.includes(G),module:"Billing",actionLink:"view:settings"}))}const B=JSON.parse(localStorage.getItem("safetycheck_offline_queue")||"[]");if(B.length>0){const F=`sync_pending_${B.length}`;S.push({id:F,title:"Offline Data Pending",message:`${B.length} records waiting to sync. Connect to internet to upload.`,type:"warning",timestamp:new Date().toISOString(),read:!1,module:"Sync"})}E.General&&(S=[...S,...P(E.General,"General")]),E.Petroleum&&(S=[...S,...P(E.Petroleum,"Petroleum")]),E.Petroleum_V2&&(S=[...S,...P(E.Petroleum_V2,"Petroleum_V2")]),E.Acid&&(S=[...S,...P(E.Acid,"Acid")]),S.sort((F,$)=>{const X=(F.read?0:2)+(F.type==="critical"?1:0),G=($.read?0:2)+($.type==="critical"?1:0);return X!==G?G-X:new Date($.timestamp).getTime()-new Date(F.timestamp).getTime()}),S.length>Ja&&(S=S.slice(0,Ja));const H=S.filter(F=>!u.includes(F.id));if(H.length>0){const F=H.find(G=>G.type==="critical"),$=H.find(G=>G.type==="warning"),X=H.find(G=>G.type==="info");F?(n(F.message,"error"),L(F.title,{body:F.message,icon:"https://cdn-icons-png.flaticon.com/512/716/716766.png",tag:F.id})):$?(n($.message,"info"),L($.title,{body:$.message,icon:"https://cdn-icons-png.flaticon.com/512/716/716766.png",tag:$.id})):X&&X.module==="System"&&(n(X.message,"info"),L(X.title,{body:X.message,icon:"https://cdn-icons-png.flaticon.com/512/716/716766.png",tag:X.id})),h(G=>[...G,...H.map(ie=>ie.id)])}l(S)}catch{}},handleMarkNotificationRead:async(k,I)=>{const E=s.find(S=>S.id===k);if(l(S=>S.map(P=>P.id===k?{...P,read:!0}:P)),E!=null&&E.isServerEvent&&e&&navigator.onLine)try{await fetch(e,{method:"POST",body:JSON.stringify({action:"mark_notification_read",id:k}),mode:"no-cors"})}catch{}const w=[...o,k];if(p(w),E!=null&&E.actionLink&&I){const S=E.actionLink.toLowerCase();S.startsWith("request:")?I("request_handler"):S.includes("view:petroleum")?I("petroleum"):S.includes("view:general")?I("general"):S.includes("view:acid")?I("acid"):S.includes("view:settings")&&(t==null?void 0:t.role)==="Admin"?I("settings"):S.includes("view:users")&&(t==null?void 0:t.role)==="Admin"?I("users"):S.includes("view:support")&&I("support")}},handleDismissNotification:k=>{l(E=>E.filter(w=>w.id!==k));const I=[...a,k];f(I)},handleGlobalAcknowledge:async k=>{if(!(!e||!navigator.onLine)){l(I=>I.filter(E=>E.id!==k)),v(I=>[...I,k]);try{const I={action:"acknowledge_issue",issueId:k,user:(t==null?void 0:t.name)||"Unknown",role:(t==null?void 0:t.role)||"Unknown"};await fetch(e,{method:"POST",body:JSON.stringify(I),mode:"no-cors"}),n("Issue Resolved & Acknowledged Globally.","success")}catch{}}},handleClearAllNotifications:()=>{const k=s.map(w=>w.id),I=[...new Set([...o,...k])];p(I);const E=[...new Set([...a,...k])];f(E),l([])},requestPushPermission:y,pushEnabled:x}},ym=(e,t,n)=>{const[s,l]=j.useState([]),[o,i]=j.useState(!1),[a,c]=j.useState(!1),[d,v]=j.useState({trucks:[],trailers:[],drivers:[],inspectors:[],locations:[],positions:[]}),u=async(x=!1)=>{if(!e||typeof e!="string"||!e.startsWith("http"))return;const y=`sc_history_${n?`${n.username}_`:"anon_"}${t}`,L=localStorage.getItem(y);let p=!1;if(L&&!x)try{const f=JSON.parse(L);if(f.data&&Array.isArray(f.data)){l(f.data),p=!0;const m=localStorage.getItem("sc_validation_lists");if(m&&v(JSON.parse(m)),Date.now()-f.timestamp<pm){i(!1);return}}}catch(f){console.error("Cache parsing error",f)}if(p?c(!0):i(!0),!navigator.onLine){i(!1),c(!1);return}try{const f=await fetch(`${e}?t=${new Date().getTime()}`);if(!f.ok)throw new Error("Network response was not ok");const m=await f.text();if(!m||m.trim().startsWith("<"))throw new Error("Invalid response format");const g=JSON.parse(m),C=g.Validation_Data;if(C){const E={trucks:C.Truck_Reg_No||[],trailers:C.Trailer_Reg_No||[],drivers:C.Driver_Name||[],inspectors:C.Inspector_Name||[],locations:C.Location||[],positions:C.Position||[]};v(E),localStorage.setItem("sc_validation_lists",JSON.stringify(E))}let R="General",N=xu;t==="petroleum"?(R="Petroleum",N=gu):t==="petroleum_v2"?(R="Petroleum_V2",N=yu):t==="acid"&&(R="Acid",N=vu);const k=g[R];let I=[];k!==void 0&&Array.isArray(k)&&k.length>1&&(I=k.slice(1).map(E=>{const w={};return N.forEach((S,P)=>{w[S]=E[P]!==void 0?E[P]:null}),w}).reverse()),l(I),localStorage.setItem(y,JSON.stringify({timestamp:Date.now(),data:I}))}catch{}finally{i(!1),c(!1)}},h=j.useMemo(()=>{if(!s.length)return{total:0,avgRate:0,passRate:0};const x=s.length,y=(s.filter(L=>Number(L.rate)>=4).length/x*100).toFixed(0);return{total:x,avgRate:0,passRate:y}},[s]);return{historyList:s,isLoadingHistory:o,isBackgroundFetching:a,validationLists:d,stats:h,fetchHistory:u}},vm=(e,t,n)=>{const[s,l]=j.useState("idle"),[o,i]=j.useState([]),[a,c]=j.useState(!1),[d,v]=j.useState(!1);j.useEffect(()=>{const x=localStorage.getItem("safetycheck_offline_queue");if(x)try{i(JSON.parse(x))}catch{}const b=()=>{v(!1),t("Connection restored. Attempting background sync...","info"),u()},y=()=>{v(!1)};return window.addEventListener("online",b),window.addEventListener("offline",y),()=>{window.removeEventListener("online",b),window.removeEventListener("offline",y)}},[]);const u=async()=>{if(a)return;const x=JSON.parse(localStorage.getItem("safetycheck_offline_queue")||"[]");if(x.length===0)return;c(!0),v(!1);let b=0,y=[...x];y.length;try{for(;y.length>0;){const L=y[0];try{const p=new AbortController,f=setTimeout(()=>p.abort(),15e3),m=await fetch(e,{method:"POST",body:JSON.stringify(L),mode:"no-cors",headers:{"Content-Type":"text/plain"},signal:p.signal});clearTimeout(f),y.shift(),b++,i([...y]),localStorage.setItem("safetycheck_offline_queue",JSON.stringify(y)),await new Promise(g=>setTimeout(g,1e3))}catch(p){if(console.error("Sync failed for item",p),p.name==="AbortError"||p.message.includes("NetworkError")||p.message.includes("Failed to fetch")){v(!0);break}break}}}finally{c(!1),b>0?y.length===0?(t(`All ${b} offline records synced successfully!`,"success"),n()):t(`Synced ${b} items. ${y.length} remaining.`,"info"):d&&x.length>0}};return{submissionStatus:s,setSubmissionStatus:l,offlineQueue:o,isSyncing:a,isPoorConnection:d,syncOfflineQueue:u,addToQueue:x=>{const b=[...o,x];i(b),localStorage.setItem("safetycheck_offline_queue",JSON.stringify(b))}}},bm=(e,t)=>{const[n,s]=j.useState(null),[l,o]=j.useState(!1),i=async()=>{if(!(!e||typeof e!="string"||!e.startsWith("http"))&&t){o(!0);try{const c=await fetch(`${e}?t=${new Date().getTime()}`);if(!c.ok)return;const d=await c.text();if(!d||d.trim().startsWith("<"))return;const v=JSON.parse(d);if(v.Subscription_Data){const u=v.Subscription_Data,h=new Date(u.expiryDate),x=new Date,b=h.getTime()-x.getTime(),y=Math.ceil(b/(1e3*60*60*24));s({status:u.status,plan:u.plan,expiryDate:u.expiryDate,daysRemaining:y})}}catch{}finally{o(!1)}}};j.useEffect(()=>{i()},[e,t]);const a=(n==null?void 0:n.status)==="Expired"&&(t==null?void 0:t.role)!=="SuperAdmin";return{subscription:n,isLocked:a,isLoading:l,refreshSubscription:i}},Ya=({message:e,type:t,onClose:n})=>{const s={success:"bg-green-600",error:"bg-red-600",info:"bg-blue-600",warning:"bg-amber-500"};return r.jsxs("div",{className:`fixed top-4 right-4 z-50 ${s[t]} text-white px-6 py-4 rounded-xl shadow-2xl flex items-center gap-4 animate-fadeIn max-w-sm`,children:[r.jsx("div",{className:"flex-1 font-medium",children:e}),r.jsx("button",{onClick:n,className:"opacity-80 hover:opacity-100",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})},wm=({isOpen:e,onClose:t,activeModule:n,onSelectModule:s,settings:l,user:o,onLogout:i,onEditProfile:a,onLockedItemClick:c,subscription:d,onRequestInspection:v})=>{const u=o!=null&&o.role?String(o.role).toLowerCase():"",h=u==="admin"||u==="superadmin",x=u==="superadmin",b=h||["operations","maintenance","secretary","other","clerk"].includes(u),[y,L]=j.useState(!1);j.useEffect(()=>{L(!1)},[l.companyLogo]);const p=({id:f,label:m,icon:g,subLabel:C,isLocked:R=!1,isDanger:N=!1,onClickCustom:k})=>{const I=n===f,E=f==="profile";return r.jsxs("button",{onClick:()=>{if(k){k();return}R&&c?(c(m),t()):E&&a?(a(),t()):(s(f),t())},className:`w-full group relative flex items-center gap-3 px-3 py-2 rounded-lg transition-all duration-200 overflow-hidden
                    ${I?N?"bg-red-600 text-white shadow-md":"bg-emerald-600 text-white shadow-md shadow-emerald-900/20":R?"text-slate-500 cursor-not-allowed opacity-70 hover:bg-slate-800/50":N?"text-red-400 hover:bg-red-900/20 hover:text-red-300":"text-slate-400 hover:bg-slate-800 hover:text-white"}
                `,children:[I&&r.jsx("div",{className:"absolute left-0 top-1 bottom-1 w-1 bg-white/40 rounded-r shadow-sm"}),r.jsx("span",{className:`relative z-10 transition-transform duration-300 shrink-0 ${I?"scale-105 text-white":R?"text-slate-600":"group-hover:text-white group-hover:scale-105"}`,children:g}),r.jsxs("div",{className:"flex flex-col items-start relative z-10 text-left flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center justify-between w-full",children:[r.jsx("span",{className:`text-sm font-semibold tracking-wide truncate leading-tight ${I?"text-white":R?"text-slate-500":N?"text-red-400 group-hover:text-red-200":"text-slate-300 group-hover:text-white"}`,children:m}),R&&r.jsx("svg",{className:"w-3 h-3 text-amber-600/60 ml-2 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})]}),C&&r.jsx("span",{className:`text-[10px] leading-none mt-0.5 ${I?"text-emerald-100":"text-slate-500 group-hover:text-slate-400"}`,children:C})]})]})};return r.jsxs(r.Fragment,{children:[e&&r.jsx("div",{className:"fixed inset-0 z-[55] bg-slate-900/60 backdrop-blur-sm lg:hidden transition-opacity cursor-pointer",onClick:t}),r.jsxs("aside",{className:`fixed inset-y-0 left-0 z-[60] w-64 bg-slate-900 text-white transform transition-transform duration-300 ease-out ${e?"translate-x-0":"-translate-x-full"} lg:translate-x-0 border-r border-slate-800 flex flex-col shadow-2xl`,children:[r.jsx("div",{className:"px-4 py-4 border-b border-slate-800 bg-black/20 shrink-0",children:r.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[r.jsx("div",{id:"sidebar-toggle",className:"w-9 h-9 rounded-lg bg-white flex items-center justify-center text-emerald-900 shadow-lg shrink-0 overflow-hidden p-1",children:l.companyLogo&&!y?r.jsx("img",{src:l.companyLogo,alt:"Logo",className:"w-full h-full object-contain",onError:()=>L(!0)}):r.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 01 1v5m-4 0h4"})})}),r.jsxs("div",{className:"min-w-0 flex flex-col justify-center",children:[r.jsx("h1",{className:"text-sm font-black tracking-tight text-white leading-tight truncate",children:l.companyName||"SafetyPro"}),r.jsx("span",{className:"text-[10px] font-bold text-emerald-500 uppercase tracking-widest truncate block mt-0.5",children:"System Active"})]}),r.jsx("button",{onClick:t,className:"lg:hidden text-slate-400 hover:text-white ml-auto p-1",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),r.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-hide px-3 py-3 space-y-1",children:[r.jsx(p,{id:"overview",label:"Dashboard",icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),r.jsx("div",{className:"my-2 mx-2 border-t border-slate-800/40"}),r.jsx(p,{id:"general",label:"General",icon:r.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 012-2v0a2 2 0 012 2m9 0a2 2 0 012-2v0a2 2 0 012 2"})]})}),r.jsx(p,{id:"petroleum",label:"Petroleum V1",icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),r.jsx(p,{id:"petroleum_v2",label:"Petroleum V2",icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),r.jsx(p,{id:"acid",label:"Acid",icon:r.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})]})}),b&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"my-2 mx-2 border-t border-slate-800/40"}),r.jsx(p,{id:"request_inspection",label:"Request Inspection",onClickCustom:()=>{v==null||v(),t()},icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})}),r.jsx(p,{id:"track_requests",label:"Track Requests",icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})})]}),r.jsx("div",{className:"my-2 mx-2 border-t border-slate-800/40"}),r.jsx(p,{id:"enterprise_suite",label:"Enterprise Suite",subLabel:"Fleet, Lashing, Stores...",isLocked:!0,icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),r.jsx("div",{className:"my-2 mx-2 border-t border-slate-800/40"}),h?r.jsxs(r.Fragment,{children:[x&&r.jsx(p,{id:"maintenance",label:"Console",isDanger:!0,icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})}),r.jsx(p,{id:"settings",label:"System",icon:r.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),r.jsx(p,{id:"users",label:"Users",icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})})]}):r.jsx(p,{id:"profile",label:"Profile",icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),r.jsx(p,{id:"support",label:"Help & Support",icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z"})})})]}),r.jsxs("div",{className:"shrink-0 bg-slate-900 z-10 border-t border-slate-800",children:[d&&r.jsx("div",{className:"px-3 py-3",children:r.jsx("div",{className:`flex items-center justify-between px-3 py-2 rounded-lg border transition-colors ${d.status==="Active"?"bg-slate-800/40 border-slate-800":"bg-red-900/10 border-red-900/30"}`,children:r.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[r.jsx("div",{className:`w-2 h-2 rounded-full shrink-0 ${d.status==="Active"?"bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.4)]":"bg-red-500 animate-pulse"}`}),r.jsxs("div",{className:"flex flex-col min-w-0",children:[r.jsx("span",{className:"text-xs font-bold text-slate-300 uppercase tracking-wider truncate leading-none",children:d.plan}),r.jsx("span",{className:"text-[10px] text-slate-500 truncate leading-tight mt-0.5",children:d.daysRemaining>0?r.jsxs("span",{className:d.daysRemaining<=7?"text-amber-400":"",children:[d.daysRemaining," Days"]}):r.jsx("span",{className:"text-red-400",children:"Expired"})})]})]})})}),r.jsx("div",{className:"p-3 bg-black/20",children:r.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg bg-slate-800 border border-slate-700 hover:bg-slate-700 transition-colors group",children:[r.jsxs("div",{className:"flex-1 flex items-center gap-3 min-w-0",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-emerald-600 flex items-center justify-center text-xs font-bold text-white shadow-md shrink-0 border border-emerald-800 group-hover:border-emerald-500 transition-colors",children:o!=null&&o.name?o.name.substring(0,2).toUpperCase():"OP"}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"text-sm font-bold text-white truncate leading-tight group-hover:text-emerald-300 transition-colors",children:(o==null?void 0:o.name)||"User"}),r.jsx("div",{className:"text-xs text-slate-400 truncate leading-tight",children:(o==null?void 0:o.role)||"User"})]})]}),r.jsx("div",{className:"flex items-center border-l border-slate-600 pl-2 ml-1 space-x-1",children:r.jsx("button",{onClick:i,className:"p-1.5 text-slate-400 hover:text-red-400 hover:bg-red-900/20 rounded transition-all",title:"Sign Out",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H5a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})})})]})})]})]})]})},jm=({onClose:e,onPrint:t,children:n,title:s})=>{const[l,o]=j.useState(!1),i=()=>{o(!0);const a=document.getElementById("printable-report-content");if(!a){console.error("Report content not found"),o(!1);return}const d={margin:0,filename:`${s.replace(/[^a-zA-Z0-9]/g,"_")}_${new Date().toISOString().split("T")[0]}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,letterRendering:!0,scrollY:0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}},v=window.html2pdf;v?v().set(d).from(a).save().then(()=>{o(!1)}).catch(u=>{console.error("PDF Generation Error",u),o(!1),alert("Failed to generate PDF. You can try the Print button as an alternative.")}):(console.error("html2pdf library not loaded"),o(!1),t())};return r.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-sm animate-fadeIn",children:r.jsxs("div",{className:"bg-white w-full max-w-5xl h-[90vh] rounded-2xl shadow-2xl flex flex-col overflow-hidden",children:[r.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-gray-800",children:s}),r.jsx("p",{className:"text-xs text-gray-500",children:"Preview Mode"})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-600 hover:bg-gray-200 rounded-lg transition-colors",children:"Close"}),r.jsxs("button",{onClick:t,className:"px-4 py-2 text-sm font-bold text-slate-700 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 shadow-sm flex items-center gap-2 transition-transform active:scale-95",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print"]}),r.jsx("button",{onClick:i,disabled:l,className:`px-4 py-2 text-sm font-bold text-white rounded-lg shadow-md flex items-center gap-2 transition-transform active:scale-95
                                ${l?"bg-blue-400 cursor-wait":"bg-blue-600 hover:bg-blue-700"}
                            `,children:l?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"animate-spin w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download PDF"]})})]})]}),r.jsx("div",{className:"flex-1 overflow-auto bg-gray-100 p-8 flex justify-center relative",children:r.jsx("div",{className:"origin-top transform scale-90 md:scale-100 transition-transform",children:r.jsx("div",{id:"printable-report-content",className:"bg-white shadow-xl min-h-[297mm]",children:n})})})]})})},Nm=({status:e})=>e==="idle"?null:r.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-md transition-all duration-300"}),r.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl p-8 max-w-sm w-full mx-4 text-center transform transition-all duration-300 scale-100 animate-fadeIn border border-white/20",children:[e==="submitting"&&r.jsxs("div",{className:"flex flex-col items-center gap-4 py-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"w-16 h-16 border-4 border-blue-100 border-t-blue-600 rounded-full animate-spin"}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Submitting Inspection"}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Syncing data with Google Sheets..."})]})]}),e==="success"&&r.jsxs("div",{className:"flex flex-col items-center gap-4 py-4",children:[r.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center animate-bounce",children:r.jsx("svg",{className:"w-10 h-10 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-black text-gray-900",children:"Success!"}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Inspection record saved securely."}),r.jsx("p",{className:"text-xs text-blue-500 mt-4 font-medium uppercase tracking-wide",children:"Redirecting to Dashboard..."})]})]}),e==="offline_saved"&&r.jsxs("div",{className:"flex flex-col items-center gap-4 py-4",children:[r.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center shadow-inner",children:r.jsx("svg",{className:"w-10 h-10 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-black text-gray-900",children:"Connection Unstable"}),r.jsxs("p",{className:"text-sm text-gray-500 mt-2 leading-relaxed",children:["Don't worry, your data is safe! It has been stored on your device and will ",r.jsx("strong",{children:"automatically upload"})," when the connection improves."]}),r.jsx("p",{className:"text-xs text-amber-600 mt-4 font-medium uppercase tracking-wide",children:"Returning to Dashboard..."})]})]})]})]}),km=({user:e,appScriptUrl:t,onClose:n,showToast:s,onUpdateSuccess:l})=>{const[o,i]=j.useState("profile"),[a,c]=j.useState(e.name),[d,v]=j.useState(e.username),[u,h]=j.useState(""),[x,b]=j.useState(e.preferences||{emailNotifications:!1,notifyGeneral:!0,notifyPetroleum:!0,notifyPetroleumV2:!0,notifyAcid:!0}),[y,L]=j.useState(!1),{requestPushPermission:p,pushEnabled:f}=bu(t,e,s),m=e.role==="Admin",g=N=>{b(k=>({...k,[N]:!k[N]}))},C=async()=>{f?s("To disable device alerts, please reset permissions in your browser settings.","info"):await p()&&s("Device alerts enabled successfully!","success")},R=async N=>{N.preventDefault(),L(!0);try{const I=await(await fetch(t,{method:"POST",body:JSON.stringify({action:"update_user",originalUsername:e.username,username:d,name:a,password:u||void 0,role:e.role,position:e.position,preferences:x})})).json();I.status==="success"?(s("Account settings updated successfully!","success"),l({...e,name:a,username:d,position:e.position,preferences:x}),n()):s(I.message||"Failed to update profile.","error")}catch(k){console.error(k),s("Connection failed.","error")}finally{L(!1)}};return r.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-sm animate-fadeIn",children:r.jsxs("div",{className:"bg-white w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[r.jsxs("div",{className:"bg-slate-50 px-6 py-4 border-b border-gray-100 flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Account Settings"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Manage your profile and preferences"})]}),r.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-200 transition",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("div",{className:"flex border-b border-gray-100",children:[r.jsxs("button",{onClick:()=>i("profile"),className:`flex-1 py-3 text-sm font-bold border-b-2 transition-colors flex items-center justify-center gap-2
                           ${o==="profile"?"border-blue-600 text-blue-600 bg-blue-50/50":"border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50"}
                        `,children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Profile Details"]}),r.jsxs("button",{onClick:()=>i("notifications"),className:`flex-1 py-3 text-sm font-bold border-b-2 transition-colors flex items-center justify-center gap-2
                           ${o==="notifications"?"border-blue-600 text-blue-600 bg-blue-50/50":"border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50"}
                        `,children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),"Notifications"]})]}),r.jsx("div",{className:"overflow-y-auto p-6",children:r.jsxs("form",{onSubmit:R,className:"space-y-6",children:[o==="profile"&&r.jsxs("div",{className:"space-y-4 animate-fadeIn",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Full Name"}),r.jsx("input",{type:"text",required:!0,readOnly:!m,className:`w-full p-3 border rounded-lg outline-none transition font-medium
                                            ${m?"bg-gray-50 border-gray-200 focus:ring-2 focus:ring-blue-500":"bg-gray-100 text-gray-500 border-gray-200"}
                                        `,value:a,onChange:N=>c(N.target.value)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Username"}),r.jsx("input",{type:"text",required:!0,readOnly:!m,className:`w-full p-3 border rounded-lg outline-none transition font-medium
                                            ${m?"bg-gray-50 border-gray-200 focus:ring-2 focus:ring-blue-500":"bg-gray-100 text-gray-500 border-gray-200"}
                                        `,value:d,onChange:N=>v(N.target.value)}),!m&&r.jsx("p",{className:"text-[10px] text-gray-400",children:"Contact Admin to change username."})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"New Password"}),r.jsx("input",{type:"password",className:"w-full p-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition font-medium placeholder-gray-400",value:u,onChange:N=>h(N.target.value),placeholder:"Leave blank to keep current"})]}),r.jsxs("div",{className:"bg-blue-50 text-blue-800 p-4 rounded-lg text-xs border border-blue-100 flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-bold uppercase tracking-wide opacity-70",children:"Role"}),r.jsx("div",{className:"text-sm font-black",children:e.role})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"font-bold uppercase tracking-wide opacity-70",children:"Position"}),r.jsx("div",{className:"text-sm font-black",children:e.position||"N/A"})]})]})]}),o==="notifications"&&r.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[r.jsxs("div",{className:`flex items-center justify-between p-4 rounded-xl border ${f?"bg-green-50 border-green-200":"bg-white border-gray-200 shadow-sm"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`p-2 rounded-lg ${f?"bg-green-200 text-green-700":"bg-slate-100 text-slate-500"}`,children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-gray-900 text-sm",children:"Device Push Alerts"}),r.jsx("div",{className:"text-xs text-gray-500",children:f?"System alerts active":"Enable browser notifications"})]})]}),r.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[r.jsx("input",{type:"checkbox",className:"sr-only peer",checked:f,onChange:C}),r.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"})]})]}),r.jsx("div",{className:"h-px bg-gray-200"}),r.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-4 rounded-xl border border-gray-100",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-gray-900 text-sm",children:"Email Summaries"}),r.jsx("div",{className:"text-xs text-gray-500",children:"Receive reports via email"})]}),r.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[r.jsx("input",{type:"checkbox",className:"sr-only peer",checked:x.emailNotifications,onChange:()=>g("emailNotifications")}),r.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),r.jsxs("div",{className:`space-y-4 transition-opacity pl-2 ${x.emailNotifications?"opacity-100":"opacity-50 pointer-events-none"}`,children:[r.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide pb-1",children:"Email Types:"}),r.jsxs("label",{className:"flex items-center justify-between cursor-pointer p-2 hover:bg-gray-50 rounded-lg transition",children:[r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"General Inspections"}),r.jsx("input",{type:"checkbox",className:"w-5 h-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500",checked:x.notifyGeneral,onChange:()=>g("notifyGeneral")})]}),r.jsxs("label",{className:"flex items-center justify-between cursor-pointer p-2 hover:bg-gray-50 rounded-lg transition",children:[r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Petroleum Inspections"}),r.jsx("input",{type:"checkbox",className:"w-5 h-5 text-orange-600 rounded border-gray-300 focus:ring-orange-500",checked:x.notifyPetroleum,onChange:()=>g("notifyPetroleum")})]}),r.jsxs("label",{className:"flex items-center justify-between cursor-pointer p-2 hover:bg-gray-50 rounded-lg transition",children:[r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Petroleum V2 Inspections"}),r.jsx("input",{type:"checkbox",className:"w-5 h-5 text-red-600 rounded border-gray-300 focus:ring-red-500",checked:x.notifyPetroleumV2,onChange:()=>g("notifyPetroleumV2")})]}),r.jsxs("label",{className:"flex items-center justify-between cursor-pointer p-2 hover:bg-gray-50 rounded-lg transition",children:[r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Acid Tanker Inspections"}),r.jsx("input",{type:"checkbox",className:"w-5 h-5 text-purple-600 rounded border-gray-300 focus:ring-purple-500",checked:x.notifyAcid,onChange:()=>g("notifyAcid")})]})]})]}),r.jsxs("div",{className:"pt-4 flex gap-3 border-t border-gray-100 mt-2",children:[r.jsx("button",{type:"button",onClick:n,className:"flex-1 py-3 bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 font-bold rounded-xl transition text-sm",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:y,className:"flex-1 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl shadow-md transition disabled:bg-blue-400 text-sm",children:y?"Saving...":"Save Changes"})]})]})})]})})},Sm=({notifications:e,onMarkAsRead:t,onDismiss:n,onClearAll:s,onAcknowledge:l,canAcknowledge:o=!1})=>{const[i,a]=j.useState(!1),[c,d]=j.useState("all"),[v,u]=j.useState(null),h=j.useRef(null);j.useEffect(()=>{function g(C){h.current&&!h.current.contains(C.target)&&a(!1)}return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[h]);const x=e.filter(g=>!g.read).length,b=e.filter(g=>!g.read&&g.type==="critical").length,y=j.useMemo(()=>{let g=[...e];return c==="unread"?g=g.filter(C=>!C.read):c==="critical"&&(g=g.filter(C=>C.type==="critical")),g.sort((C,R)=>C.type==="critical"&&!C.read&&(R.type!=="critical"||R.read)?-1:R.type==="critical"&&!R.read&&(C.type!=="critical"||C.read)?1:new Date(R.timestamp).getTime()-new Date(C.timestamp).getTime())},[e,c]),L=g=>{const C=new Date(g),N=Math.floor((new Date().getTime()-C.getTime())/1e3);return N<60?"Just now":N<3600?`${Math.floor(N/60)}m ago`:N<86400?`${Math.floor(N/3600)}h ago`:N<172800?"Yesterday":C.toLocaleDateString()},p=g=>{switch(g){case"critical":return r.jsx("div",{className:"w-9 h-9 rounded-full bg-red-100 text-red-600 flex items-center justify-center shrink-0 shadow-sm border border-red-200",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})});case"warning":return r.jsx("div",{className:"w-9 h-9 rounded-full bg-amber-100 text-amber-600 flex items-center justify-center shrink-0 shadow-sm border border-amber-200",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})});case"success":return r.jsx("div",{className:"w-9 h-9 rounded-full bg-green-100 text-green-600 flex items-center justify-center shrink-0 shadow-sm border border-green-200",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})});default:return r.jsx("div",{className:"w-9 h-9 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center shrink-0 shadow-sm border border-blue-200",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})}},f=(g,C)=>{g.stopPropagation(),l&&(u(C),l(C))},m=(g,C)=>{g.stopPropagation(),t(C)};return r.jsxs("div",{className:"relative",ref:h,children:[r.jsxs("button",{onClick:()=>a(!i),className:`relative p-2 transition-colors rounded-full transition-all duration-300
                    ${i?"bg-blue-800 text-white":"text-blue-200 hover:text-white hover:bg-blue-800"}
                `,children:[r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),x>0&&r.jsxs("span",{className:"absolute top-1 right-1 flex h-4 w-4",children:[r.jsx("span",{className:`animate-ping absolute inline-flex h-full w-full rounded-full opacity-75 ${b>0?"bg-red-400":"bg-blue-400"}`}),r.jsx("span",{className:`relative inline-flex rounded-full h-4 w-4 text-[9px] font-bold text-white items-center justify-center ${b>0?"bg-red-500":"bg-blue-500"}`,children:x>9?"9+":x})]})]}),i&&r.jsxs("div",{className:"absolute right-0 mt-3 w-80 md:w-96 bg-white rounded-2xl shadow-2xl ring-1 ring-black ring-opacity-5 z-[100] overflow-hidden animate-fadeIn origin-top-right",children:[r.jsxs("div",{className:"px-5 py-4 bg-white border-b border-gray-100 flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-bold text-gray-800 text-lg",children:"Notifications"}),b>0&&r.jsxs("p",{className:"text-xs text-red-600 font-bold mt-0.5 flex items-center gap-1",children:[r.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-red-600"}),b," Critical Issues Found"]})]}),e.length>0&&r.jsxs("button",{onClick:s,className:"text-xs font-bold text-slate-500 hover:text-red-600 bg-slate-100 hover:bg-red-50 px-3 py-1.5 rounded-lg transition-colors flex items-center gap-1",children:[r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Dismiss All"]})]}),r.jsxs("div",{className:"flex border-b border-gray-100 bg-gray-50/50",children:[r.jsx("button",{onClick:()=>d("all"),className:`flex-1 py-2.5 text-xs font-bold text-center border-b-2 transition-colors ${c==="all"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"All"}),r.jsx("button",{onClick:()=>d("unread"),className:`flex-1 py-2.5 text-xs font-bold text-center border-b-2 transition-colors ${c==="unread"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Unread"}),r.jsx("button",{onClick:()=>d("critical"),className:`flex-1 py-2.5 text-xs font-bold text-center border-b-2 transition-colors ${c==="critical"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Critical"})]}),r.jsx("div",{className:"max-h-[60vh] overflow-y-auto bg-gray-50",children:y.length===0?r.jsxs("div",{className:"p-10 text-center text-gray-400 flex flex-col items-center",children:[r.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-3",children:r.jsx("svg",{className:"w-8 h-8 opacity-40",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"You're all caught up!"}),r.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["No ",c==="all"?"new":c," notifications."]})]}):r.jsx("div",{className:"divide-y divide-gray-100",children:y.map(g=>{var C;return r.jsxs("div",{className:`p-4 transition-all relative group cursor-pointer 
                                            ${g.read?"bg-gray-50 hover:bg-gray-100":"bg-white hover:bg-blue-50/30"}
                                            ${g.type==="critical"&&!g.read?"border-l-4 border-red-500 pl-3":"border-l-4 border-transparent pl-3"}
                                        `,onClick:()=>t(g.id),children:[r.jsxs("div",{className:"flex gap-3",children:[p(g.type),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex justify-between items-start mb-0.5",children:[r.jsx("h4",{className:`text-sm font-bold truncate pr-6 ${g.type==="critical"?"text-red-700":g.read?"text-gray-600":"text-gray-900"}`,children:g.title}),r.jsx("span",{className:"text-[10px] text-gray-400 whitespace-nowrap font-medium",children:L(g.timestamp)})]}),r.jsx("p",{className:`text-xs leading-relaxed mb-1.5 line-clamp-2 ${g.read?"text-gray-500":"text-gray-700"}`,children:g.message}),r.jsxs("div",{className:"flex items-center gap-2",children:[g.module&&r.jsx("span",{className:"inline-block px-1.5 py-0.5 rounded text-[9px] font-bold uppercase tracking-wider bg-slate-200 text-slate-600",children:g.module}),!g.read&&r.jsx("span",{className:"text-[9px] font-bold text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded",children:"NEW"})]}),g.actionLink&&g.actionLink.startsWith("request:start_inspection")&&r.jsx("div",{className:"mt-3 flex items-center justify-start",children:r.jsxs("button",{onClick:R=>m(R,g.id),className:"flex items-center gap-1.5 px-4 py-2 rounded-lg text-xs font-bold bg-indigo-600 hover:bg-indigo-700 text-white transition-all shadow-md active:scale-95 w-full justify-center sm:w-auto",children:[r.jsxs("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),"Start Inspection"]})}),(g.type==="critical"||g.type==="warning")&&o&&l&&!((C=g.actionLink)!=null&&C.startsWith("request:"))&&r.jsx("div",{className:"mt-3 flex items-center justify-start",children:r.jsx("button",{onClick:R=>f(R,g.id),disabled:v===g.id,className:`flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs font-bold transition-all
                                                                ${v===g.id?"bg-gray-100 text-gray-400":"bg-green-50 text-green-700 hover:bg-green-100 border border-green-200 shadow-sm"}
                                                            `,children:v===g.id?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"animate-spin w-3 h-3",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Resolving..."]}):r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),"Acknowledge & Resolve"]})})})]})]}),r.jsx("button",{onClick:R=>{R.stopPropagation(),n(g.id)},className:"absolute top-2 right-2 p-1.5 text-gray-300 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-all opacity-0 group-hover:opacity-100",title:"Dismiss locally",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]},g.id)})})})]})]})},Cm=({featureName:e,onClose:t})=>e?r.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-sm animate-fadeIn",children:r.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-2xl overflow-hidden relative",children:[r.jsx("div",{className:"h-2 bg-gradient-to-r from-amber-400 via-yellow-500 to-amber-600"}),r.jsxs("div",{className:"p-8 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-amber-50 rounded-full flex items-center justify-center mx-auto mb-6 border border-amber-100 shadow-sm",children:r.jsx("svg",{className:"w-8 h-8 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),r.jsx("h3",{className:"text-xl font-black text-slate-800 mb-2 uppercase tracking-tight",children:"Module Locked"}),r.jsx("div",{className:"inline-block px-3 py-1 bg-slate-100 text-slate-600 font-bold text-xs rounded-full mb-6 border border-slate-200",children:e}),r.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed mb-6",children:["This advanced Operations feature is part of the ",r.jsx("strong",{children:"Enterprise Suite"}),". To access the ",r.jsx("span",{className:"font-semibold text-gray-800",children:e}),", your organization requires a system upgrade."]}),r.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-100 text-left mb-6",children:[r.jsx("h4",{className:"text-xs font-bold text-blue-800 uppercase mb-2",children:"Features Included in Upgrade:"}),r.jsxs("ul",{className:"text-xs text-blue-700 space-y-1.5 list-disc pl-4",children:[r.jsx("li",{children:"Real-time Journey Tracking"}),r.jsx("li",{children:"Digital Fuel Reconciliation"}),r.jsx("li",{children:"Automated Gate Pass Generation"}),r.jsx("li",{children:"Driver Performance Analytics"})]})]}),r.jsx("button",{onClick:t,className:"w-full py-3 bg-slate-900 hover:bg-slate-800 text-white font-bold rounded-xl transition-all shadow-lg shadow-slate-200",children:"Acknowledge"}),r.jsx("p",{className:"mt-4 text-[10px] text-gray-400",children:"Contact your System Administrator for access rights."})]})]})}):null,Lm=({isOpen:e,onClose:t,onStartNew:n,onResume:s,hasDraft:l,moduleName:o})=>e?r.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-slate-900/70 backdrop-blur-sm animate-fadeIn",children:r.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-2xl overflow-hidden transform transition-all scale-100",children:[r.jsxs("div",{className:"bg-gradient-to-r from-emerald-900 to-emerald-800 p-6 text-white",children:[r.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[r.jsx("svg",{className:"w-6 h-6 text-emerald-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Start ",o," Inspection"]}),r.jsx("p",{className:"text-emerald-100 text-sm mt-1",children:"Select how you would like to proceed."})]}),r.jsxs("div",{className:"p-6 space-y-4",children:[l&&r.jsxs("div",{className:"bg-amber-50 border border-amber-100 rounded-xl p-4 mb-2",children:[r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-amber-100 text-amber-600 flex items-center justify-center shrink-0 mt-1",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-bold text-amber-800 text-sm",children:"Unsaved Draft Found"}),r.jsx("p",{className:"text-xs text-amber-700 mt-0.5",children:"You have an inspection in progress. Would you like to continue where you left off?"})]})]}),r.jsx("button",{onClick:s,className:"w-full mt-3 py-3 bg-amber-500 hover:bg-amber-600 text-white font-bold rounded-lg shadow-md transition flex items-center justify-center gap-2",children:"Resume Draft"})]}),r.jsxs("button",{onClick:n,className:"w-full py-4 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition flex items-center justify-center gap-3 group",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-emerald-500/50 flex items-center justify-center group-hover:scale-110 transition-transform",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})})}),r.jsxs("div",{className:"text-left",children:[r.jsx("div",{className:"text-sm font-black uppercase tracking-wide",children:"Start New Inspection"}),l&&r.jsx("div",{className:"text-[10px] font-medium text-emerald-100 opacity-80",children:"This will discard the current draft"})]})]}),r.jsx("button",{onClick:t,className:"w-full py-3 bg-white border border-gray-200 text-gray-500 hover:bg-gray-50 hover:text-gray-700 font-bold rounded-xl transition",children:"Cancel"})]})]})}):null,Em=({subscription:e,user:t,onManage:n})=>{if(!e||!t)return null;const s=t.role==="SuperAdmin",l=e.status==="Expired",o=e.status==="Active"&&e.daysRemaining<=7;return!l&&!o?null:r.jsxs("div",{className:`w-full px-4 py-3 flex items-center justify-between shadow-md relative z-[100] animate-fadeIn
            ${l?"bg-red-600 text-white":"bg-amber-500 text-white"}
        `,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-1.5 bg-white/20 rounded-full",children:l?r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}):r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-bold uppercase tracking-wide",children:l?"System License Expired":"License Expiring Soon"}),r.jsx("p",{className:"text-xs font-medium opacity-90",children:l?"Access to core features is restricted. Contact Administrator.":`${e.daysRemaining} days remaining. Please renew soon.`})]})]}),s&&r.jsx("button",{onClick:n,className:"px-4 py-2 bg-white text-gray-900 rounded-lg text-xs font-bold uppercase tracking-wider hover:bg-gray-100 transition-colors shadow-sm",children:"Manage License"})]})},Im=({isActive:e,message:t,onLogout:n})=>e?r.jsxs("div",{className:"fixed inset-0 z-[200] bg-slate-900/95 backdrop-blur-lg flex flex-col items-center justify-center p-6 text-center animate-fadeIn select-none",children:[r.jsx("div",{className:"relative mb-10",children:r.jsxs("div",{className:"w-28 h-28 bg-gradient-to-br from-slate-800 to-slate-900 rounded-full flex items-center justify-center shadow-[0_0_40px_rgba(245,158,11,0.2)] border border-slate-700",children:[r.jsx("div",{className:"absolute inset-0 rounded-full border border-amber-500/20 animate-[ping_3s_cubic-bezier(0,0,0.2,1)_infinite]"}),r.jsx("svg",{className:"w-14 h-14 text-amber-500 relative z-10 drop-shadow-md",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})]})}),r.jsx("h1",{className:"text-3xl md:text-5xl font-black text-white mb-6 tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-white to-slate-400",children:"System Under Maintenance"}),r.jsxs("div",{className:"max-w-lg w-full bg-slate-800/50 backdrop-blur-md border border-slate-700/50 p-8 rounded-3xl shadow-2xl relative overflow-hidden",children:[r.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-amber-500 via-orange-500 to-amber-500 opacity-50"}),r.jsx("p",{className:"text-lg text-slate-300 font-medium leading-relaxed font-light",children:t||"We are currently performing scheduled maintenance to improve system performance and security. Access is temporarily restricted."}),r.jsx("div",{className:"mt-8 flex flex-col items-center justify-center gap-4",children:r.jsxs("div",{className:"text-slate-500 text-xs font-mono flex items-center gap-2 bg-slate-900/50 px-4 py-2 rounded-full border border-slate-800",children:[r.jsx("span",{className:"w-2 h-2 rounded-full bg-amber-500 animate-pulse shadow-[0_0_8px_rgba(245,158,11,0.6)]"}),"Status: Lockdown Active"]})})]}),r.jsxs("div",{className:"mt-12 flex gap-4",children:[r.jsxs("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-slate-800 hover:bg-slate-700 text-slate-300 rounded-xl font-bold text-sm transition-all border border-slate-700 hover:border-slate-600 flex items-center gap-2",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Check Status"]}),n&&r.jsxs("button",{onClick:n,className:"px-6 py-3 bg-transparent hover:bg-white/5 text-slate-400 hover:text-white rounded-xl font-bold text-sm transition-all border border-transparent hover:border-white/10 flex items-center gap-2",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H5a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Sign Out"]})]}),r.jsx("p",{className:"mt-8 text-slate-600 text-xs font-medium max-w-xs mx-auto",children:"Please try again later. If this persists, contact your System Administrator."})]}):null,Rm=({isOpen:e,onClose:t,onSubmit:n,validationLists:s,currentUserRole:l})=>{if(!e)return null;const[o,i]=j.useState(""),[a,c]=j.useState(""),[d,v]=j.useState("General"),[u,h]=j.useState("Normal"),[x,b]=j.useState(""),[y,L]=j.useState(""),[p,f]=j.useState(!1),[m,g]=j.useState({}),[C,R]=j.useState(!1),[N,k]=j.useState(!1),[I,E]=j.useState(!1);j.useEffect(()=>{R(!!o)},[o]),j.useEffect(()=>{k(!!a)},[a]),j.useEffect(()=>{E(!!y)},[y]);const w=async P=>{P.preventDefault();const M={};if(o||(M.truckNo="Please select a truck."),x.trim()||(M.reason="Please provide a reason or instruction."),Object.keys(M).length>0){g(M);return}f(!0);try{await n({truckNo:o,trailerNo:a,type:d,priority:u,reason:x,assignedInspector:y}),t()}finally{f(!1)}},S=({label:P,value:M,onChange:U,options:Y,placeholder:Q="Select...",error:_,isVerified:W,isOptional:B=!1})=>{const[H,F]=j.useState(!1),[$,X]=j.useState(""),G=j.useRef(null);j.useEffect(()=>{function D(K){G.current&&!G.current.contains(K.target)&&F(!1)}return document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[G]),j.useEffect(()=>{H&&X("")},[H]);const ie=Y.filter(D=>String(D).toLowerCase().includes($.toLowerCase()));return r.jsxs("div",{className:"relative group",ref:G,children:[r.jsxs("label",{className:"block text-[10px] font-bold text-gray-500 uppercase mb-1 tracking-wide",children:[P," ",B&&r.jsx("span",{className:"text-gray-400 font-normal normal-case",children:"(Optional)"})]}),r.jsxs("div",{onClick:()=>{Y.length>0&&F(!H)},className:`relative w-full p-2.5 bg-gray-50 border rounded-lg outline-none text-xs font-bold text-gray-700 transition-all cursor-pointer flex items-center justify-between
                        ${_?"border-red-300 ring-1 ring-red-200 bg-red-50 text-red-900":H?"border-indigo-500 ring-2 ring-indigo-500/20 bg-white":"border-gray-200 hover:bg-white hover:border-gray-300"}
                        ${Y.length===0?"opacity-70 cursor-not-allowed":""}
                    `,children:[r.jsx("span",{className:`truncate mr-6 ${!M&&"text-gray-400 font-medium"}`,children:M||(Y.length===0?"Loading / No Data...":Q)}),r.jsxs("div",{className:"absolute right-2.5 flex items-center gap-2 pointer-events-none",children:[W&&M&&!_&&r.jsxs("span",{className:"text-[9px] font-bold text-green-600 bg-green-50 px-1.5 py-0.5 rounded border border-green-200 flex items-center gap-1",children:[r.jsx("svg",{className:"w-2.5 h-2.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),"VERIFIED"]}),r.jsx("svg",{className:`w-4 h-4 text-gray-400 transition-transform ${H?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]})]}),H&&Y.length>0&&r.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-xl overflow-hidden animate-fadeIn flex flex-col max-h-56",children:[r.jsx("div",{className:"p-2 border-b border-gray-100 bg-gray-50 sticky top-0 shrink-0",children:r.jsxs("div",{className:"relative",children:[r.jsx("svg",{className:"w-3.5 h-3.5 absolute left-2.5 top-1/2 -translate-y-1/2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),r.jsx("input",{type:"text",autoFocus:!0,className:"w-full pl-8 pr-3 py-1.5 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 placeholder-gray-400",placeholder:"Search options...",value:$,onChange:D=>X(D.target.value),onClick:D=>D.stopPropagation()})]})}),r.jsx("div",{className:"overflow-y-auto scrollbar-thin scrollbar-thumb-gray-200 flex-1",children:ie.length===0?r.jsx("div",{className:"p-3 text-center text-xs text-gray-400 italic",children:"No matches found"}):ie.map((D,K)=>r.jsxs("div",{onClick:()=>{U(D),F(!1)},className:`px-3 py-2 text-xs cursor-pointer transition-colors flex items-center justify-between border-b border-gray-50 last:border-0 ${M===D?"bg-indigo-50 text-indigo-700 font-bold":"text-gray-700 hover:bg-gray-50"}`,children:[D,M===D&&r.jsx("svg",{className:"w-3 h-3 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]},K))})]}),_&&r.jsx("p",{className:"text-[9px] text-red-600 font-bold mt-0.5 ml-0.5",children:_})]})};return r.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-sm animate-fadeIn",children:r.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-2xl overflow-hidden transform transition-all scale-100 border border-slate-200",children:[r.jsxs("div",{className:"bg-indigo-600 px-5 py-3 flex justify-between items-center shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-8 h-8 bg-indigo-500 rounded-lg flex items-center justify-center shadow-inner text-white",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-base font-bold text-white tracking-wide leading-tight",children:"Request Inspection"}),r.jsx("p",{className:"text-indigo-200 text-[10px] font-medium",children:"Submit vehicle for ad-hoc check"})]})]}),r.jsx("button",{onClick:t,className:"text-indigo-200 hover:text-white p-1 rounded-full hover:bg-indigo-500 transition-colors",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsx("div",{className:"p-5",children:r.jsxs("form",{onSubmit:w,className:"space-y-4",children:[r.jsxs("div",{className:"p-2.5 bg-blue-50 rounded-lg border border-blue-100 flex items-center gap-2.5",children:[r.jsx("svg",{className:"w-4 h-4 text-blue-600 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("p",{className:"text-[10px] text-blue-800 font-medium leading-tight",children:"Select vehicles from the database using the search below."})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(S,{label:"Truck Reg No *",value:o,onChange:P=>{i(P),g(M=>({...M,truckNo:""}))},options:s.trucks,placeholder:"Select Truck...",error:m.truckNo,isVerified:C}),r.jsx(S,{label:"Trailer Reg No",value:a,onChange:P=>{c(P),g(M=>({...M,trailerNo:""}))},options:s.trailers,placeholder:"Optional...",isVerified:N,isOptional:!0})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(S,{label:"Inspection Type",value:d,onChange:v,options:["General","Petroleum","Petroleum_V2","Acid"],placeholder:"Select Type..."}),r.jsx(S,{label:"Priority",value:u,onChange:h,options:["Normal","Urgent","Safety Concern"],placeholder:"Select Priority..."})]}),r.jsx(S,{label:"Assign Inspector",value:y,onChange:P=>{L(P),g(M=>({...M,inspector:""}))},options:s.inspectors,placeholder:"Select an Inspector (Optional)...",isVerified:I,isOptional:!0}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-bold text-gray-500 uppercase mb-1 tracking-wide",children:"Reason / Instructions *"}),r.jsx("textarea",{className:`w-full p-2.5 bg-gray-50 border rounded-lg outline-none focus:ring-2 focus:ring-indigo-500 text-xs font-medium h-20 placeholder-gray-400 resize-none
                                    ${m.reason?"border-red-300 ring-1 ring-red-200":"border-gray-200"}
                                `,placeholder:"e.g. Driver reported strange brake noise.",value:x,onChange:P=>{b(P.target.value),g(M=>({...M,reason:""}))},required:!0}),m.reason&&r.jsx("p",{className:"text-[9px] text-red-600 font-bold mt-0.5 ml-0.5",children:m.reason})]}),r.jsx("div",{className:"pt-2 flex justify-end",children:r.jsx("button",{type:"submit",disabled:p,className:`px-5 py-2.5 rounded-lg font-bold text-white shadow-md transition-all flex items-center gap-2 text-xs
                                    ${p?"bg-indigo-400 cursor-wait":"bg-indigo-600 hover:bg-indigo-700 hover:scale-105 active:scale-95"}
                                `,children:p?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"animate-spin w-3.5 h-3.5 text-white",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Sending..."]}):"Submit Request"})})]})})]})})},_m=({user:e,appScriptUrl:t,onComplete:n})=>{const[s,l]=j.useState(1),[o,i]=j.useState(!1),[a,c]=j.useState(""),[d,v]=j.useState(""),[u,h]=j.useState(""),[x,b]=j.useState({notifyGeneral:!0,notifyPetroleum:!0,notifyPetroleumV2:!0,notifyAcid:!0,emailNotifications:!0}),y=async m=>{if(m.preventDefault(),a.length<4){h("Minimum 4 characters required.");return}if(a!==d){h("Passwords do not match.");return}i(!0);try{await fetch(t,{method:"POST",body:JSON.stringify({action:"update_user",originalUsername:e.username,password:a,preferences:{...e.preferences,mustChangePassword:!1}}),mode:"no-cors"}),setTimeout(()=>{l(2),i(!1)},1e3)}catch{h("Connection failed. Try again."),i(!1)}},L=async()=>{i(!0);try{const m={...e.preferences,...x,mustChangePassword:!1,isEmailVerified:!0};await fetch(t,{method:"POST",body:JSON.stringify({action:"update_user",originalUsername:e.username,preferences:m}),mode:"no-cors"}),e.preferences=m,l(3)}catch{l(3)}finally{i(!1)}},p=()=>{n({...e,preferences:{...e.preferences,hasCompletedTour:!1}})},f=m=>{b(g=>({...g,[m]:!g[m]}))};return r.jsx("div",{className:"fixed inset-0 z-[100] bg-slate-900/95 flex items-center justify-center p-4 animate-fadeIn",children:r.jsxs("div",{className:"max-w-4xl w-full bg-white rounded-2xl shadow-2xl overflow-hidden flex flex-col md:flex-row min-h-[600px]",children:[r.jsxs("div",{className:"md:w-5/12 bg-slate-800 p-8 flex flex-col justify-between text-white relative overflow-hidden",children:[r.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-b from-indigo-900 to-slate-900 opacity-90"}),r.jsx("div",{className:"absolute -top-24 -right-24 w-64 h-64 bg-indigo-500/30 rounded-full blur-3xl"}),r.jsxs("div",{className:"relative z-10",children:[r.jsx("div",{className:"w-12 h-12 bg-indigo-500 rounded-xl flex items-center justify-center mb-6 shadow-lg shadow-indigo-900/50",children:r.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),r.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Account Setup"}),r.jsx("p",{className:"text-slate-300 text-sm leading-relaxed",children:"Complete these steps to secure your account and configure your inspection workspace."})]}),r.jsxs("div",{className:"relative z-10 space-y-6",children:[r.jsxs("div",{className:`flex items-center gap-4 transition-opacity duration-300 ${s>=1?"opacity-100":"opacity-40"}`,children:[r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border-2 ${s>1?"bg-green-500 border-green-500 text-white":"border-slate-400 text-slate-300"} font-bold text-sm`,children:s>1?"":"1"}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"font-bold text-sm",children:"Security"}),r.jsx("span",{className:"text-xs text-slate-400",children:"Change Password"})]})]}),r.jsxs("div",{className:`flex items-center gap-4 transition-opacity duration-300 ${s>=2?"opacity-100":"opacity-40"}`,children:[r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border-2 ${s>2?"bg-green-500 border-green-500 text-white":"border-slate-400 text-slate-300"} font-bold text-sm`,children:s>2?"":"2"}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"font-bold text-sm",children:"Notifications"}),r.jsx("span",{className:"text-xs text-slate-400",children:"Email Activation"})]})]}),r.jsxs("div",{className:`flex items-center gap-4 transition-opacity duration-300 ${s>=3?"opacity-100":"opacity-40"}`,children:[r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border-2 ${s>=3?"bg-white border-white text-slate-900":"border-slate-400 text-slate-300"} font-bold text-sm`,children:"3"}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"font-bold text-sm",children:"Completion"}),r.jsx("span",{className:"text-xs text-slate-400",children:"Ready to go"})]})]})]})]}),r.jsxs("div",{className:"md:w-7/12 p-8 md:p-12 bg-white relative overflow-y-auto",children:[s===1&&r.jsxs("div",{className:"h-full flex flex-col justify-center animate-fadeIn",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Secure Your Account"}),r.jsx("p",{className:"text-slate-500 text-sm mb-8",children:"Please set a new, permanent password to continue."}),r.jsxs("form",{onSubmit:y,className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-2",children:"New Password"}),r.jsx("input",{type:"password",className:"w-full p-4 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition font-bold text-slate-800",value:a,onChange:m=>c(m.target.value),placeholder:"",autoFocus:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-2",children:"Confirm Password"}),r.jsx("input",{type:"password",className:"w-full p-4 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition font-bold text-slate-800",value:d,onChange:m=>v(m.target.value),placeholder:""})]}),u&&r.jsxs("div",{className:"text-red-600 text-xs font-bold bg-red-50 p-3 rounded-lg flex items-center gap-2 border border-red-100",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),u]}),r.jsx("button",{type:"submit",disabled:o,className:"w-full py-4 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl shadow-lg shadow-indigo-200 transition-all flex items-center justify-center gap-2 disabled:bg-indigo-300",children:o?"Saving...":"Set Password"})]})]}),s===2&&r.jsxs("div",{className:"h-full flex flex-col justify-center animate-fadeIn",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Notification Preferences"}),r.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Activate email alerts for the specific inspections relevant to your role."}),r.jsxs("div",{className:"bg-indigo-50/50 p-4 rounded-xl border border-indigo-100 mb-6 flex items-center gap-3",children:[r.jsx("div",{className:"w-8 h-8 bg-white rounded-full flex items-center justify-center text-indigo-600 shadow-sm border border-indigo-100",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-bold text-indigo-900 uppercase",children:"Alert Destination"}),r.jsx("p",{className:"text-sm font-medium text-slate-700 truncate",children:e.username})]})]}),r.jsxs("div",{className:"space-y-3 mb-8",children:[r.jsxs("label",{className:`flex items-center justify-between p-3 rounded-xl border cursor-pointer transition-all ${x.notifyGeneral?"bg-blue-50 border-blue-200":"bg-white border-slate-200"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${x.notifyGeneral?"bg-blue-600 text-white":"bg-slate-100 text-slate-400"}`,children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsx("span",{className:`text-sm font-bold ${x.notifyGeneral?"text-blue-900":"text-slate-500"}`,children:"General Inspections"})]}),r.jsx("input",{type:"checkbox",className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500",checked:x.notifyGeneral,onChange:()=>f("notifyGeneral")})]}),r.jsxs("label",{className:`flex items-center justify-between p-3 rounded-xl border cursor-pointer transition-all ${x.notifyPetroleum?"bg-orange-50 border-orange-200":"bg-white border-slate-200"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${x.notifyPetroleum?"bg-orange-600 text-white":"bg-slate-100 text-slate-400"}`,children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),r.jsx("span",{className:`text-sm font-bold ${x.notifyPetroleum?"text-orange-900":"text-slate-500"}`,children:"Petroleum Tanker V1"})]}),r.jsx("input",{type:"checkbox",className:"w-5 h-5 text-orange-600 rounded focus:ring-orange-500",checked:x.notifyPetroleum,onChange:()=>f("notifyPetroleum")})]}),r.jsxs("label",{className:`flex items-center justify-between p-3 rounded-xl border cursor-pointer transition-all ${x.notifyPetroleumV2?"bg-red-50 border-red-200":"bg-white border-slate-200"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${x.notifyPetroleumV2?"bg-red-600 text-white":"bg-slate-100 text-slate-400"}`,children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),r.jsx("span",{className:`text-sm font-bold ${x.notifyPetroleumV2?"text-red-900":"text-slate-500"}`,children:"Petroleum Tanker V2"})]}),r.jsx("input",{type:"checkbox",className:"w-5 h-5 text-red-600 rounded focus:ring-red-500",checked:x.notifyPetroleumV2,onChange:()=>f("notifyPetroleumV2")})]}),r.jsxs("label",{className:`flex items-center justify-between p-3 rounded-xl border cursor-pointer transition-all ${x.notifyAcid?"bg-purple-50 border-purple-200":"bg-white border-slate-200"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${x.notifyAcid?"bg-purple-600 text-white":"bg-slate-100 text-slate-400"}`,children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),r.jsx("span",{className:`text-sm font-bold ${x.notifyAcid?"text-purple-900":"text-slate-500"}`,children:"Acid Tanker"})]}),r.jsx("input",{type:"checkbox",className:"w-5 h-5 text-purple-600 rounded focus:ring-purple-500",checked:x.notifyAcid,onChange:()=>f("notifyAcid")})]})]}),r.jsx("button",{onClick:L,disabled:o,className:"w-full py-4 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl shadow-lg transition-all flex items-center justify-center gap-2",children:o?"Activating...":"Activate Selected Notifications"})]}),s===3&&r.jsxs("div",{className:"h-full flex flex-col justify-center items-center text-center animate-fadeIn",children:[r.jsx("div",{className:"w-24 h-24 bg-green-50 rounded-full flex items-center justify-center mb-6 shadow-sm border border-green-100",children:r.jsx("svg",{className:"w-12 h-12 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),r.jsx("h2",{className:"text-3xl font-black text-slate-800 mb-2",children:"You're All Set!"}),r.jsx("p",{className:"text-slate-500 text-sm mb-8 max-w-sm leading-relaxed",children:"Your account is secure and notifications are active. We'll now give you a quick tour of the features."}),r.jsxs("div",{className:"bg-indigo-50 border border-indigo-100 p-4 rounded-xl mb-8 w-full max-w-sm text-left flex items-start gap-4",children:[r.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg text-indigo-700 shrink-0",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z"})})}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-bold text-indigo-900",children:"Need Assistance?"}),r.jsxs("p",{className:"text-xs text-indigo-700 mt-1",children:["If you ever need help or want to report an issue, use the ",r.jsx("strong",{children:"Help & Support"})," tab in the main menu."]})]})]}),r.jsxs("button",{onClick:p,className:"w-full max-w-xs py-4 bg-slate-900 hover:bg-slate-800 text-white font-bold rounded-xl shadow-lg transition-all flex items-center justify-center gap-2 group",children:["Start System Tour",r.jsx("svg",{className:"w-4 h-4 group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})]})]})]})})},mr=[{targetId:"sidebar-toggle",title:"Navigation Menu",description:"Access all inspection modules (Petroleum, Acid, General), settings, and support from here.",position:"top-left"},{targetId:"start-inspection-btn",title:"Start Inspection",description:"Click here to begin a new vehicle check. The system will guide you through all required steps.",position:"center"},{targetId:"notification-bell",title:"Alerts Center",description:"Stay updated with critical vehicle failures and system broadcasts.",position:"top-right"},{targetId:"sync-status-btn",title:"Offline Sync",description:"Works offline! When internet is restored, click here to sync pending reports.",position:"top-right"},{targetId:"support",title:"Help & Support",description:"Need assistance? Report issues, request features, or contact admins here.",position:"bottom-left"}],Tm=({onComplete:e})=>{const[t,n]=j.useState(0),[s,l]=j.useState({}),[o,i]=j.useState({});j.useEffect(()=>{const d=()=>{const u=mr[t],h=document.getElementById(u.targetId);if(h){const x=h.getBoundingClientRect();l({position:"fixed",top:x.top,left:x.left,width:x.width,height:x.height,borderRadius:"8px",boxShadow:"0 0 0 9999px rgba(15, 23, 42, 0.75)",zIndex:100,pointerEvents:"none",transition:"all 0.4s ease-out"});const b=320;let y=x.bottom+15,L=x.left;u.position==="top-right"?L=Math.max(10,x.right-b):u.position==="bottom-left"&&y+200>window.innerHeight&&(y=x.top-200),L+b>window.innerWidth&&(L=window.innerWidth-b-20),L<10&&(L=10),i({position:"fixed",top:y,left:L,zIndex:101,transition:"all 0.4s ease-out"})}else l({display:"none"}),i({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:101})},v=setTimeout(d,100);return window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d),clearTimeout(v)}},[t]);const a=()=>{t<mr.length-1?n(d=>d+1):e()},c=mr[t];return r.jsxs("div",{className:"fixed inset-0 z-[200]",children:[r.jsx("div",{style:s,className:"ring-4 ring-white/20 animate-pulse"}),r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 w-80 animate-fadeIn border border-slate-100",style:o,children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsxs("span",{className:"text-[10px] font-bold text-white bg-indigo-600 px-2 py-1 rounded uppercase tracking-wide shadow-sm",children:["Tip ",t+1," / ",mr.length]}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors p-1 hover:bg-gray-100 rounded",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-2",children:c.title}),r.jsx("p",{className:"text-sm text-slate-600 leading-relaxed mb-6 font-medium",children:c.description}),r.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-slate-100",children:[r.jsx("div",{className:"flex gap-1.5",children:mr.map((d,v)=>r.jsx("div",{className:`w-2 h-2 rounded-full transition-all duration-300 ${v===t?"bg-indigo-600 w-4":"bg-gray-200"}`},v))}),r.jsxs("button",{onClick:a,className:"px-5 py-2.5 bg-slate-900 hover:bg-slate-800 text-white text-xs font-bold rounded-xl shadow-lg transition-transform active:scale-95 flex items-center gap-2",children:[t===mr.length-1?"Finish":"Next",r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})]})]})]})]})},Xa=()=>{const[e,t]=j.useState(null),[n,s]=j.useState(!1),[l,o]=j.useState(!1);j.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)return;const d=localStorage.getItem("sc_install_dismissed");if(d){const h=new Date(parseInt(d)),b=Math.abs(new Date().getTime()-h.getTime());if(Math.ceil(b/(1e3*60*60*24))<7)return}const v=window.navigator.userAgent.toLowerCase(),u=/iphone|ipad|ipod/.test(v);if(o(u),u)setTimeout(()=>s(!0),3e3);else{const h=x=>{x.preventDefault(),t(x),s(!0)};return window.addEventListener("beforeinstallprompt",h),()=>{window.removeEventListener("beforeinstallprompt",h)}}},[]);const i=async()=>{if(!e)return;e.prompt();const{outcome:c}=await e.userChoice;c==="accepted"&&s(!1),t(null)},a=()=>{s(!1),localStorage.setItem("sc_install_dismissed",Date.now().toString())};return n?r.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-[9999] md:left-auto md:right-4 md:w-96 animate-fadeIn",children:r.jsxs("div",{className:"bg-slate-900/95 backdrop-blur-md text-white p-4 rounded-2xl shadow-2xl border border-slate-700 flex flex-col gap-4",children:[r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:"bg-white/10 p-2.5 rounded-xl shrink-0",children:r.jsx("img",{src:"https://cdn-icons-png.flaticon.com/512/716/716766.png",alt:"Logo",className:"w-8 h-8 object-contain"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h4",{className:"font-bold text-sm",children:"Install SafetyCheck Pro"}),r.jsx("p",{className:"text-xs text-slate-300 mt-1 leading-relaxed",children:"Add to your home screen for offline access, full-screen view, and faster performance."})]}),r.jsx("button",{onClick:a,className:"text-slate-400 hover:text-white p-1",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),l?r.jsxs("div",{className:"bg-white/10 rounded-lg p-3 text-xs text-slate-300 flex items-center gap-3",children:[r.jsx("span",{className:"text-xl",children:""}),r.jsxs("span",{children:["Tap the ",r.jsx("span",{className:"font-bold text-white",children:"Share"})," button below and select ",r.jsx("span",{className:"font-bold text-white",children:'"Add to Home Screen"'})," [+]"]})]}):r.jsxs("button",{onClick:i,className:"w-full py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl text-sm transition-colors shadow-lg flex items-center justify-center gap-2",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Install App"]})]})}):null},Am=({onLogin:e,appScriptUrl:t,setAppScriptUrl:n,settings:s})=>{const[l,o]=j.useState(""),[i,a]=j.useState(""),[c,d]=j.useState(!1),[v,u]=j.useState(""),[h,x]=j.useState(!t),[b,y]=j.useState(!1),[L,p]=j.useState(!1),[f,m]=j.useState(""),[g,C]=j.useState(""),[R,N]=j.useState(!1),[k,I]=j.useState(!1),E=async S=>{if(S.preventDefault(),!t){u("System Database URL is missing."),x(!0);return}u(""),d(!0);try{const U=await(await fetch(t,{method:"POST",body:JSON.stringify(L?{action:"register_user",username:l,password:i,name:f,position:g,role:"SuperAdmin"}:{action:"login",username:l,password:i})})).json();if(U.status==="success")if(L)u("System Owner (SuperAdmin) created! Please log in."),p(!1),m(""),C(""),a("");else{const Y=U.user;let Q="Inspector";const _=Y.role?String(Y.role).trim().toLowerCase():"";_==="superadmin"?Q="SuperAdmin":_==="admin"?Q="Admin":_==="operations"?Q="Operations":_==="maintenance"?Q="Maintenance":_==="secretary"?Q="Secretary":_==="other"?Q="Other":Q="Inspector";const W={...Y,role:Q,position:Y.position||""};e(W)}else U.code==="NO_USERS"?(u("New Database detected. Create the System Owner account."),p(!0)):u(U.message||"Authentication failed.")}catch(P){console.error("Login Error",P),u("Connection failed. Check internet or Settings.")}finally{d(!1)}},w=()=>{navigator.clipboard.writeText(Ao),N(!0),setTimeout(()=>N(!1),2e3)};return r.jsxs("div",{className:"min-h-screen w-full bg-white flex items-center justify-center p-4 font-sans text-slate-600 relative overflow-hidden",children:[r.jsx("div",{className:"absolute top-[-20%] left-[-10%] w-[60%] h-[60%] bg-blue-50/60 blur-[100px] rounded-full pointer-events-none"}),r.jsx("div",{className:"absolute bottom-[-20%] right-[-10%] w-[60%] h-[60%] bg-emerald-50/60 blur-[100px] rounded-full pointer-events-none"}),r.jsxs("div",{className:"w-full max-w-[420px] relative z-10 flex flex-col items-center",children:[r.jsxs("div",{className:"text-center mb-8 w-full animate-fadeIn",children:[r.jsx("div",{className:"w-auto h-28 mx-auto mb-6 flex items-center justify-center p-2 transition-transform duration-300 hover:scale-105",children:s.companyLogo&&!k?r.jsx("img",{src:s.companyLogo,alt:"Logo",className:"w-full h-full object-contain",onError:()=>I(!0)}):r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("svg",{className:"w-16 h-16 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),r.jsx("span",{className:"text-2xl font-black text-slate-900 tracking-tight mt-2",children:"JUBA"})]})}),r.jsx("h1",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:s.companyName||"SafetyCheck Pro"}),r.jsx("p",{className:"text-sm font-medium text-slate-500 mt-1",children:"Professional Fleet Inspection Portal"})]}),r.jsxs("div",{className:"w-full bg-white p-2",children:[r.jsxs("form",{onSubmit:E,className:"space-y-6",children:[v&&r.jsxs("div",{className:`p-4 rounded-lg text-xs font-bold flex items-center gap-3 border animate-fadeIn ${v.includes("created")||v.includes("success")?"bg-green-50 text-green-700 border-green-200":"bg-red-50 text-red-700 border-red-200"}`,children:[r.jsx("div",{className:`w-2 h-2 rounded-full shrink-0 ${v.includes("created")?"bg-green-500":"bg-red-500"}`}),r.jsx("span",{className:"flex-1",children:v})]}),L&&r.jsxs("div",{className:"space-y-4 animate-fadeIn bg-slate-50 p-6 rounded-xl border border-slate-100 shadow-inner",children:[r.jsxs("div",{className:"flex items-center gap-2 border-b border-slate-200 pb-2 mb-3",children:[r.jsx("div",{className:"bg-amber-100 text-amber-700 p-1 rounded",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})})}),r.jsx("h3",{className:"text-xs font-black text-slate-700 uppercase tracking-wide",children:"System Owner Setup"})]}),r.jsx("p",{className:"text-[10px] text-slate-500 leading-tight",children:"You are creating the first account (SuperAdmin). You will have full access to settings and subscriptions."}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-2 pl-1",children:"Full Name"}),r.jsx("input",{type:"text",required:!0,className:"w-full px-4 py-3 bg-white border border-slate-300 rounded-lg focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500 outline-none transition-all text-slate-900 text-sm font-medium placeholder-slate-400",placeholder:"e.g. John Doe",value:f,onChange:S=>m(S.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-2 pl-1",children:"Position"}),r.jsx("input",{type:"text",required:!0,className:"w-full px-4 py-3 bg-white border border-slate-300 rounded-lg focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500 outline-none transition-all text-slate-900 text-sm font-medium placeholder-slate-400",placeholder:"e.g. Fleet Director",value:g,onChange:S=>C(S.target.value)})]})]}),r.jsxs("div",{className:"space-y-5",children:[r.jsxs("div",{className:"group",children:[r.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-2 pl-1 transition-colors group-focus-within:text-emerald-700",children:"Username"}),r.jsxs("div",{className:"relative",children:[r.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-emerald-600 transition-colors",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),r.jsx("input",{type:"text",required:!0,className:"w-full pl-12 pr-4 py-4 bg-slate-50 border border-slate-200 rounded-xl focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all text-slate-900 text-sm font-bold placeholder-slate-400 shadow-sm",placeholder:"Enter username",value:l,onChange:S=>o(S.target.value)})]})]}),r.jsxs("div",{className:"group",children:[r.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-2 pl-1 transition-colors group-focus-within:text-emerald-700",children:"Password"}),r.jsxs("div",{className:"relative",children:[r.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-emerald-600 transition-colors",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),r.jsx("input",{type:"password",required:!0,className:"w-full pl-12 pr-4 py-4 bg-slate-50 border border-slate-200 rounded-xl focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all text-slate-900 text-sm font-bold placeholder-slate-400 shadow-sm",placeholder:"",value:i,onChange:S=>a(S.target.value)})]})]})]}),r.jsx("div",{className:"pt-4",children:r.jsx("button",{type:"submit",disabled:c,className:`w-full py-4 rounded-xl font-bold text-white shadow-lg transition-all text-sm tracking-wide transform active:scale-[0.98] border border-transparent
                              ${c?"bg-slate-400 cursor-wait":L?"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 shadow-blue-200":"bg-gradient-to-r from-emerald-700 to-emerald-600 hover:from-emerald-600 hover:to-emerald-500 shadow-emerald-200"}
                          `,children:c?r.jsxs("div",{className:"flex items-center justify-center gap-2",children:[r.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r.jsx("span",{children:"VERIFYING..."})]}):L?"CREATE SYSTEM OWNER":"SECURE LOGIN"})}),L&&r.jsx("button",{type:"button",onClick:()=>p(!1),className:"w-full py-2 text-xs font-bold text-slate-500 hover:text-slate-800 uppercase tracking-wider transition-colors",children:"Cancel Registration"})]}),!t&&!L&&r.jsx("div",{className:"mt-12 text-center",children:r.jsxs("button",{type:"button",onClick:()=>x(!h),className:"group flex items-center justify-center gap-2 mx-auto px-4 py-2 rounded-full bg-slate-100 hover:bg-white border border-slate-200 hover:border-slate-300 shadow-sm transition-all",children:[r.jsx("span",{className:"w-2 h-2 rounded-full bg-amber-500 animate-pulse"}),r.jsx("span",{className:"text-[10px] text-slate-500 group-hover:text-slate-800 font-bold uppercase tracking-widest",children:"Connect Database"})]})})]}),h&&r.jsxs("div",{className:"w-full mt-6 bg-white border border-slate-200 p-6 rounded-2xl animate-fadeIn shadow-xl relative z-20",children:[r.jsxs("h4",{className:"text-[10px] font-black text-slate-400 mb-4 uppercase tracking-widest flex items-center gap-2",children:[r.jsxs("svg",{className:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Database Connection"]}),r.jsx("input",{type:"text",value:t,onChange:S=>n(S.target.value),placeholder:"https://script.google.com/macros/s/...",className:"w-full p-3 bg-slate-50 border border-slate-300 rounded-lg text-xs font-mono text-blue-600 mb-4 focus:outline-none focus:border-blue-500 shadow-inner"}),r.jsxs("button",{onClick:()=>y(!0),className:"w-full py-3 bg-slate-800 text-white text-xs font-bold rounded-lg hover:bg-slate-700 transition-colors shadow-sm flex items-center justify-center gap-2",children:[r.jsx("svg",{className:"w-4 h-4 text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"View Setup Instructions"]})]})]}),b&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/50 backdrop-blur-sm animate-fadeIn",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-3xl w-full flex flex-col max-h-[85vh] overflow-hidden border border-slate-200",children:[r.jsxs("div",{className:"p-5 bg-slate-50 flex justify-between items-center border-b border-slate-200",children:[r.jsx("h3",{className:"font-bold text-lg text-slate-800",children:"Backend Setup Guide"}),r.jsx("button",{onClick:()=>y(!1),className:"text-slate-400 hover:text-slate-700 transition p-2 hover:bg-slate-200 rounded-lg",children:""})]}),r.jsxs("div",{className:"p-8 overflow-y-auto bg-white",children:[r.jsx("div",{className:"prose prose-sm max-w-none text-slate-600 mb-6",children:r.jsxs("ol",{className:"list-decimal pl-4 space-y-2 font-medium",children:[r.jsxs("li",{children:["Create a new ",r.jsx("strong",{children:"Google Sheet"}),"."]}),r.jsxs("li",{children:["Go to ",r.jsx("strong",{children:"Extensions > Apps Script"}),"."]}),r.jsx("li",{children:"Paste the code below entirely, replacing any existing code."}),r.jsxs("li",{children:["Click ",r.jsx("strong",{children:"Deploy > New Deployment"}),"."]}),r.jsxs("li",{children:["Select type: ",r.jsx("strong",{children:"Web App"}),"."]}),r.jsxs("li",{children:['Set "Execute as" to ',r.jsx("strong",{children:"Me"}),"."]}),r.jsxs("li",{children:['Set "Who has access" to ',r.jsx("strong",{children:"Anyone"}),"."]}),r.jsx("li",{children:"Copy the resulting Web App URL and paste it into the login screen."})]})}),r.jsxs("div",{className:"relative group",children:[r.jsx("pre",{className:"bg-slate-900 p-6 rounded-xl text-[10px] font-mono text-emerald-400 overflow-x-auto border border-slate-800 shadow-inner h-64",children:Ao}),r.jsx("button",{onClick:w,className:"absolute top-4 right-4 px-4 py-2 bg-blue-600 text-white text-xs font-bold rounded-lg hover:bg-blue-500 shadow-lg transition-all transform active:scale-95",children:R?"COPIED!":"COPY CODE"})]})]})]})})]})},Pm=({settings:e,setSettings:t,appScriptUrl:n,setAppScriptUrl:s,handleSaveSettings:l,isSavingSettings:o,showToast:i,user:a})=>{const[c,d]=j.useState(!1),[v,u]=j.useState(!1),[h,x]=j.useState(!1),[b,y]=j.useState(!1),[L,p]=j.useState("1_Controller.gs");j.useEffect(()=>{y(!1)},[e.companyLogo]);const f=(a==null?void 0:a.role)==="SuperAdmin",m=f||(a==null?void 0:a.role)==="Admin",g=f,C=(E,w)=>{const S=new FileReader;S.onload=P=>{var U;const M=new Image;M.onload=()=>{const Y=document.createElement("canvas"),Q=Y.getContext("2d"),_=300,W=150;let B=M.width,H=M.height;if(B>H?B>_&&(H*=_/B,B=_):H>W&&(B*=W/H,H=W),Y.width=B,Y.height=H,Q){Q.fillStyle="#FFFFFF",Q.fillRect(0,0,B,H),Q.drawImage(M,0,0,B,H);const F=Y.toDataURL("image/jpeg",.7);w(F)}},M.src=(U=P.target)==null?void 0:U.result},S.readAsDataURL(E)},R=E=>{var S;if(!m)return;const w=(S=E.target.files)==null?void 0:S[0];w&&(i("Compressing logo...","info"),C(w,P=>{t(M=>({...M,companyLogo:P})),i("Logo processed. Click 'Save Configuration' to persist.","success")}))},N=(E=!1)=>{const w=E?Ao:vs[L];navigator.clipboard.writeText(w),d(!0),i(E?"Full project code copied!":`${L} copied!`,"success"),setTimeout(()=>d(!1),2e3)},k=(E,w)=>{E&&navigator.clipboard.writeText(E).then(()=>{i(`${w} copied!`,"success")}).catch(()=>i("Failed to copy","error"))},I=async()=>{const E=e.companyName||"SafetyCheck Pro",w=e.webAppUrl||"Not configured",S=e.mobileApkLink||"Not configured",P=`${E} - App Access`,M=` SYSTEM ACCESS DETAILS

Organization: ${E}

Here are the links to access the Inspection System:

 DOWNLOAD MOBILE APP (Android):
${S}

 ACCESS WEB PORTAL:
${w}

Please save these links for future use.`;if(navigator.share)try{await navigator.share({title:P,text:M}),i("System details shared successfully!","success")}catch{k(M,"Access Details")}else k(M,"Access Details")};return r.jsxs("div",{className:"max-w-4xl mx-auto animate-fadeIn space-y-8 pb-12",children:[r.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[r.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-lg bg-slate-900 text-white flex items-center justify-center shadow-lg",children:r.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),"System Settings"]}),!g&&r.jsxs("div",{className:"bg-amber-100 text-amber-800 px-4 py-2 rounded-lg text-xs font-bold flex items-center gap-2 border border-amber-200",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Limited Access"]})]}),r.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-blue-600 rounded-xl shadow-lg border border-indigo-500 p-6 text-white relative overflow-hidden",children:[r.jsx("div",{className:"absolute top-0 right-0 p-24 bg-white/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"}),r.jsxs("div",{className:"relative z-10",children:[r.jsxs("div",{className:"flex justify-between items-start mb-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[r.jsx("svg",{className:"w-6 h-6 text-indigo-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Share Application Access"]}),r.jsx("p",{className:"text-indigo-100 text-sm mt-1",children:"Distribute App and Web Portal links to your team."})]}),r.jsxs("button",{onClick:I,className:"bg-white text-indigo-700 hover:bg-indigo-50 font-bold py-2 px-4 rounded-lg shadow-md transition-transform transform active:scale-95 flex items-center gap-2 text-sm",children:[r.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"})}),"Share All Details"]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-white/10 rounded-lg p-3 backdrop-blur-sm border border-white/10",children:[r.jsxs("div",{className:"flex justify-between items-center mb-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"w-4 h-4 text-green-400",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M17.523 15.3414c-.5511 0-.9993-.4486-.9993-.9997s.4482-.9993.9993-.9993c.5511 0 .9993.4482.9993.9993.0001.5511-.4482.9997-.9993.9997m-11.046 0c-.5511 0-.9993-.4486-.9993-.9997s.4482-.9993.9993-.9993c.5511 0 .9993.4482.9993.9993 0 .5511-.4482.9997-.9993.9997m11.4045-6.02l1.9973-3.4592a.416.416 0 00-.1521-.5676.416.416 0 00-.5676.1521l-2.0223 3.503C15.5902 8.4102 13.8688 8.0099 12 8.0099s-3.5902.4003-5.1367.9497L4.841 5.4565a.416.416 0 00-.5676-.1521.416.416 0 00-.1521.5676l1.9973 3.4592C2.6889 11.1867.3432 14.6589 0 18.761h24c-.3432-4.1021-2.6889-7.5743-6.1185-9.4396"})}),r.jsx("span",{className:"text-xs font-bold text-indigo-100",children:"Android APK"})]}),r.jsx("button",{onClick:()=>k(e.mobileApkLink,"APK Link"),className:"text-[10px] bg-white/20 hover:bg-white/30 text-white px-2 py-0.5 rounded transition",children:"Copy"})]}),r.jsx("div",{className:"text-xs text-indigo-200 truncate font-mono bg-black/20 p-1.5 rounded",children:e.mobileApkLink||"Not configured"})]}),r.jsxs("div",{className:"bg-white/10 rounded-lg p-3 backdrop-blur-sm border border-white/10",children:[r.jsxs("div",{className:"flex justify-between items-center mb-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"w-4 h-4 text-blue-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),r.jsx("span",{className:"text-xs font-bold text-indigo-100",children:"Web Portal"})]}),r.jsx("button",{onClick:()=>k(e.webAppUrl,"Web Link"),className:"text-[10px] bg-white/20 hover:bg-white/30 text-white px-2 py-0.5 rounded transition",children:"Copy"})]}),r.jsx("div",{className:"text-xs text-indigo-200 truncate font-mono bg-black/20 p-1.5 rounded",children:e.webAppUrl||"Not configured"})]})]})]})]}),r.jsxs("div",{className:`bg-white p-8 rounded-xl shadow-sm border border-gray-100 space-y-6 ${m?"":"opacity-80 pointer-events-none grayscale-[0.2]"}`,children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Company Profile & App Links"}),m&&!g&&r.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded font-bold",children:"You can edit profile"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Company Name"}),r.jsx("input",{type:"text",value:e.companyName,onChange:E=>t(w=>({...w,companyName:E.target.value})),className:"w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition",placeholder:"e.g. Apex Logistics Ltd.",readOnly:!m})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Manager Email"}),r.jsx("input",{type:"email",value:e.managerEmail,onChange:E=>t(w=>({...w,managerEmail:E.target.value})),className:"w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition",placeholder:"manager@company.com",readOnly:!m})]})]}),f&&r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 bg-blue-50 p-4 rounded-xl border border-blue-100",children:[r.jsxs("div",{className:"col-span-1 md:col-span-2 text-[10px] text-blue-600 font-bold uppercase tracking-wider mb-2 flex items-center gap-2",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Enter Distribution Links (Will appear in Share Card for all users)"]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-blue-800 uppercase mb-2",children:"Mobile APK Download Link"}),r.jsx("input",{type:"text",value:e.mobileApkLink||"",onChange:E=>t(w=>({...w,mobileApkLink:E.target.value})),className:"w-full p-3 bg-white border border-blue-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition text-sm text-blue-900",placeholder:"https://example.com/app.apk"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-blue-800 uppercase mb-2",children:"Web Browser Link"}),r.jsx("input",{type:"text",value:e.webAppUrl||"",onChange:E=>t(w=>({...w,webAppUrl:E.target.value})),className:"w-full p-3 bg-white border border-blue-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition text-sm text-blue-900",placeholder:"https://safetycheck.com"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Company Logo (For Reports)"}),r.jsxs("div",{className:"flex items-center gap-6 p-4 border border-gray-200 rounded-lg bg-gray-50",children:[r.jsx("div",{className:"w-20 h-20 bg-white border border-gray-200 rounded-lg flex items-center justify-center overflow-hidden shadow-sm",children:e.companyLogo&&!b?r.jsx("img",{src:e.companyLogo,alt:"Logo",className:"w-full h-full object-contain",onError:()=>y(!0)}):r.jsx("span",{className:"text-xs text-gray-300",children:"No Logo"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("input",{type:"file",accept:"image/*",onChange:R,disabled:!m,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-700 cursor-pointer disabled:cursor-not-allowed"}),r.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Image will be automatically resized & compressed for database storage."})]})]})]}),r.jsx("div",{className:"flex justify-end pt-2 border-t border-gray-100",children:r.jsx("button",{onClick:l,disabled:o||!m,className:`px-8 py-3 rounded-xl font-bold text-white shadow-lg transition-all flex items-center gap-2
                            ${o||!m?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 hover:scale-105"}
                        `,children:o?"Saving...":"Save Configuration"})})]}),r.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-sm border border-gray-100 relative overflow-hidden",children:[r.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2 text-gray-800",children:[r.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"})}),"Database Connection"]}),r.jsxs("div",{className:"space-y-4 relative",children:[!g&&r.jsx("div",{className:"absolute inset-0 z-10 bg-white/10 backdrop-blur-[3px] flex items-center justify-center rounded-lg border border-dashed border-slate-300",children:r.jsxs("span",{className:"bg-slate-800 text-white text-xs font-bold px-3 py-1 rounded shadow-lg flex items-center gap-2",children:[r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"PROTECTED"]})}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Google Apps Script Web App URL"}),r.jsx("input",{type:"text",value:n,onChange:E=>s(E.target.value),placeholder:"https://script.google.com/macros/s/...",className:`w-full p-3 bg-gray-50 border border-gray-300 rounded-lg font-mono text-xs text-blue-800 break-all
                                ${g?"":"blur-[3px] select-none pointer-events-none opacity-50"}
                            `,readOnly:!g})]}),r.jsx("div",{className:"flex justify-end pt-2",children:r.jsx("button",{onClick:l,disabled:o||!g,className:`px-6 py-2 rounded-lg font-bold text-sm transition-all flex items-center gap-2
                                ${g?"bg-blue-600 text-white hover:bg-blue-700 shadow-md":"bg-gray-100 text-gray-400 cursor-not-allowed border border-gray-200"}
                            `,children:"Update Connection"})})]})]}),g&&r.jsxs("div",{className:"bg-slate-900 text-slate-300 p-0 rounded-xl shadow-lg border border-slate-800 overflow-hidden flex flex-col md:flex-row min-h-[500px]",children:[r.jsxs("div",{className:"w-full md:w-64 bg-slate-950 border-r border-slate-800 flex flex-col",children:[r.jsx("div",{className:"p-4 border-b border-slate-800",children:r.jsxs("h3",{className:"text-white text-sm font-bold flex items-center gap-2",children:[r.jsx("svg",{className:"w-4 h-4 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),"Project Files"]})}),r.jsx("div",{className:"flex-1 overflow-y-auto",children:Object.keys(vs).map(E=>r.jsxs("button",{onClick:()=>p(E),className:`w-full text-left px-4 py-3 text-xs font-mono border-l-2 transition-all flex items-center justify-between
                                        ${L===E?"bg-slate-800 text-white border-blue-500":"border-transparent text-slate-400 hover:bg-slate-900 hover:text-slate-200"}
                                    `,children:[r.jsx("span",{children:E}),L===E&&r.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"})]},E))}),r.jsx("div",{className:"p-4 border-t border-slate-800",children:r.jsxs("button",{onClick:()=>N(!0),className:"w-full px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold rounded flex items-center justify-center gap-2 transition-colors",children:[r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy Entire Project"]})})]}),r.jsxs("div",{className:"flex-1 flex flex-col bg-slate-900",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800 bg-slate-900",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Viewing:"}),r.jsx("span",{className:"text-sm font-mono text-green-400 font-bold",children:L})]}),r.jsx("button",{onClick:()=>N(!1),className:`px-3 py-1.5 rounded text-xs font-bold border transition-all flex items-center gap-2
                                    ${c?"bg-green-500/10 border-green-500 text-green-400":"bg-slate-800 border-slate-700 text-slate-300 hover:bg-slate-700"}
                                `,children:c?r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),"Copied!"]}):r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})}),"Copy File"]})})]}),r.jsx("div",{className:"flex-1 relative",children:r.jsx("pre",{className:"absolute inset-0 p-6 overflow-auto text-[11px] font-mono text-slate-300 leading-relaxed scrollbar-thin scrollbar-thumb-slate-700 scrollbar-track-transparent",children:vs[L]})})]})]})]})},Mm=({isLocked:e,children:t,isSuperAdmin:n,onUnlock:s})=>r.jsxs("div",{className:"relative min-h-[500px]",children:[r.jsx("div",{className:`transition-all duration-500 ${e?"blur-md opacity-30 pointer-events-none select-none":""}`,children:t}),e&&r.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"bg-white/90 backdrop-blur-xl border border-white/50 rounded-2xl shadow-2xl p-8 max-w-md w-full text-center transform scale-100 animate-fadeIn",children:[r.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6 shadow-inner",children:r.jsx("svg",{className:"w-10 h-10 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),r.jsx("h2",{className:"text-2xl font-black text-slate-800 mb-2",children:"System Locked"}),r.jsx("p",{className:"text-sm text-slate-500 mb-6 leading-relaxed",children:"The subscription for this system has expired. Access is restricted to maintenance mode."}),r.jsxs("div",{className:"bg-red-50 border border-red-100 rounded-xl p-4 mb-6",children:[r.jsx("p",{className:"text-xs font-bold text-red-800 uppercase tracking-wide",children:"Contact Administrator"}),r.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Please renew your license to restore full access."})]}),n?r.jsxs("button",{onClick:s,className:"w-full py-3 bg-red-600 hover:bg-red-700 text-white font-bold rounded-xl transition-all shadow-lg shadow-red-200 flex items-center justify-center gap-2",children:[r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Access Management Console"]}):r.jsx("p",{className:"text-[10px] text-gray-400",children:"Super Admins can still access System Settings."})]})})]}),dl=({title:e,description:t,icon:n,colorTheme:s,stats:l,startNewInspection:o,fetchHistory:i,isLoadingHistory:a,historyList:c,onViewReport:d,onPrint:v,userRole:u,titlePrefix:h="INSPECTION"})=>{const[x,b]=j.useState(""),y=j.useMemo(()=>{let N=c;if(x.trim()){const k=x.toLowerCase();N=N.filter(I=>I.truckNo&&I.truckNo.toLowerCase().includes(k)||I.driverName&&I.driverName.toLowerCase().includes(k)||I.inspectedBy&&I.inspectedBy.toLowerCase().includes(k))}else N=N.slice(0,10);return N},[c,x]),L=N=>{const k=Number(N.rate)>=4,I=k?"":Number(N.rate)===3?"":"",E=k?"PASSED":Number(N.rate)===3?"WARNING":"CRITICAL FAIL";return`${h} SUMMARY

Vehicle: ${N.truckNo}
Trailer: ${N.trailerNo||"N/A"}
Date: ${new Date(N.timestamp).toLocaleDateString()} ${new Date(N.timestamp).toLocaleTimeString()}
Inspector: ${N.inspectedBy}

STATUS: ${I} ${E}
Safety Rating: ${N.rate}/5

Remarks:
${N.remarks||"None"}

Generated via SafetyCheck Pro`},p=async N=>{const k={title:`${e}: ${N.truckNo}`,text:L(N)};try{navigator.share?await navigator.share(k):(await navigator.clipboard.writeText(k.text),alert("Report summary copied to clipboard."))}catch(I){console.error("Error sharing:",I)}},f=N=>{const k=`${e}: ${N.truckNo}`,I=L(N);window.open(`mailto:?subject=${encodeURIComponent(k)}&body=${encodeURIComponent(I)}`)},m=window.isSubscriptionLocked||!1,g=(u==="Admin"||u==="Inspector"||u==="SuperAdmin")&&!m,R=(()=>{switch(s){case"orange":return{bgLight:"bg-orange-50",bgIcon:"bg-orange-100",textIcon:"text-orange-700",border:"border-orange-100",hoverBg:"group-hover:bg-orange-100",btnBg:"bg-orange-600",btnHover:"hover:bg-orange-700",btnShadow:"shadow-orange-200",textLink:"text-orange-600",statText:"text-orange-800",statScore:"text-orange-600",focusRing:"focus:ring-orange-500"};case"rose":return{bgLight:"bg-rose-50",bgIcon:"bg-rose-100",textIcon:"text-rose-700",border:"border-rose-100",hoverBg:"group-hover:bg-rose-100",btnBg:"bg-rose-600",btnHover:"hover:bg-rose-700",btnShadow:"shadow-rose-200",textLink:"text-rose-600",statText:"text-rose-800",statScore:"text-rose-600",focusRing:"focus:ring-rose-500"};case"purple":return{bgLight:"bg-purple-50",bgIcon:"bg-purple-100",textIcon:"text-purple-700",border:"border-purple-100",hoverBg:"group-hover:bg-purple-100",btnBg:"bg-purple-600",btnHover:"hover:bg-purple-700",btnShadow:"shadow-purple-200",textLink:"text-purple-600",statText:"text-purple-800",statScore:"text-purple-600",focusRing:"focus:ring-purple-500"};default:return{bgLight:"bg-emerald-50",bgIcon:"bg-emerald-100",textIcon:"text-emerald-700",border:"border-emerald-100",hoverBg:"group-hover:bg-emerald-100",btnBg:"bg-emerald-600",btnHover:"hover:bg-emerald-700",btnShadow:"shadow-emerald-200",textLink:"text-emerald-600",statText:"text-emerald-800",statScore:"text-emerald-600",focusRing:"focus:ring-emerald-500"}}})();return r.jsx(Mm,{isLocked:m,children:r.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 animate-fadeIn",children:[r.jsxs("div",{className:`bg-white rounded-2xl p-8 shadow-sm border ${R.border} relative overflow-hidden group`,children:[r.jsx("div",{className:`absolute top-0 right-0 w-64 h-64 ${R.bgLight} rounded-full blur-3xl transform translate-x-1/2 -translate-y-1/2 ${R.hoverBg} transition-colors`}),r.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-6",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("div",{className:`p-2 ${R.bgIcon} ${R.textIcon} rounded-lg`,children:n}),r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e})]}),r.jsx("p",{className:"text-gray-500 text-sm max-w-lg mb-6",children:t}),r.jsxs("div",{className:"flex flex-wrap gap-4",children:[g&&r.jsxs("button",{id:"start-inspection-btn",onClick:o,className:`px-6 py-3 ${R.btnBg} ${R.btnHover} text-white font-bold rounded-xl shadow-lg ${R.btnShadow} transition transform hover:scale-105 active:scale-95 flex items-center gap-2`,children:[r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Start New Inspection"]}),r.jsxs("button",{onClick:i,className:`px-6 py-3 bg-white border border-gray-200 text-gray-600 font-semibold rounded-xl hover:bg-gray-50 hover:${R.textLink} transition flex items-center gap-2`,children:[r.jsx("svg",{className:`w-5 h-5 ${a?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Data"]})]})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"bg-white border border-gray-100 shadow-sm rounded-2xl p-4 text-center min-w-[110px]",children:[r.jsx("div",{className:`text-3xl font-black ${R.statText}`,children:l.total}),r.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-wide font-bold mt-1",children:"Total Inspections"})]}),r.jsxs("div",{className:"bg-white border border-gray-100 shadow-sm rounded-2xl p-4 text-center min-w-[110px]",children:[r.jsxs("div",{className:`text-3xl font-black ${R.statScore}`,children:[l.passRate,"%"]}),r.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-wide font-bold mt-1",children:"Safety Score"})]})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100 rounded-xl p-4 flex items-start gap-4 shadow-sm animate-fadeIn",children:[r.jsx("div",{className:"bg-blue-100 text-blue-600 p-2 rounded-lg shrink-0",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-bold text-blue-900 text-sm",children:"Assigned Tasks"}),r.jsxs("p",{className:"text-xs text-blue-700 mt-1 leading-relaxed",children:["Check your ",r.jsx("strong",{children:"Notification Bell"})," (top right) for assigned requests. Clicking a request notification will automatically start the form for that vehicle."]})]})]}),r.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:[r.jsxs("div",{className:"p-6 border-b border-gray-100 flex flex-col md:flex-row justify-between items-center gap-4 bg-gray-50/50",children:[r.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:["Inspection History",!x&&r.jsx("span",{className:"text-xs bg-white border border-gray-200 text-gray-400 px-2 py-0.5 rounded-md font-normal",children:"Last 10"})]}),r.jsxs("div",{className:"relative w-full md:w-72",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),r.jsx("input",{type:"text",placeholder:"Search Truck, Driver or Inspector...",value:x,onChange:N=>b(N.target.value),className:`w-full pl-10 pr-4 py-2.5 bg-white border border-gray-200 rounded-xl text-sm focus:ring-2 ${R.focusRing} focus:border-transparent outline-none transition-all shadow-sm`})]})]}),a?r.jsxs("div",{className:"py-16 text-center text-gray-400 flex flex-col items-center",children:[r.jsx("div",{className:`w-8 h-8 border-4 border-gray-200 border-t-${s}-500 rounded-full animate-spin mb-4`}),r.jsx("p",{children:"Loading records..."})]}):y.length===0?r.jsxs("div",{className:"py-16 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-300",children:r.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),r.jsx("div",{className:"text-gray-400 mb-2 font-medium",children:"No inspections found"}),r.jsx("p",{className:"text-sm text-gray-400 max-w-xs mx-auto",children:x?"Try a different search term.":"Inspections submitted will appear here."})]}):r.jsx("div",{className:"divide-y divide-gray-100",children:y.map((N,k)=>r.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center p-5 hover:bg-slate-50 transition-colors gap-4 group cursor-default",children:[r.jsxs("div",{className:"flex items-center gap-5 w-full md:w-auto",children:[r.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center text-lg font-black text-white shadow-sm shrink-0
                                      ${Number(N.rate)>=4?"bg-emerald-500":Number(N.rate)===3?"bg-amber-500":"bg-red-500"}
                                  `,children:N.rate}),r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-1",children:[r.jsx("span",{className:"font-bold text-gray-800 text-base",children:N.truckNo}),N.trailerNo&&r.jsx("span",{className:"text-[10px] font-bold text-slate-500 bg-slate-100 px-2 py-0.5 rounded-full border border-slate-200 tracking-wide",children:N.trailerNo})]}),r.jsxs("div",{className:"text-xs text-gray-500 flex flex-wrap items-center gap-3",children:[r.jsxs("div",{className:"flex items-center gap-1.5",title:"Date of Inspection",children:[r.jsx("svg",{className:"w-3.5 h-3.5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),r.jsx("span",{className:"font-medium tabular-nums",children:new Date(N.timestamp).toLocaleDateString()})]}),r.jsxs("div",{className:"flex items-center gap-1.5",title:"Time of Inspection",children:[r.jsx("svg",{className:"w-3.5 h-3.5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("span",{className:"font-medium tabular-nums",children:new Date(N.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),r.jsx("div",{className:"hidden sm:block w-px h-3 bg-gray-300 mx-1"}),r.jsxs("div",{className:"flex items-center gap-1.5 text-gray-600",children:[r.jsx("svg",{className:"w-3.5 h-3.5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),r.jsx("span",{className:"font-medium truncate max-w-[120px]",children:N.inspectedBy})]})]})]})]}),r.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto justify-end",children:[r.jsxs("button",{onClick:()=>d(N),title:"View & Download Report",className:"px-4 py-2 text-xs font-bold text-slate-600 bg-white hover:bg-slate-50 border border-slate-200 rounded-lg transition-all shadow-sm flex items-center gap-2",children:[r.jsxs("svg",{className:"w-4 h-4 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View Report"]}),r.jsx("button",{onClick:()=>f(N),title:"Email Report",className:"p-2 text-red-600 bg-red-50 hover:bg-red-100 border border-red-200 rounded-lg transition-colors",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),r.jsx("button",{onClick:()=>p(N),title:"Share Report Summary",className:"p-2 text-indigo-600 bg-indigo-50 hover:bg-indigo-100 border border-indigo-200 rounded-lg transition-colors",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})})]})]},k))})]})]})})},Dm=e=>r.jsx(dl,{...e,title:"General Inspection",description:"Manage standard vehicle safety checks, driver documentation, and exterior condition reports.",icon:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),colorTheme:"emerald",titlePrefix:"VEHICLE INSPECTION"}),Om=e=>r.jsx(dl,{...e,title:"Petroleum Inspection #1",description:"Detailed safety checks for petroleum tankers, equipment, and documentation.",icon:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),colorTheme:"orange",titlePrefix:"PETROLEUM INSPECTION"}),zm=e=>r.jsx(dl,{...e,title:"Petroleum Inspection #2",description:"Secondary safety audit for petroleum vehicles, focusing on compliance and tank integrity.",icon:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),colorTheme:"rose",titlePrefix:"PETROLEUM V2 INSPECTION"}),Bm=e=>r.jsx(dl,{...e,title:"Acid Tanker Inspection",description:"Specialized safety checks for acid tankers, spill kits, and hazardous material compliance.",icon:r.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{d:"M12 2l-5.5 9h11z"}),r.jsx("path",{d:"M10 13v6h4v-6z"})]}),colorTheme:"purple",titlePrefix:"ACID TANKER INSPECTION"}),Xt=({label:e,value:t,onChange:n,options:s=[],placeholder:l,isRegNo:o,isTitleCase:i,readOnly:a,error:c})=>{const[d,v]=j.useState(!1),[u,h]=j.useState(-1),x=j.useRef(null),b=j.useRef(null),y=s.filter(m=>m!=null&&String(m).toLowerCase().includes((t||"").toLowerCase()));j.useEffect(()=>{function m(g){x.current&&!x.current.contains(g.target)&&v(!1)}return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[x]);const L=m=>{if(a)return;let g=m.target.value;if(o){g=g.toUpperCase();let C=g.replace(/[^A-Z0-9]/g,"");C=C.replace(/([A-Z])(\d)/g,"$1 $2"),C=C.replace(/(\d)([A-Z])/g,"$1 $2"),g=C}i&&!o&&(g=g.replace(/\b\w/g,C=>C.toUpperCase())),n(g),v(!0),h(-1)},p=m=>{a||(n(String(m)),v(!1),h(-1))},f=m=>{a||(m.key==="ArrowDown"?(m.preventDefault(),h(g=>Math.min(g+1,y.length-1))):m.key==="ArrowUp"?(m.preventDefault(),h(g=>Math.max(g-1,0))):m.key==="Enter"?(m.preventDefault(),u>=0&&y[u]?p(y[u]):p(t)):m.key==="Escape"&&v(!1))};return r.jsxs("div",{className:"relative",ref:x,children:[r.jsxs("label",{className:`block text-xs font-bold uppercase mb-1.5 tracking-wide flex justify-between ${c?"text-red-600":"text-gray-500"}`,children:[e,a&&r.jsxs("span",{className:"text-[10px] bg-gray-100 text-gray-500 px-1.5 py-0.5 rounded flex items-center gap-1",children:[r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Verified"]})]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{ref:b,type:"text",value:t,onChange:L,onFocus:()=>!a&&v(!0),onKeyDown:f,placeholder:l,readOnly:a,className:`w-full p-3.5 border rounded-lg transition-all font-medium 
             ${a?"bg-gray-100 border-gray-200 text-gray-500 cursor-not-allowed focus:outline-none":c?"bg-red-50 border-red-300 focus:ring-2 focus:ring-red-200 text-red-900 placeholder-red-300":"bg-gray-50 border-gray-200 focus:ring-2 focus:ring-blue-500 focus:bg-white text-gray-800 placeholder-gray-400"}
          `}),r.jsx("div",{className:`absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none ${c?"text-red-400":"text-gray-400"}`,children:a?r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}):c?r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),c&&r.jsx("p",{className:"text-[10px] text-red-500 font-bold mt-1 ml-1 animate-fadeIn",children:"This field is required"}),!a&&d&&(t.length>0||y.length>0)&&r.jsx("ul",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-xl max-h-60 overflow-y-auto",children:y.length>0?y.map((m,g)=>r.jsxs("li",{onClick:()=>p(m),className:`px-4 py-2.5 text-sm cursor-pointer transition-colors border-b border-gray-50 last:border-none flex justify-between items-center
                  ${g===u?"bg-blue-50 text-blue-700 font-medium":"text-gray-700 hover:bg-gray-50"}
                `,children:[m,o&&r.jsx("span",{className:"text-[10px] bg-gray-100 text-gray-500 px-1.5 py-0.5 rounded border border-gray-200",children:"EXISTING"})]},g)):r.jsxs("li",{onMouseDown:m=>{m.preventDefault(),p(t)},className:"px-4 py-3 text-sm text-blue-600 bg-blue-50 cursor-pointer font-medium flex items-center gap-2 hover:bg-blue-100 transition-colors",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),'Add New Entry: "',t,'"']})})]})},Vm=({currentUser:e,appScriptUrl:t,showToast:n,validationLists:s,settings:l})=>{const[o,i]=j.useState([]),[a,c]=j.useState(!1),[d,v]=j.useState("list"),[u,h]=j.useState(!1),[x,b]=j.useState(""),[y,L]=j.useState({name:"",username:"",password:"",role:"Inspector",position:""}),[p,f]=j.useState(!1),m=e.role==="SuperAdmin";j.useEffect(()=>{g()},[]);const g=async()=>{if(t){c(!0);try{const S=await(await fetch(t,{method:"POST",body:JSON.stringify({action:"get_users"})})).json();if(S.status==="success"&&Array.isArray(S.users)){let P=S.users;m||(P=P.filter(M=>M.role!=="SuperAdmin")),i(P)}}catch(w){console.error(w),n("Failed to load users","error")}finally{c(!1)}}},C=async w=>{if(window.confirm(`Are you sure you want to remove user "${w}"?`)){c(!0);try{const P=await(await fetch(t,{method:"POST",body:JSON.stringify({action:"delete_user",username:w})})).json();P.status==="success"?(n("User removed successfully","success"),g()):n(P.message||"Failed to delete user","error")}catch{n("Connection failed","error")}finally{c(!1)}}},R=w=>{L({name:w.name,username:w.username,role:w.role,position:w.position||"",password:""}),b(w.username),h(!0),v("form")},N=async w=>{if(w.preventDefault(),!y.name||!y.username){n("Please fill in required fields.","error");return}if(!u&&!y.password){n("Password is required for new users.","error");return}f(!0);try{const S=o.find(Q=>Q.username===x);let P=(S==null?void 0:S.preferences)||{emailNotifications:!0,notifyGeneral:!0,notifyPetroleum:!0,notifyPetroleumV2:!0,notifyAcid:!0,mustChangePassword:!1};(!u||y.password&&y.password.trim()!=="")&&(P={...P,mustChangePassword:!0});const M={action:u?"update_user":"register_user",...y,preferences:P};u&&(M.originalUsername=x);const Y=await(await fetch(t,{method:"POST",body:JSON.stringify(M)})).json();if(Y.status==="success"){const Q=u?y.password?"User updated. They must change password on next login.":"User updated successfully":"User created. They must change password on first login.";n(Q,"success"),v("list"),L({name:"",username:"",password:"",role:"Inspector",position:""}),h(!1),g()}else n(Y.message||"Operation failed","error")}catch{n("Connection failed","error")}finally{f(!1)}},k=w=>{const S=document.createElement("textarea");S.value=w,S.style.top="0",S.style.left="0",S.style.position="fixed",S.style.opacity="0",document.body.appendChild(S),S.focus(),S.select();try{document.execCommand("copy")?n("Details copied to clipboard (Fallback)","success"):n("Unable to copy details. Please copy manually.","error")}catch{n("Unable to copy details. Please copy manually.","error")}document.body.removeChild(S)},I=async w=>{const S=(l==null?void 0:l.companyName)||"SafetyCheck Pro",P=(l==null?void 0:l.webAppUrl)||window.location.origin+window.location.pathname,M=(l==null?void 0:l.mobileApkLink)||"Contact Admin for APK",U="System Access Credentials",Y=`
${S.toUpperCase()} - ACCESS CREDENTIALS
----------------------------------
Here are your login details for the digital inspection system.

Name: ${w.name}
Role: ${w.role}
${w.position?`Position: ${w.position}`:""}

LOGIN DETAILS:
Username: ${w.username}
Password: ${w.password||"****"} (Change on first login)

ACCESS LINKS:
 Web Portal:
${P}

 Android App:
${M}

Please keep these credentials secure.
----------------------------------
`.trim();if(navigator.share)try{await navigator.share({title:U,text:Y}),n("Credentials shared successfully via System","success")}catch{try{await navigator.clipboard.writeText(Y),n("Share cancelled. Details copied to clipboard.","info")}catch{k(Y)}}else try{await navigator.clipboard.writeText(Y),n("Credentials copied to clipboard!","success")}catch{k(Y)}};return e.role&&(e.role==="Admin"||e.role==="SuperAdmin")?d==="form"?r.jsxs("div",{className:"max-w-lg mx-auto animate-fadeIn py-4 px-2 sm:px-0",children:[r.jsxs("button",{onClick:()=>v("list"),className:"mb-4 flex items-center gap-2 text-gray-500 hover:text-gray-800 transition-colors text-xs font-bold uppercase tracking-wider",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to List"]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[r.jsxs("div",{className:"bg-slate-50 px-6 py-4 border-b border-gray-100 flex items-center justify-between",children:[r.jsx("h2",{className:"text-lg font-black text-slate-800 tracking-tight",children:u?"Edit User Details":"Create New User"}),r.jsx("div",{className:"w-8 h-8 bg-white rounded-lg shadow-sm flex items-center justify-center text-blue-600 border border-gray-100",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M18 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),r.jsx("div",{className:"p-6",children:r.jsxs("form",{onSubmit:N,className:"space-y-4",children:[r.jsx("div",{className:"space-y-1",children:r.jsx(Xt,{label:"Full Name",value:y.name,onChange:w=>L({...y,name:w}),options:s.inspectors,isTitleCase:!0,placeholder:"e.g. John Doe"})}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[r.jsx("div",{className:"space-y-1",children:r.jsx(Xt,{label:"Position",value:y.position,onChange:w=>L({...y,position:w}),options:s.positions,isTitleCase:!0,placeholder:"Job Title"})}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[r.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wide",children:"System Role"}),!m&&r.jsxs("span",{className:"text-[9px] text-amber-600 font-medium flex items-center gap-1 bg-amber-50 px-1.5 py-0.5 rounded border border-amber-100",children:[r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Restricted"]})]}),r.jsxs("select",{className:"w-full p-3.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-gray-50 text-sm font-medium transition-colors text-gray-800",value:y.role,onChange:w=>L({...y,role:w.target.value}),children:[r.jsx("option",{value:"Inspector",children:"Inspector"}),r.jsx("option",{value:"Operations",children:"Operations"}),r.jsx("option",{value:"Maintenance",children:"Maintenance"}),r.jsx("option",{value:"Secretary",children:"Secretary"}),r.jsx("option",{value:"Other",children:"Other"}),r.jsx("option",{value:"Admin",children:"Admin"}),m&&r.jsx("option",{value:"SuperAdmin",children:"SuperAdmin"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5 tracking-wide",children:"Username"}),r.jsx("input",{type:"text",required:!0,className:"w-full p-3.5 border rounded-lg outline-none font-medium transition-all text-sm bg-gray-50 border-gray-200 text-gray-800 focus:ring-2 focus:ring-blue-500",value:y.username,onChange:w=>L({...y,username:w.target.value}),placeholder:"jdoe"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5 tracking-wide",children:["Password ",u&&r.jsx("span",{className:"text-gray-400 font-normal normal-case",children:"(Optional)"})]}),r.jsx("input",{type:"password",required:!u,className:"w-full p-3.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-gray-50 text-gray-800 placeholder-gray-400 font-medium transition-all text-sm",value:y.password,onChange:w=>L({...y,password:w.target.value}),placeholder:u?"Leave blank to keep current":""})]})]}),r.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg border border-amber-100 flex items-start gap-2",children:[r.jsx("svg",{className:"w-4 h-4 text-amber-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("p",{className:"text-[10px] text-amber-800",children:"Setting a password will prompt the user to change it upon their next login for security."})]}),r.jsxs("div",{className:"pt-4 flex gap-3",children:[r.jsx("button",{type:"button",onClick:()=>v("list"),className:"flex-1 py-3 bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 font-bold rounded-xl transition text-sm",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:p,className:"flex-1 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl shadow-md transition disabled:bg-blue-400 text-sm flex items-center justify-center gap-2",children:p?"Saving...":u?"Update User":"Create User"})]})]})})]})]}):r.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 animate-fadeIn",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[r.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-3",children:[r.jsx("span",{className:"p-2 bg-purple-100 text-purple-700 rounded-lg",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),"User Management"]}),r.jsxs("div",{className:"flex gap-3 w-full sm:w-auto",children:[r.jsxs("button",{onClick:g,className:"flex-1 sm:flex-none justify-center px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[r.jsx("svg",{className:`w-4 h-4 ${a?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]}),r.jsxs("button",{onClick:()=>{L({name:"",username:"",password:"",role:"Inspector",position:""}),h(!1),v("form")},className:"flex-1 sm:flex-none justify-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg shadow-md flex items-center gap-2 transition",children:[r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M18 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Add User"]})]})]}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-left text-sm whitespace-nowrap",children:[r.jsx("thead",{className:"bg-gray-50 text-xs font-bold text-gray-500 uppercase border-b border-gray-200",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3",children:"Name / Position"}),r.jsx("th",{className:"px-4 py-3",children:"Username"}),r.jsx("th",{className:"px-4 py-3",children:"Role"}),r.jsx("th",{className:"px-4 py-3",children:"Last Login"}),r.jsx("th",{className:"px-4 py-3 text-right",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-100",children:o.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-500",children:a?"Loading users...":"No users found."})}):o.map((w,S)=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsxs("td",{className:"px-4 py-3",children:[r.jsx("div",{className:"font-bold text-gray-900",children:w.name}),r.jsx("div",{className:"text-xs text-gray-500",children:w.position})]}),r.jsx("td",{className:"px-4 py-3 font-mono text-gray-600",children:w.username}),r.jsx("td",{className:"px-4 py-3",children:r.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold 
                                                ${w.role==="SuperAdmin"?"bg-black text-white":w.role==="Admin"?"bg-purple-100 text-purple-700":w.role==="Operations"?"bg-blue-100 text-blue-700":w.role==="Maintenance"?"bg-orange-100 text-orange-700":w.role==="Secretary"?"bg-indigo-100 text-indigo-700":w.role==="Other"?"bg-gray-100 text-gray-700":"bg-green-100 text-green-700"}`,children:w.role})}),r.jsx("td",{className:"px-4 py-3 text-gray-500 text-xs",children:w.lastLogin?new Date(w.lastLogin).toLocaleDateString():"Never"}),r.jsx("td",{className:"px-4 py-3 text-right",children:w.username!==e.username&&r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx("button",{onClick:()=>I(w),title:"Share Access Credentials & Links",className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded border border-transparent hover:border-indigo-200 transition-colors",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})}),r.jsx("button",{onClick:()=>R(w),title:"Edit User",className:"p-2 text-blue-600 hover:bg-blue-50 rounded border border-transparent hover:border-blue-200 transition-colors",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),r.jsx("button",{onClick:()=>C(w.username),title:"Delete User",className:"p-2 text-red-600 hover:bg-red-50 rounded border border-transparent hover:border-red-200 transition-colors",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},S))})]})})})]}):r.jsx("div",{className:"p-8 text-center text-red-600 font-bold",children:"Access Denied. Admin Privileges Required."})},Fm=({appScriptUrl:e,onNavigate:t,userRole:n})=>{const[s,l]=j.useState(null),[o,i]=j.useState(!1);j.useEffect(()=>{e&&a()},[e]);const a=async()=>{i(!0);try{const u=await(await fetch(`${e}?t=${new Date().getTime()}`)).json(),h=(N,k)=>!Array.isArray(N)||N.length<=1?[]:N.slice(1).map(I=>{const E={};return k.forEach((w,S)=>{E[w]=I[S]}),E}),x=h(u.General,["id","timestamp","truckNo","trailerNo","inspectedBy","driverName","location","odometer","rate","remarks"]),b=h(u.Petroleum,["id","timestamp","truckNo","trailerNo","jobCard","location","odometer","inspectedBy","driverName","rate","remarks"]),y=h(u.Petroleum_V2,["id","timestamp","truckNo","trailerNo","jobCard","location","odometer","inspectedBy","driverName","rate","remarks"]),L=h(u.Acid,["id","timestamp","truckNo","trailerNo","jobCard","location","odometer","inspectedBy","driverName","rate","remarks"]),p=[...x.map(N=>({...N,type:"General"})),...b.map(N=>({...N,type:"Petroleum"})),...y.map(N=>({...N,type:"Petroleum V2"})),...L.map(N=>({...N,type:"Acid"}))],f=p.length,m=p.filter(N=>Number(N.rate)>=4).length,g=p.filter(N=>Number(N.rate)<=2).length,C=new Set(p.map(N=>N.truckNo)).size,R=p.sort((N,k)=>new Date(k.timestamp).getTime()-new Date(N.timestamp).getTime());l({totalInspections:f,passRate:f>0?Math.round(m/f*100):0,totalActiveVehicles:C,criticalIssues:g,byType:{general:x.length,petroleum:b.length+y.length,acid:L.length},recentActivity:R.slice(0,10)})}catch(v){console.error("Dashboard Fetch Error",v)}finally{i(!1)}},c=({title:v,value:u,subtext:h,icon:x,color:b})=>r.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex items-start justify-between transition hover:shadow-md",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide mb-1",children:v}),r.jsx("h3",{className:"text-3xl font-black text-slate-800",children:u}),r.jsx("p",{className:`text-xs mt-1 font-medium ${h.includes("+")?"text-green-600":"text-gray-400"}`,children:h})]}),r.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center text-white shadow-lg bg-gradient-to-br ${b}`,children:x})]}),d=({label:v,module:u,color:h})=>r.jsxs("button",{onClick:()=>t(u),className:"flex flex-col items-center justify-center p-4 rounded-xl border border-gray-100 bg-white hover:bg-gray-50 transition gap-2 group",children:[r.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${h} text-white shadow-md group-hover:scale-110 transition-transform`,children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})})}),r.jsx("span",{className:"text-xs font-bold text-gray-600 group-hover:text-gray-900",children:v})]});return r.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 animate-fadeIn",children:[r.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-black text-slate-800",children:"Executive Dashboard"}),r.jsx("p",{className:"text-gray-500 font-medium mt-1",children:"Overview of fleet safety and inspection operations"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase bg-gray-100 px-3 py-1 rounded-full",children:new Date().toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),r.jsx("button",{onClick:a,className:"p-2 bg-white border border-gray-200 rounded-full text-gray-500 hover:text-blue-600 hover:bg-blue-50 transition",children:r.jsx("svg",{className:`w-5 h-5 ${o?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})]}),o&&!s?r.jsx("div",{className:"h-64 flex items-center justify-center text-gray-400",children:"Loading Analytics..."}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[r.jsx(c,{title:"Total Inspections",value:(s==null?void 0:s.totalInspections)||0,subtext:"All time records",color:"from-blue-500 to-blue-700",icon:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})}),r.jsx(c,{title:"Safety Score",value:`${(s==null?void 0:s.passRate)||0}%`,subtext:"Average compliance",color:"from-green-500 to-emerald-700",icon:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsx(c,{title:"Active Vehicles",value:(s==null?void 0:s.totalActiveVehicles)||0,subtext:"Unique trucks inspected",color:"from-purple-500 to-indigo-700",icon:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})}),r.jsx(c,{title:"Critical Failures",value:(s==null?void 0:s.criticalIssues)||0,subtext:"Requires immediate attention",color:"from-red-500 to-rose-700",icon:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 lg:col-span-2",children:[r.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-6",children:"Inspection Breakdown"}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-sm font-medium mb-1",children:[r.jsx("span",{className:"text-gray-600",children:"General Inspections"}),r.jsx("span",{className:"text-gray-900",children:s==null?void 0:s.byType.general})]}),r.jsx("div",{className:"w-full bg-gray-100 rounded-full h-2.5 overflow-hidden",children:r.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${((s==null?void 0:s.byType.general)||0)/((s==null?void 0:s.totalInspections)||1)*100}%`}})})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-sm font-medium mb-1",children:[r.jsx("span",{className:"text-gray-600",children:"Petroleum Tankers"}),r.jsx("span",{className:"text-gray-900",children:s==null?void 0:s.byType.petroleum})]}),r.jsx("div",{className:"w-full bg-gray-100 rounded-full h-2.5 overflow-hidden",children:r.jsx("div",{className:"bg-orange-500 h-2.5 rounded-full",style:{width:`${((s==null?void 0:s.byType.petroleum)||0)/((s==null?void 0:s.totalInspections)||1)*100}%`}})})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-sm font-medium mb-1",children:[r.jsx("span",{className:"text-gray-600",children:"Acid Tankers"}),r.jsx("span",{className:"text-gray-900",children:s==null?void 0:s.byType.acid})]}),r.jsx("div",{className:"w-full bg-gray-100 rounded-full h-2.5 overflow-hidden",children:r.jsx("div",{className:"bg-purple-600 h-2.5 rounded-full",style:{width:`${((s==null?void 0:s.byType.acid)||0)/((s==null?void 0:s.totalInspections)||1)*100}%`}})})]})]})]}),r.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[r.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Quick Actions"}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(d,{label:"General",module:"general",color:"bg-blue-600"}),r.jsx(d,{label:"Petroleum",module:"petroleum",color:"bg-orange-600"}),r.jsx(d,{label:"Petro V2",module:"petroleum_v2",color:"bg-red-600"}),r.jsx(d,{label:"Acid",module:"acid",color:"bg-purple-600"})]}),r.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:r.jsx("p",{className:"text-xs text-gray-400 text-center",children:"Start a new inspection based on vehicle type."})})]})]}),r.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[r.jsx("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:r.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Recent Activity Feed"})}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-left text-sm",children:[r.jsx("thead",{className:"bg-gray-50 text-xs font-bold text-gray-500 uppercase",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-4",children:"Type"}),r.jsx("th",{className:"px-6 py-4",children:"Vehicle"}),r.jsx("th",{className:"px-6 py-4",children:"Inspector"}),r.jsx("th",{className:"px-6 py-4",children:"Date"}),r.jsx("th",{className:"px-6 py-4 text-right",children:"Rating"})]})}),r.jsxs("tbody",{className:"divide-y divide-gray-100",children:[s==null?void 0:s.recentActivity.map((v,u)=>r.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:`text-[10px] font-bold uppercase px-2 py-1 rounded 
                                                    ${v.type==="General"?"bg-blue-100 text-blue-700":v.type==="Acid"?"bg-purple-100 text-purple-700":"bg-orange-100 text-orange-700"}
                                                `,children:v.type})}),r.jsx("td",{className:"px-6 py-4 font-bold text-gray-800",children:v.truckNo}),r.jsx("td",{className:"px-6 py-4 text-gray-600",children:v.inspectedBy}),r.jsx("td",{className:"px-6 py-4 text-gray-500 text-xs",children:new Date(v.timestamp).toLocaleString()}),r.jsx("td",{className:"px-6 py-4 text-right",children:r.jsxs("span",{className:`font-bold ${Number(v.rate)>=4?"text-green-600":Number(v.rate)<=2?"text-red-600":"text-amber-600"}`,children:[v.rate,"/5"]})})]},u)),(s==null?void 0:s.recentActivity.length)===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-400",children:"No recent activity found."})})]})]})})]})]})]})},tn=({label:e,onCapture:t,existingImage:n})=>{const s=j.useRef(null),[l,o]=j.useState(n),i=a=>{var d;const c=(d=a.target.files)==null?void 0:d[0];if(c){const v=new FileReader;v.onloadend=()=>{const u=v.result;o(u),t(u)},v.readAsDataURL(c)}};return r.jsxs("div",{className:"flex flex-col gap-2 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[r.jsx("span",{className:"text-sm font-semibold text-gray-700",children:e}),r.jsx("div",{className:"relative w-full aspect-video bg-gray-200 rounded-md overflow-hidden flex items-center justify-center border-2 border-dashed border-gray-300",children:l?r.jsx("img",{src:l,alt:"Capture",className:"w-full h-full object-cover"}):r.jsxs("div",{className:"text-gray-400 flex flex-col items-center",children:[r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"}),r.jsx("circle",{cx:"12",cy:"13",r:"3"})]}),r.jsx("span",{className:"text-xs mt-1",children:"No Image"})]})}),r.jsx("input",{type:"file",accept:"image/*",capture:"environment",ref:s,onChange:i,className:"hidden"}),r.jsxs("button",{type:"button",onClick:()=>{var a;return(a=s.current)==null?void 0:a.click()},className:"w-full py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 transition flex items-center justify-center gap-2",children:[r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]}),l?"Retake Photo":"Take Photo"]})]})},Za=({label:e,onSave:t,existingSignature:n})=>{const s=j.useRef(null),[l,o]=j.useState(!1),i=j.useRef(!1);j.useEffect(()=>{if(n&&s.current&&!i.current){const h=s.current,x=h.getContext("2d"),b=new Image;b.src=n,b.onload=()=>{x==null||x.drawImage(b,0,0,h.width,h.height),i.current=!0}}},[]);const a=h=>{const x=s.current;if(!x)return{x:0,y:0};const b=x.getBoundingClientRect();let y,L;return"touches"in h?(y=h.touches[0].clientX,L=h.touches[0].clientY):(y=h.clientX,L=h.clientY),{x:y-b.left,y:L-b.top}},c=h=>{"touches"in h&&h.preventDefault();const x=s.current;if(!x)return;const b=x.getContext("2d");if(!b)return;o(!0);const{x:y,y:L}=a(h);b.beginPath(),b.moveTo(y,L),b.lineWidth=2,b.lineCap="round",b.strokeStyle="#000"},d=h=>{if("touches"in h&&h.preventDefault(),!l)return;const x=s.current;if(!x)return;const b=x.getContext("2d");if(!b)return;const{x:y,y:L}=a(h);b.lineTo(y,L),b.stroke()},v=h=>{"touches"in h&&h.preventDefault(),l&&(o(!1),s.current&&t(s.current.toDataURL()))},u=()=>{const h=s.current;if(h){const x=h.getContext("2d");x==null||x.clearRect(0,0,h.width,h.height),t(""),i.current=!1}};return r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsxs("div",{className:"flex justify-between items-end",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),r.jsx("button",{type:"button",onClick:u,className:"text-xs text-red-500 hover:text-red-700 underline font-medium px-2 py-1",children:"Clear Signature"})]}),r.jsxs("div",{className:"border-2 border-gray-300 rounded-lg bg-white overflow-hidden relative shadow-sm",children:[r.jsx("canvas",{ref:s,width:400,height:160,className:"w-full h-40 bg-white cursor-crosshair touch-none block",onMouseDown:c,onMouseMove:d,onMouseUp:v,onMouseLeave:v,onTouchStart:c,onTouchMove:d,onTouchEnd:v}),r.jsx("div",{className:"absolute bottom-2 right-2 text-[10px] text-gray-300 pointer-events-none select-none",children:"Sign Above"})]})]})},os=({label:e,status:t,current:n,onClick:s,colorClass:l})=>{const o=t===n,i={green:o?"bg-green-600 text-white border-green-600":"bg-white text-green-700 border-green-200 hover:bg-green-50",red:o?"bg-red-600 text-white border-red-600":"bg-white text-red-700 border-red-200 hover:bg-red-50",yellow:o?"bg-amber-500 text-white border-amber-500":"bg-white text-amber-600 border-amber-200 hover:bg-amber-50",gray:o?"bg-slate-600 text-white border-slate-600":"bg-white text-slate-500 border-slate-200 hover:bg-slate-50"};return r.jsxs("button",{onClick:s,className:`relative py-2.5 px-1 rounded-lg border font-bold text-[10px] sm:text-xs transition-all flex flex-col items-center gap-1 ${i[l]} ${o?"shadow-md z-10":"shadow-sm"}`,children:[t===fe.GOOD&&r.jsx("span",{className:"text-base leading-none",children:""}),t===fe.BAD&&r.jsx("span",{className:"text-base leading-none",children:""}),t===fe.ATTENTION&&r.jsx("span",{className:"text-base leading-none",children:"!"}),t===fe.NIL&&r.jsx("span",{className:"text-base leading-none",children:""}),r.jsx("span",{className:"uppercase tracking-tight",children:e})]})},ec=({label:e,value:t,onChange:n,type:s="text",placeholder:l,error:o})=>r.jsxs("div",{children:[r.jsx("label",{className:`block text-xs font-bold uppercase mb-1.5 tracking-wide ${o?"text-red-600":"text-gray-500"}`,children:e}),r.jsx("input",{type:s,value:t,onChange:i=>n(i.target.value),placeholder:l,className:`w-full p-3.5 border rounded-lg focus:ring-2 focus:outline-none transition-all font-medium placeholder-gray-400
        ${o?"bg-red-50 border-red-300 focus:ring-red-200 text-red-900":"bg-gray-50 border-gray-200 focus:ring-blue-500 focus:bg-white text-gray-800"}
      `}),o&&r.jsx("p",{className:"text-[10px] text-red-500 font-bold mt-1 ml-1 animate-fadeIn",children:"This field is required"})]}),Po=({data:e,settings:t})=>r.jsxs("div",{className:"max-w-[210mm] mx-auto text-sm leading-tight text-gray-900 font-sans p-8 bg-white min-h-[297mm]",children:[r.jsxs("div",{className:"flex flex-col items-center mb-6",children:[r.jsx("div",{className:"flex flex-col items-center justify-center gap-2 mb-6 w-full",children:t.companyLogo?r.jsx("img",{src:t.companyLogo,alt:"Company Logo",className:"h-28 max-w-sm object-contain"}):r.jsx("div",{className:"text-center py-4",children:r.jsx("h1",{className:"text-3xl font-serif font-bold text-gray-900 tracking-wide",children:t.companyName||"Company Name"})})}),r.jsxs("div",{className:"w-full border-2 border-black mt-2",children:[r.jsxs("div",{className:"grid grid-cols-3 divide-x-2 divide-black border-b-2 border-black",children:[r.jsx("div",{className:"p-1.5 pl-2 font-medium text-sm",children:"Doc. No. MNT-F-015"}),r.jsx("div",{className:"p-1.5 pl-2 font-medium text-sm",children:"Revision No.: 01"}),r.jsxs("div",{className:"p-1.5 pl-2 font-medium text-sm",children:["Date/Time: ",new Date(e.timestamp).toLocaleString()]})]}),r.jsx("div",{className:"p-2 text-center font-black text-xl uppercase tracking-wide bg-gray-50",children:"GENERAL VEHICLE CHECKLIST"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-3 mb-6 p-4 border border-gray-300 text-xs",children:[r.jsxs("div",{className:"grid grid-cols-[100px_1fr] gap-2 items-center",children:[r.jsx("span",{className:"font-bold uppercase text-gray-600",children:"Reg No:"}),r.jsx("span",{className:"font-mono font-bold text-base border-b border-gray-300",children:e.truckNo||"N/A"})]}),r.jsxs("div",{className:"grid grid-cols-[100px_1fr] gap-2 items-center",children:[r.jsx("span",{className:"font-bold uppercase text-gray-600",children:"Trailer/Unit:"}),r.jsx("span",{className:"font-mono font-bold text-base border-b border-gray-300",children:e.trailerNo||"N/A"})]}),r.jsxs("div",{className:"grid grid-cols-[100px_1fr] gap-2 items-center",children:[r.jsx("span",{className:"font-bold uppercase text-gray-600",children:"Driver Name:"}),r.jsx("span",{className:"font-medium border-b border-gray-300",children:e.driverName||"N/A"})]}),r.jsxs("div",{className:"grid grid-cols-[100px_1fr] gap-2 items-center",children:[r.jsx("span",{className:"font-bold uppercase text-gray-600",children:"Inspected By:"}),r.jsx("span",{className:"font-medium border-b border-gray-300",children:e.inspectedBy||"N/A"})]}),r.jsxs("div",{className:"grid grid-cols-[100px_1fr] gap-2 items-center",children:[r.jsx("span",{className:"font-bold uppercase text-gray-600",children:"Location:"}),r.jsx("span",{className:"font-medium border-b border-gray-300",children:e.location||"N/A"})]}),r.jsxs("div",{className:"grid grid-cols-[100px_1fr] gap-2 items-center",children:[r.jsx("span",{className:"font-bold uppercase text-gray-600",children:"Odometer:"}),r.jsxs("span",{className:"font-medium border-b border-gray-300",children:[e.odometer||"N/A"," km"]})]})]}),r.jsx("div",{className:"mb-6",children:r.jsx("div",{className:"grid grid-cols-2 gap-x-8 gap-y-0 border-t border-gray-300",children:ol.map((n,s)=>{const l=e[n.id];let o="text-gray-900",i="";return l==="Bad"&&(o="text-red-700 font-bold",i="bg-red-50"),l==="Needs Attention"&&(o="text-amber-700 font-bold",i="bg-amber-50"),l==="Nil"&&(o="text-gray-400 italic"),r.jsxs("div",{className:`flex justify-between items-center border-b border-gray-300 py-1.5 px-2 text-xs ${i} ${s%2===0?"pr-4 border-r border-gray-300":"pl-4"}`,children:[r.jsx("span",{className:"text-gray-800 font-medium",children:n.label}),r.jsx("span",{className:`uppercase tracking-tighter ${o}`,children:l})]},n.id)})})}),r.jsxs("div",{className:"grid grid-cols-2 gap-12 mt-8 border-t-2 border-black pt-6 break-inside-avoid",children:[r.jsxs("div",{className:"text-center",children:[e.driverSignature?r.jsx("img",{src:e.driverSignature,className:"h-12 mx-auto mb-1",alt:"Driver Sig"}):r.jsx("div",{className:"h-12"}),r.jsx("p",{className:"border-t border-gray-400 pt-1 font-bold uppercase text-[10px] tracking-widest text-gray-600",children:"Driver Signature"})]}),r.jsxs("div",{className:"text-center",children:[e.inspectorSignature?r.jsx("img",{src:e.inspectorSignature,className:"h-12 mx-auto mb-1",alt:"Inspector Sig"}):r.jsx("div",{className:"h-12"}),r.jsx("p",{className:"border-t border-gray-400 pt-1 font-bold uppercase text-[10px] tracking-widest text-gray-600",children:"Inspector Signature"})]})]})]}),Mo=({data:e,settings:t})=>r.jsxs("div",{className:"max-w-[210mm] mx-auto text-sm leading-tight text-gray-900 font-sans p-8 bg-white min-h-[297mm]",children:[r.jsxs("div",{className:"border border-black mb-6",children:[r.jsxs("div",{className:"grid grid-cols-[120px_1fr_150px] divide-x divide-black border-b border-black",children:[r.jsx("div",{className:"p-2 flex items-center justify-center",children:t.companyLogo?r.jsx("img",{src:t.companyLogo,alt:"Logo",className:"w-20 object-contain"}):r.jsx("span",{className:"font-bold text-xs",children:t.companyName})}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("div",{className:"border-b border-black px-2 py-1 text-xs font-medium",children:"Doc No: MNT  F  002"}),r.jsx("div",{className:"flex-1 flex items-center justify-center p-2",children:r.jsx("h1",{className:"text-xl font-bold uppercase tracking-wider text-center",children:"PETROLEUM TANKER CHECKLIST"})})]}),r.jsxs("div",{className:"text-xs divide-y divide-black",children:[r.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[r.jsx("span",{className:"p-1 pl-2 border-r border-black",children:"Initial Issue Date"}),r.jsx("span",{className:"p-1 text-center",children:"03/02/2017"})]}),r.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[r.jsx("span",{className:"p-1 pl-2 border-r border-black",children:"Revision Date:"}),r.jsx("span",{className:"p-1 text-center",children:"01/02/2024"})]}),r.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[r.jsx("span",{className:"p-1 pl-2 border-r border-black",children:"Revision No."}),r.jsx("span",{className:"p-1 text-center",children:"05"})]}),r.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[r.jsx("span",{className:"p-1 pl-2 border-r border-black",children:"Next Revision:"}),r.jsx("span",{className:"p-1 text-center",children:"12/04/2026"})]})]})]}),r.jsx("div",{className:"bg-gray-50 p-4 text-xs font-mono border-b border-black",children:r.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"TRUCK #:"})," ",r.jsx("span",{className:"font-bold",children:e.truckNo})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"TRAILER #:"})," ",r.jsx("span",{className:"font-bold",children:e.trailerNo})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"JOB CARD #:"})," ",r.jsx("span",{className:"font-bold",children:e.jobCard})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"DATE/TIME:"})," ",r.jsx("span",{className:"font-bold",children:new Date(e.timestamp).toLocaleString()})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"ODOMETER:"})," ",r.jsx("span",{className:"font-bold",children:e.odometer})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"LOCATION:"})," ",r.jsx("span",{className:"font-bold",children:e.location})]})]})}),r.jsx("div",{className:"p-2 text-[10px] text-center font-medium border-black bg-gray-100 italic",children:"NA = Not Applicable, NI = Not Inspected, Tick to indicate status under Good Order or Needs Attention. If Tick Critical (Bad), The Truck Must Not Leave The Garage Until The Problem Has Been Fixed."})]}),r.jsxs("div",{className:"border border-black text-xs",children:[r.jsxs("div",{className:"grid grid-cols-[30px_1fr_60px_70px_60px_1fr] bg-gray-300 border-b border-black font-bold text-center items-center py-2",children:[r.jsx("span",{children:"No."}),r.jsx("span",{className:"text-left pl-2",children:"ITEM DESCRIPTION"}),r.jsx("span",{children:"Good Order"}),r.jsx("span",{children:"Needs Attn"}),r.jsx("span",{children:"Critical"}),r.jsx("span",{children:"COMMENTS"})]}),il.map((n,s)=>{const l=e[n.id],o=l===fe.GOOD,i=l===fe.ATTENTION,a=l===fe.BAD,c=n.label.split(". "),d=c[0]+".",v=c.slice(1).join(". ");return r.jsxs("div",{className:`grid grid-cols-[30px_1fr_60px_70px_60px_1fr] border-b border-gray-400 min-h-[30px] items-center ${s%2===0?"bg-white":"bg-gray-50"}`,children:[r.jsx("span",{className:"text-center font-medium",children:d}),r.jsx("span",{className:"pl-2 border-l border-gray-300 h-full flex items-center py-1",children:v}),r.jsx("span",{className:"border-l border-gray-300 h-full flex items-center justify-center font-bold text-green-600",children:o?"":""}),r.jsx("span",{className:"border-l border-gray-300 h-full flex items-center justify-center font-bold text-amber-600",children:i?"!":""}),r.jsx("span",{className:"border-l border-gray-300 h-full flex items-center justify-center font-bold text-red-600 bg-red-50",children:a?"X":""}),r.jsx("span",{className:"border-l border-gray-300 h-full flex items-center pl-2 italic text-gray-500 py-1",children:a?"CRITICAL FAULT":i?"Check required":""})]},n.id)})]}),r.jsxs("div",{className:"mt-6 border border-black p-2 min-h-[60px]",children:[r.jsx("span",{className:"font-bold underline",children:"Remarks:"})," ",e.remarks]}),r.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-8 text-xs",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1",children:[r.jsx("span",{children:"Inspected By:"})," ",r.jsx("span",{className:"font-bold",children:e.inspectedBy})]}),r.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1 items-end",children:[r.jsx("span",{children:"Inspector Sign:"}),e.inspectorSignature&&r.jsx("img",{src:e.inspectorSignature,className:"h-8",alt:"Sig"})]}),r.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1",children:[r.jsx("span",{children:"Date:"})," ",r.jsx("span",{children:new Date(e.timestamp).toLocaleDateString()})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1",children:[r.jsx("span",{children:"Driver Name:"})," ",r.jsx("span",{className:"font-bold",children:e.driverName})]}),r.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1 items-end",children:[r.jsx("span",{children:"Driver Sign:"}),e.driverSignature&&r.jsx("img",{src:e.driverSignature,className:"h-8",alt:"Sig"})]}),r.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1",children:[r.jsx("span",{children:"Date:"})," ",r.jsx("span",{children:new Date(e.timestamp).toLocaleDateString()})]})]})]})]}),Do=({data:e,settings:t})=>r.jsxs("div",{className:"max-w-[210mm] mx-auto text-sm leading-tight text-gray-900 font-sans p-8 bg-white min-h-[297mm]",children:[r.jsxs("div",{className:"border border-black mb-6",children:[r.jsxs("div",{className:"grid grid-cols-[120px_1fr_150px] divide-x divide-black border-b border-black",children:[r.jsx("div",{className:"p-2 flex items-center justify-center",children:t.companyLogo?r.jsx("img",{src:t.companyLogo,alt:"Logo",className:"w-20 object-contain"}):r.jsx("span",{className:"font-bold text-xs",children:t.companyName})}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("div",{className:"border-b border-black px-2 py-1 text-xs font-medium",children:"Doc No: MNT  F  002"}),r.jsx("div",{className:"flex-1 flex items-center justify-center p-2",children:r.jsx("h1",{className:"text-xl font-bold uppercase tracking-wider text-center",children:"PETROLEUM TANKER CHECKLIST"})})]}),r.jsxs("div",{className:"text-xs divide-y divide-black",children:[r.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[r.jsx("span",{className:"p-1 pl-2 border-r border-black",children:"Initial Issue Date"}),r.jsx("span",{className:"p-1 text-center",children:"03/02/2017"})]}),r.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[r.jsx("span",{className:"p-1 pl-2 border-r border-black",children:"Revision Date:"}),r.jsx("span",{className:"p-1 text-center",children:"15/03/2022"})]}),r.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[r.jsx("span",{className:"p-1 pl-2 border-r border-black",children:"Revision No."}),r.jsx("span",{className:"p-1 text-center",children:"05"})]}),r.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[r.jsx("span",{className:"p-1 pl-2 border-r border-black",children:"Next Review Date:"}),r.jsx("span",{className:"p-1 text-center",children:"15/04/2025"})]})]})]}),r.jsx("div",{className:"bg-gray-50 p-4 text-xs font-mono border-b border-black",children:r.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"TRUCK #:"})," ",r.jsx("span",{className:"font-bold",children:e.truckNo})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"TRAILER #:"})," ",r.jsx("span",{className:"font-bold",children:e.trailerNo})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"JOB CARD #:"})," ",r.jsx("span",{className:"font-bold",children:e.jobCard})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"DATE/TIME:"})," ",r.jsx("span",{className:"font-bold",children:new Date(e.timestamp).toLocaleString()})]})]})}),r.jsxs("div",{className:"p-2 text-[10px] text-center font-bold border-black bg-gray-100",children:["C = Compliant, NC = Non-Compliant, NA = Not Applicable, NI = Not Inspected (Tick Accordingly)",r.jsx("br",{}),"Critical = Do Not Release, Non-Critical = Waiver Applicable"]})]}),r.jsxs("div",{className:"border border-black text-xs mb-8",children:[r.jsxs("div",{className:"grid grid-cols-[30px_1fr_30px_30px_30px_30px_1fr] bg-gray-300 border-b border-black font-bold text-center items-center py-2",children:[r.jsx("span",{children:"No."}),r.jsx("span",{className:"text-left pl-2",children:"ITEM DESCRIPTION"}),r.jsx("span",{children:"C"}),r.jsx("span",{children:"NC"}),r.jsx("span",{children:"NI"}),r.jsx("span",{children:"NA"}),r.jsx("span",{children:"COMMENTS"})]}),al.map((n,s)=>{const l=e[n.id],o=l===fe.GOOD,i=l===fe.BAD,a=l===fe.NIL,c=l===fe.ATTENTION,d=n.label.split(". "),v=d[0],u=d.slice(1).join(". ");let h=null;return n.id==="petro2_1"&&(h="PRIME MOVER"),n.id==="petro2_16"&&(h="TRAILER/TANKS"),n.id==="petro2_33"&&(h="DRIVER"),n.id==="petro2_38"&&(h="SAFETY & WARNING SIGNS"),n.id==="petro2_45"&&(h="LICENCE & MANDATORY DOCUMENTS"),r.jsxs(fc.Fragment,{children:[h&&r.jsx("div",{className:"grid grid-cols-[1fr] bg-gray-200 border-b border-black font-bold px-2 py-1 text-center border-t-2 border-t-black",children:h}),r.jsxs("div",{className:`grid grid-cols-[30px_1fr_30px_30px_30px_30px_1fr] border-b border-gray-400 min-h-[30px] items-stretch ${s%2===0?"bg-white":"bg-gray-50"}`,children:[r.jsx("span",{className:"text-center font-medium py-1 border-r border-gray-300 flex items-center justify-center",children:v}),r.jsx("span",{className:"pl-2 border-r border-gray-300 flex items-center py-1",children:u}),r.jsx("span",{className:"border-r border-gray-300 flex items-center justify-center font-bold text-black",children:o?"":""}),r.jsx("span",{className:"border-r border-gray-300 flex items-center justify-center font-bold text-black",children:i?"":""}),r.jsx("span",{className:"border-r border-gray-300 flex items-center justify-center font-bold text-black",children:a?"":""}),r.jsx("span",{className:"border-r border-gray-300 flex items-center justify-center font-bold text-black",children:c?"":""}),r.jsx("span",{className:"flex items-center pl-2 italic text-gray-500 py-1",children:i?"NON-COMPLIANT":c?"N/A":""})]})]},n.id)})]}),r.jsxs("div",{className:"mt-6 border border-black p-2 min-h-[60px]",children:[r.jsx("span",{className:"font-bold underline",children:"Remarks:"})," ",e.remarks]}),r.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-8 text-xs",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1",children:[r.jsx("span",{children:"Inspected By:"})," ",r.jsx("span",{className:"font-bold",children:e.inspectedBy})]}),r.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1 items-end",children:[r.jsx("span",{children:"Inspector Sign:"}),e.inspectorSignature&&r.jsx("img",{src:e.inspectorSignature,className:"h-8",alt:"Sig"})]}),r.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1",children:[r.jsx("span",{children:"Date:"})," ",r.jsx("span",{children:new Date(e.timestamp).toLocaleDateString()})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1",children:[r.jsx("span",{children:"Driver Name:"})," ",r.jsx("span",{className:"font-bold",children:e.driverName})]}),r.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1 items-end",children:[r.jsx("span",{children:"Driver Sign:"}),e.driverSignature&&r.jsx("img",{src:e.driverSignature,className:"h-8",alt:"Sig"})]}),r.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1",children:[r.jsx("span",{children:"Date:"})," ",r.jsx("span",{children:new Date(e.timestamp).toLocaleDateString()})]})]})]})]}),Oo=({data:e,settings:t})=>r.jsxs("div",{className:"max-w-[210mm] mx-auto text-sm leading-tight text-gray-900 font-sans p-8 bg-white min-h-[297mm]",children:[r.jsx("div",{className:"border-2 border-black mb-4",children:r.jsxs("div",{className:"grid grid-cols-[120px_1fr_150px] divide-x-2 divide-black border-b-2 border-black",children:[r.jsx("div",{className:"p-2 flex items-center justify-center",children:t.companyLogo?r.jsx("img",{src:t.companyLogo,alt:"Logo",className:"w-24 object-contain"}):r.jsx("span",{className:"font-bold text-xs",children:t.companyName})}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("div",{className:"border-b-2 border-black px-2 py-1 text-xs font-medium",children:"Doc No: MNT  F  013"}),r.jsx("div",{className:"flex-1 flex items-center justify-center p-2 bg-gray-50",children:r.jsx("h1",{className:"text-xl font-black uppercase tracking-wider text-center",children:"ACID TANKER CHECKLIST"})})]}),r.jsxs("div",{className:"text-xs divide-y divide-black",children:[r.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[r.jsx("span",{className:"p-1 pl-2 border-r border-black font-semibold",children:"Initial Issue Date"}),r.jsx("span",{className:"p-1 text-center",children:"03/02/2017"})]}),r.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[r.jsx("span",{className:"p-1 pl-2 border-r border-black font-semibold",children:"Revision Date:"}),r.jsx("span",{className:"p-1 text-center",children:"15/03/2022"})]}),r.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[r.jsx("span",{className:"p-1 pl-2 border-r border-black font-semibold",children:"Revision No."}),r.jsx("span",{className:"p-1 text-center",children:"05"})]}),r.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[r.jsx("span",{className:"p-1 pl-2 border-r border-black font-semibold",children:"Next Revision:"}),r.jsx("span",{className:"p-1 text-center",children:"15/03/2023"})]})]})]})}),r.jsxs("div",{className:"mb-4 text-xs font-mono",children:[r.jsxs("div",{className:"flex flex-wrap gap-x-8 gap-y-2 mb-2",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx("span",{children:"Horse #:"})," ",r.jsx("span",{className:"font-bold border-b border-gray-400 min-w-[100px]",children:e.truckNo})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("span",{children:"Trailer #:"})," ",r.jsx("span",{className:"font-bold border-b border-gray-400 min-w-[100px]",children:e.trailerNo})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("span",{children:"Job Card #:"})," ",r.jsx("span",{className:"font-bold border-b border-gray-400 min-w-[100px]",children:e.jobCard})]})]}),r.jsxs("div",{className:"flex flex-wrap gap-x-8 gap-y-2",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx("span",{children:"Location:"})," ",r.jsx("span",{className:"font-bold border-b border-gray-400 min-w-[150px]",children:e.location})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("span",{children:"Inspection Date/Time:"})," ",r.jsx("span",{className:"font-bold border-b border-gray-400 min-w-[150px]",children:new Date(e.timestamp).toLocaleString()})]})]})]}),r.jsxs("div",{className:"border-2 border-black text-xs",children:[r.jsxs("div",{className:"grid grid-cols-[40px_1fr_120px] bg-white border-b-2 border-black font-bold items-center",children:[r.jsx("span",{className:"text-center py-2 border-r border-black",children:"S/N"}),r.jsx("span",{className:"text-left pl-2 py-2 border-r border-black",children:"ITEM"}),r.jsx("span",{className:"pl-2 py-2",children:"COMMENT"})]}),["PPE","VEHICLE","SPILL_KIT","DOCUMENTATION"].map(n=>{let s="",l=[];return n==="PPE"?(s="A. Personal Protective Equipment (PPE)",l=rr.filter(o=>o.category.includes("Personal"))):n==="VEHICLE"?(s="B. Vehicle (Horse & Trailer)",l=rr.filter(o=>o.category.includes("Vehicle"))):n==="SPILL_KIT"?(s="C. Spill Kit",l=rr.filter(o=>o.category.includes("Spill"))):n==="DOCUMENTATION"&&(s="D. Documentation",l=rr.filter(o=>o.category.includes("Documentation"))),r.jsxs(fc.Fragment,{children:[r.jsx("div",{className:"grid grid-cols-[1fr] border-b border-black bg-gray-100 font-bold px-2 py-1",children:s}),l.map((o,i)=>{const a=e[o.id],c=o.label.split(". "),d=c[0],v=c.slice(1).join(". ");let u="";return a===fe.GOOD?u="text-green-700 font-bold":a===fe.BAD?u="text-red-700 font-bold bg-red-50":a===fe.ATTENTION&&(u="text-amber-700 font-bold bg-amber-50"),r.jsxs("div",{className:"grid grid-cols-[40px_1fr_120px] border-b border-black items-stretch",children:[r.jsx("span",{className:"text-center py-1 border-r border-black flex items-center justify-center font-semibold",children:d}),r.jsx("span",{className:"pl-2 py-1 border-r border-black flex items-center",children:v}),r.jsx("span",{className:`pl-2 py-1 flex items-center ${u}`,children:a||"-"})]},o.id)})]},n)})]}),r.jsxs("div",{className:"mt-4 text-xs space-y-4",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx("span",{className:"font-semibold",children:"Remarks:"}),r.jsx("span",{className:"border-b border-black flex-1 border-dashed",children:e.remarks})]}),r.jsxs("div",{className:"flex gap-2 items-center",children:[r.jsx("span",{className:"font-semibold w-24",children:"Inspector:"}),r.jsx("span",{className:"border-b border-black flex-1 border-dashed",children:e.inspectedBy})]}),r.jsxs("div",{className:"flex gap-2 items-end",children:[r.jsx("span",{className:"font-semibold w-24",children:"Inspector Sig:"}),r.jsx("div",{className:"border-b border-black flex-1 border-dashed h-12",children:e.inspectorSignature&&r.jsx("img",{src:e.inspectorSignature,className:"h-full object-contain"})})]}),r.jsxs("div",{className:"flex gap-2 items-center",children:[r.jsx("span",{className:"font-semibold w-24",children:"Driver:"}),r.jsx("span",{className:"border-b border-black flex-1 border-dashed",children:e.driverName})]}),r.jsxs("div",{className:"flex gap-2 items-end",children:[r.jsx("span",{className:"font-semibold w-24",children:"Driver Sig:"}),r.jsx("div",{className:"border-b border-black flex-1 border-dashed h-12",children:e.driverSignature&&r.jsx("img",{src:e.driverSignature,className:"h-full object-contain"})})]})]}),r.jsxs("div",{className:"mt-6 text-xs",children:[r.jsx("p",{className:"font-bold mb-2",children:"Pictures of Damage/Broken/Disfigured etc.:"}),r.jsx("div",{className:"h-32 border border-black flex items-center justify-center bg-gray-50 mb-4",children:e.photoDamage?r.jsx("img",{src:e.photoDamage,className:"h-full object-contain"}):r.jsx("span",{className:"text-gray-400",children:"No damage photo"})}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-bold mb-1",children:"Front Picture:"}),r.jsx("div",{className:"h-32 border border-black flex items-center justify-center bg-gray-50",children:e.photoFront?r.jsx("img",{src:e.photoFront,className:"h-full object-contain"}):r.jsx("span",{className:"text-gray-400",children:"No photo"})})]}),r.jsxs("div",{children:[r.jsx("p",{className:"font-bold mb-1",children:"LS Picture:"}),r.jsx("div",{className:"h-32 border border-black flex items-center justify-center bg-gray-50",children:e.photoLS?r.jsx("img",{src:e.photoLS,className:"h-full object-contain"}):r.jsx("span",{className:"text-gray-400",children:"No photo"})})]}),r.jsxs("div",{children:[r.jsx("p",{className:"font-bold mb-1",children:"BS Picture:"}),r.jsx("div",{className:"h-32 border border-black flex items-center justify-center bg-gray-50",children:e.photoBack?r.jsx("img",{src:e.photoBack,className:"h-full object-contain"}):r.jsx("span",{className:"text-gray-400",children:"No photo"})})]}),r.jsxs("div",{children:[r.jsx("p",{className:"font-bold mb-1",children:"RS Picture:"}),r.jsx("div",{className:"h-32 border border-black flex items-center justify-center bg-gray-50",children:e.photoRS?r.jsx("img",{src:e.photoRS,className:"h-full object-contain"}):r.jsx("span",{className:"text-gray-400",children:"No photo"})})]})]})]})]}),Wm=({initialData:e,activeModule:t,validationLists:n,settings:s,onSaveDraft:l,onSubmit:o,onExit:i,submissionStatus:a,onViewReport:c})=>{const[d,v]=j.useState(e),[u,h]=j.useState(0),[x,b]=j.useState({}),y=(w,S)=>{v(P=>({...P,[w]:S})),x[w]&&b(P=>{const M={...P};return delete M[w],M})},L=w=>{let S=[],P=[];return t==="general"?P=ol:t==="petroleum"?P=il:t==="petroleum_v2"?P=al:t==="acid"&&(P=rr),t==="general"?(w===2&&(S=[J.PPE,J.DOCUMENTATION]),w===3&&(S=[J.VEHICLE_EXTERIOR,J.LIGHTS_ELECTRICAL]),w===4&&(S=[J.MECHANICAL,J.TRAILER])):t==="petroleum"?(w===2&&(S=[z.TRUCK_EQUIPMENT]),w===3&&(S=[z.TYRES,z.PPE_ID]),w===4&&(S=[z.DOCUMENTS,z.ONBOARD])):t==="petroleum_v2"?(w===2&&(S=[V.PRIME_MOVER]),w===3&&(S=[V.TRAILER_TANKS]),w===4&&(S=[V.DRIVER,V.SAFETY_SIGNS,V.DOCUMENTS])):t==="acid"&&(w===2&&(S=[q.PPE]),w===3&&(S=[q.VEHICLE]),w===4&&(S=[q.SPILL_KIT,q.DOCUMENTATION])),P.filter(M=>S.includes(M.category))},p=w=>{const S={};return w===0&&(d.truckNo||(S.truckNo=!0),d.trailerNo||(S.trailerNo=!0),d.driverName||(S.driverName=!0),d.location||(S.location=!0),d.odometer||(S.odometer=!0),t!=="general"&&!d.jobCard&&(S.jobCard=!0)),w>=2&&w<=4&&L(w).forEach(M=>{d[M.id]||(S[M.id]=!0)}),w===5&&((!d.remarks||d.remarks.trim()==="")&&(S.remarks=!0),(!d.rate||d.rate===0)&&(S.rate=!0),d.inspectorSignature||(S.inspectorSignature=!0),d.driverSignature||(S.driverSignature=!0)),Object.keys(S).length>0?(b(S),window.scrollTo({top:0,behavior:"smooth"}),!1):(b({}),!0)},f=()=>{for(let w=0;w<=5;w++)if(!p(w))return h(w),!1;return!0},m=()=>{p(u)&&(window.scrollTo({top:0,behavior:"smooth"}),h(w=>Math.min(w+1,en.length-1)))},g=()=>{u===0?i():(window.scrollTo({top:0,behavior:"smooth"}),h(w=>Math.max(w-1,0)))},C=()=>{f()&&o(d)},R=()=>r.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[d.requestId&&r.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-blue-600 p-4 rounded-xl shadow-lg flex items-center justify-between text-white border border-indigo-400",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-bold uppercase tracking-widest text-indigo-100",children:"Task Assignment"}),r.jsxs("p",{className:"text-sm font-bold",children:["Fulfilling Request #",d.requestId]})]})]}),r.jsx("span",{className:"text-[10px] bg-white text-indigo-600 px-2 py-1 rounded font-bold shadow-sm uppercase tracking-wide",children:"Priority Action"})]}),r.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[r.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[r.jsx("span",{className:"bg-blue-100 text-blue-700 p-2 rounded-lg",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0c0 .667.333 1 1 1v1m2-2c-.667 0-1 .333-1 1v1"})})}),"Vehicle & Driver Information"]}),r.jsx("div",{className:"text-xs text-red-500 font-medium mb-4",children:"* All fields in this section are required."}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsx(Xt,{label:"Truck/Vehicle Reg No. *",value:d.truckNo,onChange:w=>y("truckNo",w),options:n.trucks,placeholder:"e.g. AHB 1502 ZM",isRegNo:!0,error:x.truckNo}),r.jsx(Xt,{label:"Trailer/Unit Reg No. *",value:d.trailerNo,onChange:w=>y("trailerNo",w),options:n.trailers,placeholder:"e.g. AHB 1502 ZM",isRegNo:!0,error:x.trailerNo}),r.jsx(ec,{label:"Job Card #",value:d.jobCard||"",onChange:w=>y("jobCard",w),error:x.jobCard}),r.jsx(Xt,{label:"Inspected By (Name)",value:d.inspectedBy,onChange:w=>y("inspectedBy",w),options:n.inspectors,placeholder:"Auto-filled",isTitleCase:!0,readOnly:!0}),r.jsx(Xt,{label:"Driver Name *",value:d.driverName,onChange:w=>y("driverName",w),options:n.drivers,placeholder:"e.g. John Doe",isTitleCase:!0,error:x.driverName}),r.jsx(Xt,{label:"Current Location *",value:d.location,onChange:w=>y("location",w),options:n.locations,placeholder:"e.g. Lusaka, Zambia",isTitleCase:!0,error:x.location}),r.jsx(ec,{label:"Odometer Reading (km) *",type:"number",value:d.odometer,onChange:w=>y("odometer",w),error:x.odometer})]})]})]}),N=()=>r.jsx("div",{className:"space-y-6 animate-fadeIn",children:r.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[r.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"bg-blue-100 text-blue-700 p-2 rounded-lg",children:r.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})}),"Vehicle Photos"]}),r.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"Photos are optional but recommended for documentation."}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[r.jsx(tn,{label:"Front View",existingImage:d.photoFront,onCapture:w=>y("photoFront",w)}),r.jsx(tn,{label:"Left Side (LS)",existingImage:d.photoLS,onCapture:w=>y("photoLS",w)}),r.jsx(tn,{label:"Right Side (RS)",existingImage:d.photoRS,onCapture:w=>y("photoRS",w)}),r.jsx(tn,{label:"Back View",existingImage:d.photoBack,onCapture:w=>y("photoBack",w)})]})]})}),k=w=>{const S=L(u).filter(M=>w.includes(M.category)),P={};return w.forEach(M=>{P[M]=S.filter(U=>U.category===M)}),r.jsx("div",{className:"space-y-8 animate-fadeIn",children:w.map(M=>r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[r.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-100 flex justify-between items-center",children:[r.jsx("h3",{className:"text-lg font-bold text-blue-900",children:M}),r.jsx("span",{className:"text-[10px] text-red-500 font-bold uppercase tracking-wider",children:"Required"})]}),r.jsx("div",{className:"p-4 md:p-6 space-y-6",children:P[M].map(U=>r.jsxs("div",{className:`flex flex-col gap-3 pb-6 border-b border-gray-50 last:border-0 last:pb-0 ${x[U.id]?"p-3 rounded-lg bg-red-50 ring-1 ring-red-300":""}`,children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("span",{className:`font-semibold text-base ${x[U.id]?"text-red-800":"text-gray-800"}`,children:[U.label," ",r.jsx("span",{className:"text-red-500",children:"*"})]}),x[U.id]&&r.jsx("span",{className:"text-[10px] text-red-600 font-bold uppercase tracking-wider bg-white px-2 py-1 rounded border border-red-200 shadow-sm",children:"Action Required"})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[r.jsx(os,{label:"Good",status:fe.GOOD,current:d[U.id],onClick:()=>y(U.id,fe.GOOD),colorClass:"green"}),r.jsx(os,{label:"Bad",status:fe.BAD,current:d[U.id],onClick:()=>y(U.id,fe.BAD),colorClass:"red"}),r.jsx(os,{label:"Attn",status:fe.ATTENTION,current:d[U.id],onClick:()=>y(U.id,fe.ATTENTION),colorClass:"yellow"}),r.jsx(os,{label:"Nil",status:fe.NIL,current:d[U.id],onClick:()=>y(U.id,fe.NIL),colorClass:"gray"})]})]},U.id))})]},M))})},I=()=>r.jsx("div",{className:"space-y-6 animate-fadeIn",children:r.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:"Finalize Inspection"}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("label",{className:`block text-sm font-bold mb-2 ${x.remarks?"text-red-600":"text-gray-700"}`,children:["Remarks / Observations ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("textarea",{className:`w-full p-4 border rounded-lg h-32 outline-none transition-all
                 ${x.remarks?"border-red-300 ring-2 ring-red-200 bg-red-50 placeholder-red-300":"border-gray-300 focus:ring-2 focus:ring-blue-500"}
              `,placeholder:"Enter observations...",value:d.remarks,onChange:w=>y("remarks",w.target.value)}),x.remarks&&r.jsx("p",{className:"text-xs text-red-500 mt-1 font-bold",children:"Please provide remarks"})]}),r.jsx("div",{className:"mb-8",children:r.jsx(tn,{label:"Picture of Damage / Defects (Optional)",existingImage:d.photoDamage,onCapture:w=>y("photoDamage",w)})}),r.jsxs("div",{className:"mb-8",children:[r.jsxs("label",{className:`block text-sm font-bold mb-3 ${x.rate?"text-red-600":"text-gray-700"}`,children:["Overall Vehicle Rating ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("div",{className:`flex gap-2 sm:gap-4 justify-between sm:justify-start p-2 rounded-xl transition-colors ${x.rate?"bg-red-50 ring-1 ring-red-200":""}`,children:[1,2,3,4,5].map(w=>r.jsx("button",{type:"button",onClick:()=>y("rate",w),className:`flex-1 sm:flex-none w-12 h-12 rounded-lg font-bold text-lg transition-all ${d.rate===w?"bg-blue-600 text-white shadow-lg":"bg-gray-100 text-gray-500 hover:bg-gray-200"}`,children:w},w))}),x.rate&&r.jsx("p",{className:"text-xs text-red-500 mt-1 font-bold",children:"Rating required"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 pt-6 border-t border-gray-100",children:[r.jsxs("div",{className:x.inspectorSignature?"p-2 bg-red-50 rounded-lg border border-red-200":"",children:[r.jsx(Za,{label:"Inspector Signature",existingSignature:d.inspectorSignature,onSave:w=>y("inspectorSignature",w)}),x.inspectorSignature&&r.jsx("p",{className:"text-xs text-red-600 mt-1 font-bold animate-pulse",children:"Signature Required"})]}),r.jsxs("div",{className:x.driverSignature?"p-2 bg-red-50 rounded-lg border border-red-200":"",children:[r.jsx(Za,{label:"Driver Signature",existingSignature:d.driverSignature,onSave:w=>y("driverSignature",w)}),x.driverSignature&&r.jsx("p",{className:"text-xs text-red-600 mt-1 font-bold animate-pulse",children:"Signature Required"})]})]})]})}),E=()=>r.jsxs("div",{className:"space-y-6 animate-fadeIn pb-12",children:[r.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg border border-gray-200 text-center",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Inspection Ready"}),r.jsx("p",{className:"text-gray-500",children:"Please review the report below."}),r.jsx("button",{onClick:()=>c(d),className:"mt-4 px-6 py-2 bg-blue-50 text-blue-600 rounded-lg font-bold text-sm hover:bg-blue-100 transition-colors",children:"View Full Screen Preview"})]}),r.jsxs("div",{className:"mt-8 bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:[r.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:r.jsx("h3",{className:"font-bold text-gray-700",children:"Document Preview"})}),r.jsx("div",{className:"p-4 overflow-x-auto bg-gray-100 flex justify-center",children:r.jsx("div",{className:"bg-white shadow-xl transform scale-75 md:scale-100 transition-transform origin-top",children:t==="petroleum"?r.jsx(Mo,{data:d,settings:s}):t==="petroleum_v2"?r.jsx(Do,{data:d,settings:s}):t==="acid"?r.jsx(Oo,{data:d,settings:s}):r.jsx(Po,{data:d,settings:s})})})]}),r.jsxs("div",{className:"mt-8 bg-emerald-950 rounded-2xl p-8 text-white shadow-2xl relative overflow-hidden group",children:[r.jsx("div",{className:"absolute inset-0 bg-emerald-900/50 transform skew-y-12 opacity-0 group-hover:opacity-100 transition-opacity"}),r.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center justify-between gap-6",children:[r.jsxs("div",{className:"text-center md:text-left",children:[r.jsx("h3",{className:"text-2xl font-bold mb-2 text-emerald-100",children:"Ready to Submit?"}),r.jsxs("p",{className:"text-emerald-400 text-sm max-w-md",children:["This will finalize the inspection record and upload it to the ",t==="petroleum"?"Petroleum":t==="petroleum_v2"?"Petroleum_V2":t==="acid"?"Acid":"General"," Database."]}),!navigator.onLine&&r.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 bg-amber-500/20 text-amber-300 px-3 py-1 rounded-full text-xs font-bold border border-amber-500/30",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M18.364 5.636a9 9 0 010 12.728m0 0l-2.829-2.829m2.829 2.829L21 21M15.536 8.464a5 5 0 010 7.072m0 0l-2.829-2.829m-4.243 2.829a4.978 4.978 0 01-1.414-2.83m-1.414 5.658a9 9 0 01-2.167-9.238m7.824 2.167a1 1 0 111.414 1.414m-1.414-1.414L3 3m8.293 8.293l1.414 1.414"})}),"Offline Mode: Will save to device"]})]}),r.jsx("div",{className:"flex flex-col gap-3 w-full md:w-auto",children:r.jsxs("button",{onClick:C,disabled:a!=="idle",className:`w-full md:w-auto px-10 py-5 text-white rounded-2xl font-black text-xl shadow-xl transition-all flex items-center justify-center gap-3 transform hover:scale-105 active:scale-95 border-2 border-white/20
                       ${a!=="idle"?"bg-gray-600 cursor-wait":"bg-emerald-500 hover:bg-emerald-400"}
                    `,children:[a==="submitting"?"Processing...":a==="offline_saved"?"Saved Offline":"SUBMIT INSPECTION",a==="idle"&&r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})]})})]})]})]});return r.jsxs("div",{className:"flex flex-col min-h-screen",children:[r.jsxs("div",{className:"bg-white border-b border-gray-200 sticky top-14 md:top-16 z-30",children:[r.jsx("div",{className:"overflow-x-auto scrollbar-hide",children:r.jsx("div",{className:"flex px-4 py-3 min-w-max",children:en.map((w,S)=>{const P=S===u,M=S<u;return r.jsxs("div",{className:"flex items-center",children:[r.jsxs("div",{className:"flex flex-col items-center gap-1 cursor-default",children:[r.jsx("div",{className:`
                                w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold transition-all
                                ${P?"bg-emerald-600 text-white shadow-md":M?"bg-emerald-100 text-emerald-700":"bg-gray-100 text-gray-400"}
                            `,children:M?"":S+1}),r.jsx("span",{className:`text-[10px] uppercase font-bold tracking-wide ${P?"text-emerald-700":"text-gray-400"}`,children:w.title})]}),S<en.length-1&&r.jsx("div",{className:`h-0.5 w-8 md:w-16 mx-2 ${M?"bg-emerald-200":"bg-gray-100"}`})]},w.id)})})}),r.jsxs("div",{className:"md:hidden flex items-center gap-2 px-4 py-2 bg-emerald-900 text-white text-xs font-medium",children:[r.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-400 animate-pulse"}),en[u].label]})]}),r.jsxs("div",{className:"flex-1 p-4 md:p-8 max-w-5xl mx-auto w-full",children:[u===0&&R(),u===1&&N(),t==="general"&&u===2&&k([J.PPE,J.DOCUMENTATION]),t==="general"&&u===3&&k([J.VEHICLE_EXTERIOR,J.LIGHTS_ELECTRICAL]),t==="general"&&u===4&&k([J.MECHANICAL,J.TRAILER]),t==="petroleum"&&u===2&&k([z.TRUCK_EQUIPMENT]),t==="petroleum"&&u===3&&k([z.TYRES,z.PPE_ID]),t==="petroleum"&&u===4&&k([z.DOCUMENTS,z.ONBOARD]),t==="petroleum_v2"&&u===2&&k([V.PRIME_MOVER]),t==="petroleum_v2"&&u===3&&k([V.TRAILER_TANKS]),t==="petroleum_v2"&&u===4&&k([V.DRIVER,V.SAFETY_SIGNS,V.DOCUMENTS]),t==="acid"&&u===2&&k([q.PPE]),t==="acid"&&u===3&&k([q.VEHICLE]),t==="acid"&&u===4&&k([q.SPILL_KIT,q.DOCUMENTATION]),u===5&&I(),u===6&&E()]}),r.jsx("footer",{className:"bg-white border-t border-gray-200 p-4 sticky bottom-0 z-30 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]",children:r.jsxs("div",{className:"max-w-5xl mx-auto flex flex-col sm:flex-row justify-between gap-4",children:[r.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[r.jsx("button",{onClick:g,className:"flex-1 sm:flex-none px-6 py-3 rounded-xl border border-gray-300 font-semibold text-gray-600 hover:bg-gray-50 transition",children:u===0?"Cancel":"Back"}),r.jsxs("button",{onClick:()=>l(d),className:"flex-1 sm:flex-none px-6 py-3 rounded-xl border border-blue-200 bg-blue-50 text-blue-700 font-semibold hover:bg-blue-100 transition flex items-center justify-center gap-2",title:"Save progress and exit",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),r.jsx("span",{className:"hidden sm:inline",children:"Save Draft"}),r.jsx("span",{className:"sm:hidden",children:"Draft"})]})]}),u<en.length-1?r.jsx("button",{onClick:m,className:"flex-1 sm:flex-none px-6 py-3 rounded-xl bg-emerald-600 text-white font-bold hover:bg-emerald-700 shadow-lg shadow-emerald-200 transition flex items-center justify-center gap-2",children:"Next Section"}):r.jsx("div",{className:"flex-1 flex items-center justify-end text-sm font-medium text-gray-500",children:"Review & Submit above"})]})})]})},Hm=({tickets:e,isLoading:t,onRefresh:n,onSelect:s,isAdmin:l,filterStatus:o})=>{const i=j.useMemo(()=>o==="ALL"?e:o==="OPEN"?e.filter(a=>a.status==="Open"||a.status==="In Progress"):o==="CLOSED"?e.filter(a=>a.status==="Resolved"||a.status==="Closed"):e,[e,o]);return r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden min-h-[400px] flex flex-col",children:[r.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-slate-50",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("h3",{className:"font-bold text-gray-700 text-sm",children:o==="ALL"?"All Tickets":o==="OPEN"?"Open & In Progress":"Resolved & Closed"}),r.jsx("span",{className:"text-xs bg-slate-200 text-slate-600 px-2 py-0.5 rounded-full font-bold",children:i.length})]}),r.jsxs("button",{onClick:n,className:"text-xs flex items-center gap-1 text-blue-600 hover:text-blue-800 font-medium",children:[r.jsx("svg",{className:`w-3 h-3 ${t?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh List"]})]}),t&&i.length===0?r.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-12 text-gray-400",children:[r.jsx("div",{className:"w-8 h-8 border-4 border-blue-100 border-t-blue-500 rounded-full animate-spin mb-4"}),r.jsx("p",{className:"text-sm",children:"Retrieving tickets..."})]}):i.length===0?r.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-12 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-4 text-slate-300",children:r.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),r.jsx("p",{className:"text-gray-500 font-medium",children:"No tickets found in this view."}),r.jsx("p",{className:"text-xs text-gray-400 mt-2 max-w-xs",children:"Change the filter or create a new ticket."})]}):r.jsx("div",{className:"divide-y divide-gray-100 overflow-y-auto max-h-[500px]",children:i.map(a=>r.jsxs("div",{onClick:()=>s(a),className:"p-4 hover:bg-slate-50 cursor-pointer transition flex items-center justify-between group",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded-full border 
                                        ${a.status==="Open"?"bg-blue-50 text-blue-600 border-blue-100":a.status==="Resolved"?"bg-green-50 text-green-600 border-green-100":a.status==="Closed"?"bg-gray-100 text-gray-600 border-gray-200":"bg-amber-50 text-amber-600 border-amber-100"}`,children:a.status}),r.jsxs("span",{className:"text-xs font-mono text-gray-400",children:["#",a.ticketId]}),r.jsxs("span",{className:"text-xs text-gray-400",children:[" ",new Date(a.timestamp).toLocaleDateString()]}),a.assignedTo&&l&&r.jsxs("span",{className:"text-[10px] bg-slate-100 px-2 py-0.5 rounded text-slate-600 border border-slate-200",children:["Assigned: ",a.assignedTo]})]}),r.jsx("h4",{className:"font-bold text-gray-800 text-sm truncate",children:a.subject}),r.jsx("p",{className:"text-xs text-gray-500 truncate mt-0.5",children:a.description})]}),r.jsx("div",{className:"text-gray-300 group-hover:text-blue-500 transition-colors",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]},a.ticketId))})]})},$m=({ticket:e,currentUser:t,isAdmin:n,isSuperAdmin:s,onClose:l,onStatusChange:o,onReassign:i,onReply:a,isSendingReply:c,agents:d})=>{var k;const[v,u]=j.useState(""),[h,x]=j.useState(""),[b,y]=j.useState(!1),L=j.useRef(null),p={Open:"bg-blue-500","In Progress":"bg-amber-500",Resolved:"bg-green-500",Closed:"bg-gray-500"};j.useEffect(()=>{var I;(I=L.current)==null||I.scrollIntoView({behavior:"smooth"})},[e.comments]);const f=()=>{v.trim()&&(a(v),u(""))},m=async()=>{h&&(y(!0),await i(h),y(!1),x(""))},g=e.comments.length>0?e.comments[e.comments.length-1]:null,C=e.status==="Resolved"||e.status==="Closed",R=!C&&(n||g&&(g.role==="Admin"||g.role==="SuperAdmin"));let N="Type a reply...";return C?N="Ticket is closed. No further replies allowed.":!R&&!n&&(N="Awaiting admin review..."),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden flex flex-col h-[calc(100vh-200px)] min-h-[500px]",children:[r.jsxs("div",{className:"bg-slate-50 px-6 py-4 border-b border-gray-200 flex flex-col md:flex-row justify-between items-start md:items-center gap-3 shrink-0",children:[r.jsxs("div",{children:[r.jsxs("button",{onClick:l,className:"text-xs font-bold text-gray-500 hover:text-gray-800 flex items-center gap-1 mb-2",children:[r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})," Back"]}),r.jsx("h3",{className:"font-bold text-lg text-gray-800 line-clamp-1",children:e.subject}),r.jsxs("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[r.jsxs("span",{className:"text-xs font-mono text-gray-400",children:["#",e.ticketId]}),r.jsx("span",{className:`w-2 h-2 rounded-full ${p[e.status]||"bg-gray-400"}`}),r.jsx("span",{className:"text-xs text-gray-500",children:e.status}),e.assignedTo&&r.jsxs("span",{className:"text-[10px] bg-indigo-50 text-indigo-600 px-2 py-0.5 rounded border border-indigo-100 ml-2",children:["Agent: ",e.assignedTo]})]})]}),n&&r.jsxs("div",{className:"flex flex-col gap-2 w-full md:w-auto",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase",children:"Status"}),r.jsxs("select",{value:e.status,onChange:I=>o(I.target.value),className:"text-xs border border-gray-300 rounded-lg px-2 py-1.5 bg-white font-medium outline-none focus:ring-2 focus:ring-blue-500 w-full md:w-auto",children:[r.jsx("option",{value:"Open",children:"Open"}),r.jsx("option",{value:"In Progress",children:"In Progress"}),r.jsx("option",{value:"Resolved",children:"Resolved"}),r.jsx("option",{value:"Closed",children:"Closed"})]})]}),s&&r.jsxs("div",{className:"flex items-center gap-2 mt-1 pt-2 border-t border-slate-200 w-full md:w-64",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:r.jsx("svg",{className:"w-3.5 h-3.5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),r.jsxs("select",{className:"w-full pl-8 pr-3 py-1.5 text-xs border border-gray-300 rounded-lg bg-white font-medium outline-none focus:ring-2 focus:ring-indigo-500 appearance-none",value:h,onChange:I=>x(I.target.value),children:[r.jsx("option",{value:"",children:"Reassign Agent..."}),d.map(I=>r.jsx("option",{value:I,children:I},I))]}),r.jsx("div",{className:"absolute inset-y-0 right-0 pr-2 flex items-center pointer-events-none",children:r.jsx("svg",{className:"w-3 h-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]}),r.jsx("button",{onClick:m,disabled:b||!h,className:"bg-indigo-600 hover:bg-indigo-700 text-white p-1.5 rounded-lg disabled:opacity-50 transition-colors shadow-sm shrink-0",title:"Confirm Assignment",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})})]})]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 space-y-6 bg-slate-50/50",children:[r.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-6 h-6 rounded-full bg-slate-200 flex items-center justify-center text-[10px] font-bold text-slate-600",children:e.user.charAt(0)}),r.jsx("span",{className:"text-sm font-bold text-gray-700",children:e.user}),r.jsx("span",{className:"text-[10px] text-gray-400",children:new Date(e.timestamp).toLocaleString()})]}),r.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-400",children:"Original Request"})]}),r.jsx("p",{className:"text-sm text-gray-600 leading-relaxed whitespace-pre-wrap",children:e.description}),e.attachment&&r.jsxs("div",{className:"mt-4",children:[r.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase mb-1",children:"Attachment"}),r.jsx("img",{src:e.attachment,alt:"Attachment",className:"max-h-48 rounded-lg border border-gray-200"})]})]}),(k=e.comments)==null?void 0:k.map((I,E)=>{const w=I.user===(t==null?void 0:t.name),S=I.role==="Admin"||I.role==="SuperAdmin",P=S?"Support Admin":I.user;return r.jsxs("div",{className:`flex gap-3 ${w?"flex-row-reverse":""}`,children:[r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold text-white shadow-sm shrink-0 mt-1
                                ${S?"bg-indigo-600":"bg-slate-400"}`,children:S?"SA":I.user.charAt(0)}),r.jsxs("div",{className:`max-w-[85%] md:max-w-[70%] rounded-2xl p-4 shadow-sm text-sm ${w?"bg-blue-600 text-white rounded-tr-none":"bg-white border border-gray-100 text-gray-700 rounded-tl-none"}`,children:[r.jsxs("div",{className:`text-[10px] font-bold mb-1 opacity-70 ${w?"text-blue-100":"text-gray-400"}`,children:[P,"  ",new Date(I.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),r.jsx("p",{className:"leading-relaxed break-words",children:I.message})]})]},E)}),r.jsx("div",{ref:L})]}),r.jsx("div",{className:"p-4 bg-white border-t border-gray-200 shrink-0",children:r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"text",className:`flex-1 border border-gray-300 rounded-xl px-4 py-3 text-sm outline-none focus:ring-2 focus:ring-indigo-500 transition
                            ${C||!R&&!n?"bg-gray-100 text-gray-500 cursor-not-allowed":"bg-white"}
                        `,placeholder:N,value:v,onChange:I=>u(I.target.value),onKeyDown:I=>I.key==="Enter"&&!C&&(R||n)&&f(),disabled:C||!R&&!n}),r.jsx("button",{onClick:f,disabled:c||!v.trim()||C||!R&&!n,className:"bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl px-6 py-2 font-bold transition disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-400",children:c?"...":"Send"})]})})]})},Um=({appScriptUrl:e,currentUser:t,showToast:n,settings:s,validationLists:l})=>{const[o,i]=j.useState("create"),[a,c]=j.useState(null),[d,v]=j.useState("ALL"),[u,h]=j.useState("Issue"),[x,b]=j.useState(""),[y,L]=j.useState(""),[p,f]=j.useState("Medium"),[m,g]=j.useState(!1),[C,R]=j.useState(""),[N,k]=j.useState([]),[I,E]=j.useState([]),[w,S]=j.useState(!1),[P,M]=j.useState(!1),U=(t==null?void 0:t.role)==="Admin"||(t==null?void 0:t.role)==="SuperAdmin",Y=(t==null?void 0:t.role)==="SuperAdmin",Q=N.filter(D=>D.status==="Open"||D.status==="In Progress").length,_=N.filter(D=>D.status==="Resolved"||D.status==="Closed").length;j.useEffect(()=>{const D=`sc_support_tickets_${t==null?void 0:t.username}`,K=localStorage.getItem(D);if(K)try{const te=JSON.parse(K);k(te)}catch{}H(),U&&W()},[]),j.useEffect(()=>{if(N.length>0&&(t!=null&&t.username)){const D=`sc_support_tickets_${t==null?void 0:t.username}`;localStorage.setItem(D,JSON.stringify(N))}},[N,t]);const W=async()=>{if(e)try{const K=await(await fetch(e,{method:"POST",body:JSON.stringify({action:"get_users"})})).json();if(K.status==="success"&&K.users){const te=K.users.filter(Z=>["Admin","SuperAdmin","Inspector"].includes(Z.role)).map(Z=>Z.name).filter(Z=>Z);E([...new Set(te)].sort())}}catch(D){console.error("Failed to fetch agents",D)}},B=D=>{var te;const K=(te=D.target.files)==null?void 0:te[0];if(K){const Z=new FileReader;Z.onloadend=()=>{R(Z.result),n("Image attached","info")},Z.readAsDataURL(K)}},H=async(D=0)=>{if(!(!e||!t)){N.length===0&&D===0&&S(!0);try{const te=await(await fetch(e,{method:"POST",body:JSON.stringify({action:"get_tickets",email:t.username.toLowerCase().trim(),role:t.role})})).json();te.status==="success"&&te.tickets&&k(te.tickets)}catch(K){console.error("Ticket fetch failed",K)}finally{S(!1)}}},F=async D=>{if(D.preventDefault(),!e){n("System offline. Please check settings.","error");return}g(!0);try{const K={action:"submit_support_ticket",type:u,subject:x,description:y,priority:p,user:(t==null?void 0:t.name)||"Anonymous",email:((t==null?void 0:t.username)||"N/A").toLowerCase().trim(),role:(t==null?void 0:t.role)||"N/A",attachment:C},Z=await(await fetch(e,{method:"POST",body:JSON.stringify(K)})).json();if(Z.status==="success"){n(`Ticket #${Z.ticketId} created successfully.`,"success");const ge={ticketId:Z.ticketId,type:u,subject:x,description:y,priority:p,user:(t==null?void 0:t.name)||"Me",email:(t==null?void 0:t.username)||"",role:(t==null?void 0:t.role)||"User",timestamp:new Date().toISOString(),status:"Open",comments:[],attachment:C};k(it=>[ge,...it]),b(""),L(""),f("Medium"),R(""),v("ALL"),i("list"),setTimeout(()=>H(),1e3)}else throw new Error(Z.message||"Unknown error")}catch{n("Failed to submit ticket. Please check connection.","error")}finally{g(!1)}},$=async D=>{if(!a)return;M(!0);const K={user:(t==null?void 0:t.name)||"User",role:(t==null?void 0:t.role)||"User",message:D,timestamp:new Date().toISOString()};try{await fetch(e,{method:"POST",body:JSON.stringify({action:"update_ticket",ticketId:a.ticketId,comment:K}),mode:"no-cors"});const te={...a,comments:[...a.comments||[],K]};c(te),k(Z=>Z.map(ge=>ge.ticketId===te.ticketId?te:ge))}catch{n("Failed to send reply","error")}finally{M(!1)}},X=async D=>{if(a)try{await fetch(e,{method:"POST",body:JSON.stringify({action:"update_ticket",ticketId:a.ticketId,status:D}),mode:"no-cors"});const K={...a,status:D};c(K),k(te=>te.map(Z=>Z.ticketId===K.ticketId?K:Z)),n(`Status updated to ${D}`,"success")}catch{n("Failed to update status","error")}},G=async D=>{if(a)try{await fetch(e,{method:"POST",body:JSON.stringify({action:"update_ticket",ticketId:a.ticketId,assignedTo:D}),mode:"no-cors"});const K={...a,assignedTo:D};c(K),k(te=>te.map(Z=>Z.ticketId===K.ticketId?K:Z)),n(`Ticket reassigned to ${D}`,"success")}catch{n("Failed to reassign ticket","error")}},ie=async()=>{const D=(s==null?void 0:s.companyName)||"SafetyCheck Pro",K=(s==null?void 0:s.webAppUrl)||window.location.origin+window.location.pathname,te=(s==null?void 0:s.mobileApkLink)||"Contact Admin for APK",Z=`Access ${D}`,ge=`System Access Details:

Web Portal: ${K}
Mobile App: ${te}

Demo Credentials:
User: admin
Pass: 123456`;if(navigator.share)try{await navigator.share({title:Z,text:ge}),n("Shared successfully!","success")}catch{}else navigator.clipboard.writeText(ge).then(()=>n("Copied details","success"))};return r.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 animate-fadeIn pb-12",children:[r.jsx("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:r.jsxs("div",{children:[r.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-lg bg-indigo-600 text-white flex items-center justify-center shadow-lg",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z"})})}),"Help & Support Hub"]}),r.jsx("p",{className:"text-gray-500 text-sm mt-1 ml-14",children:"Get assistance, track tickets, or share the system."})]})}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[r.jsxs("div",{className:"lg:col-span-2",children:[r.jsxs("div",{className:"flex bg-white p-1 rounded-xl border border-gray-200 shadow-sm mb-6 w-full md:w-auto self-start",children:[r.jsxs("button",{onClick:()=>{i("create"),c(null)},className:`flex-1 md:flex-none px-6 py-3 rounded-lg text-sm font-bold transition-all flex items-center justify-center gap-2 ${o==="create"?"bg-indigo-50 text-indigo-700 shadow-sm":"text-gray-500 hover:bg-gray-50"}`,children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"New Request"]}),r.jsxs("div",{className:`flex items-center rounded-lg ml-1 border transition-colors ${o==="list"?"bg-indigo-50 border-indigo-100":"bg-white border-transparent"}`,children:[r.jsxs("button",{onClick:()=>{i("list"),v("ALL"),H()},className:`px-4 py-3 text-sm font-bold transition-colors rounded-l-lg hover:text-indigo-700 flex items-center gap-2 ${o==="list"&&d==="ALL"?"text-indigo-800":"text-gray-500"}`,children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"My Tickets"]}),(Q>0||_>0)&&r.jsxs("div",{className:"flex items-center pr-2 gap-1 border-l border-indigo-200/50 pl-2 h-6",children:[Q>0&&r.jsxs("button",{onClick:D=>{D.stopPropagation(),i("list"),v("OPEN")},className:`text-[10px] font-bold px-2 py-0.5 rounded-full transition-all hover:scale-105 ${d==="OPEN"&&o==="list"?"bg-blue-600 text-white shadow-md":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,children:[Q," Open"]}),_>0&&r.jsxs("button",{onClick:D=>{D.stopPropagation(),i("list"),v("CLOSED")},className:`text-[10px] font-bold px-2 py-0.5 rounded-full transition-all hover:scale-105 ${d==="CLOSED"&&o==="list"?"bg-gray-700 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[_," Closed"]})]})]})]}),o==="create"&&r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden animate-fadeIn",children:[r.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-100",children:[r.jsx("h3",{className:"font-bold text-gray-800 text-lg",children:"Submit a Request"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Report a bug or request a new feature."})]}),r.jsx("div",{className:"p-6",children:r.jsxs("form",{onSubmit:F,className:"space-y-5",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-1",children:"Request Type"}),r.jsxs("select",{className:"w-full p-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none text-sm font-medium",value:u,onChange:D=>h(D.target.value),children:[r.jsx("option",{value:"Issue",children:"Report an Issue (Bug)"}),r.jsx("option",{value:"Feature",children:"Request a Feature"}),r.jsx("option",{value:"Other",children:"Other Inquiry"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-1",children:"Priority"}),r.jsxs("select",{className:"w-full p-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none text-sm font-medium",value:p,onChange:D=>f(D.target.value),children:[r.jsx("option",{value:"Low",children:"Low - Minor Tweak"}),r.jsx("option",{value:"Medium",children:"Medium - Standard"}),r.jsx("option",{value:"High",children:"High - Urgent"}),r.jsx("option",{value:"Critical",children:"Critical - System Down"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-1",children:"Subject"}),r.jsx("input",{type:"text",required:!0,className:"w-full p-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none text-sm font-medium placeholder-gray-400",placeholder:"Brief summary of the issue or idea",value:x,onChange:D=>b(D.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-1",children:"Description"}),r.jsx("textarea",{required:!0,className:"w-full p-3 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none text-sm font-medium placeholder-gray-400 h-32",placeholder:"Please describe the details...",value:y,onChange:D=>L(D.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-1",children:"Attachment (Image)"}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("label",{className:"cursor-pointer bg-white border border-gray-300 hover:bg-gray-50 text-gray-600 px-4 py-2 rounded-lg text-sm font-medium transition shadow-sm",children:["Choose Image",r.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:B})]}),C&&r.jsx("span",{className:"text-xs text-green-600 font-bold",children:"Image Attached "})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{type:"submit",disabled:m,className:`px-6 py-3 rounded-xl font-bold text-white shadow-lg transition-all flex items-center gap-2
                                                ${m?"bg-indigo-400 cursor-wait":"bg-indigo-600 hover:bg-indigo-700 hover:scale-105"}
                                            `,children:[m?"Sending...":"Submit Ticket",r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})]})})]})})]}),o==="list"&&r.jsx("div",{className:"animate-fadeIn",children:a?r.jsx($m,{ticket:a,currentUser:t,isAdmin:U,isSuperAdmin:Y,onClose:()=>c(null),onStatusChange:X,onReassign:G,onReply:$,isSendingReply:P,agents:I}):r.jsx(Hm,{tickets:N,isLoading:w,onRefresh:()=>H(0),onSelect:c,isAdmin:U,filterStatus:d})})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl shadow-lg p-6 text-white relative overflow-hidden group",children:[r.jsx("div",{className:"absolute top-0 right-0 p-16 bg-white/5 rounded-full blur-2xl -translate-y-1/2 translate-x-1/2 group-hover:bg-white/10 transition-all"}),r.jsxs("div",{className:"relative z-10",children:[r.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2 text-white",children:[r.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Share System Access"]}),r.jsxs("button",{onClick:ie,className:"w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl shadow-lg transition-all flex items-center justify-center gap-2 group-hover:scale-[1.02]",children:[r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Share App & Login"]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[r.jsxs("h4",{className:"font-bold text-gray-800 mb-4 flex items-center gap-2",children:[r.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),"System Status"]}),r.jsxs("div",{className:"space-y-3 text-sm",children:[r.jsxs("div",{className:"flex justify-between border-b border-gray-50 pb-2",children:[r.jsx("span",{className:"text-gray-500",children:"Database"}),r.jsx("span",{className:"text-green-600 font-bold",children:"Connected"})]}),r.jsxs("div",{className:"flex justify-between border-b border-gray-50 pb-2",children:[r.jsx("span",{className:"text-gray-500",children:"Version"}),r.jsx("span",{className:"text-gray-800 font-medium",children:"2.4.7 (Fixed)"})]}),r.jsxs("div",{className:"flex justify-between pb-1",children:[r.jsx("span",{className:"text-gray-500",children:"Support Hours"}),r.jsx("span",{className:"text-gray-800 font-medium",children:"08:00 - 17:00"})]})]})]})]})]})]})},Gm=({user:e,appScriptUrl:t,settings:n,onSettingsUpdate:s,showToast:l})=>{const[o,i]=j.useState("info"),[a,c]=j.useState(""),[d,v]=j.useState(!1),[u,h]=j.useState(n.maintenanceMode||!1),[x,b]=j.useState(n.maintenanceMessage||"System under scheduled maintenance."),[y,L]=j.useState(!1),p=async()=>{if(!a.trim()){l("Please enter a message.","error");return}v(!0);try{await fetch(t,{method:"POST",body:JSON.stringify({action:"broadcast",type:o,message:a}),mode:"no-cors"}),l("Broadcast sent successfully!","success"),c("")}catch{l("Failed to send broadcast.","error")}finally{v(!1)}},f=async()=>{L(!0);try{await fetch(t,{method:"POST",body:JSON.stringify({action:"update_settings",companyName:n.companyName,managerEmail:n.managerEmail,companyLogo:n.companyLogo,mobileApkLink:n.mobileApkLink,webAppUrl:n.webAppUrl,maintenanceMode:u,maintenanceMessage:x})}),s({maintenanceMode:u,maintenanceMessage:x}),l("System status updated.","success")}catch{l("Failed to update system status.","error")}finally{L(!1)}},m=g=>{g==="upgrade"?(i("info"),c("System Upgrade scheduled for tonight at 22:00. Brief downtime expected.")):g==="downtime"?(i("critical"),c("Emergency Maintenance: System will be offline in 15 minutes. Please save your work.")):g==="restart"&&(i("warning"),c("Server restart initiated. Performance may be degraded for 5 minutes."))};return r.jsxs("div",{className:"max-w-5xl mx-auto animate-fadeIn pb-12 space-y-8",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[r.jsx("div",{className:"p-3 bg-red-600 rounded-xl shadow-lg text-white",children:r.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-black text-slate-900 tracking-tight",children:"Superadmin Console"}),r.jsx("p",{className:"text-slate-500 font-medium",children:"System Control & Emergency Broadcasts"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[r.jsx("div",{className:"space-y-6",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden",children:[r.jsxs("div",{className:"px-6 py-4 bg-slate-50 border-b border-slate-100 flex justify-between items-center",children:[r.jsxs("h3",{className:"font-bold text-slate-800 flex items-center gap-2",children:[r.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"})}),"Broadcast Alert"]}),r.jsx("span",{className:"text-[10px] font-bold bg-blue-100 text-blue-700 px-2 py-1 rounded uppercase",children:"All Users"})]}),r.jsxs("div",{className:"p-6 space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-2",children:"Message Content"}),r.jsx("textarea",{className:"w-full p-4 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none min-h-[120px] text-sm text-slate-700 bg-slate-50 font-medium placeholder-slate-400",placeholder:"Type your alert message here...",value:a,onChange:g=>c(g.target.value)})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-2",children:"Severity"}),r.jsx("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:["info","warning","critical"].map(g=>r.jsx("button",{onClick:()=>i(g),className:`flex-1 py-2 text-xs font-bold rounded-md capitalize transition-all
                                                    ${o===g?g==="info"?"bg-white text-blue-600 shadow-sm":g==="warning"?"bg-white text-amber-600 shadow-sm":"bg-white text-red-600 shadow-sm":"text-slate-400 hover:text-slate-600"}
                                                `,children:g},g))})]}),r.jsx("div",{className:"flex items-end",children:r.jsxs("button",{onClick:p,disabled:d,className:"h-[42px] px-6 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl shadow-lg transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-wait",children:[d?"Sending...":"Send Alert",r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})]})})]})]}),r.jsxs("div",{className:"bg-slate-50 px-6 py-3 border-t border-slate-100 flex gap-2 overflow-x-auto",children:[r.jsx("button",{onClick:()=>m("upgrade"),className:"px-3 py-1.5 bg-white border border-slate-200 rounded-lg text-xs font-bold text-slate-600 hover:border-blue-300 hover:text-blue-600 transition whitespace-nowrap",children:"Load: Scheduled Upgrade"}),r.jsx("button",{onClick:()=>m("downtime"),className:"px-3 py-1.5 bg-white border border-slate-200 rounded-lg text-xs font-bold text-slate-600 hover:border-red-300 hover:text-red-600 transition whitespace-nowrap",children:"Load: Emergency Downtime"}),r.jsx("button",{onClick:()=>m("restart"),className:"px-3 py-1.5 bg-white border border-slate-200 rounded-lg text-xs font-bold text-slate-600 hover:border-amber-300 hover:text-amber-600 transition whitespace-nowrap",children:"Load: Server Restart"})]})]})}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:`rounded-2xl shadow-sm border overflow-hidden transition-all ${u?"bg-red-50 border-red-200":"bg-white border-slate-200"}`,children:[r.jsxs("div",{className:`px-6 py-4 border-b flex justify-between items-center ${u?"bg-red-100 border-red-200":"bg-slate-50 border-slate-100"}`,children:[r.jsxs("h3",{className:`font-bold flex items-center gap-2 ${u?"text-red-800":"text-slate-800"}`,children:[r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})}),"System Lockdown"]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:`text-[10px] font-bold uppercase tracking-wider ${u?"text-red-600":"text-slate-400"}`,children:u?"Active":"Inactive"}),r.jsx("button",{onClick:()=>h(!u),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 ${u?"bg-red-600":"bg-slate-200"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${u?"translate-x-6":"translate-x-1"}`})})]})]}),r.jsxs("div",{className:"p-6 space-y-4",children:[r.jsxs("p",{className:"text-sm text-slate-600",children:["When active, only ",r.jsx("strong",{children:"SuperAdmins"})," can access the system. All other users will see a maintenance screen."]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-2",children:"Public Maintenance Message"}),r.jsx("input",{type:"text",className:`w-full p-3 border rounded-lg text-sm font-bold outline-none transition ${u?"bg-white border-red-300 text-red-900 focus:ring-red-500":"bg-slate-50 border-slate-300 text-slate-700"}`,value:x,onChange:g=>b(g.target.value)})]}),r.jsx("div",{className:"pt-2",children:r.jsx("button",{onClick:f,disabled:y,className:`w-full py-3 rounded-xl font-bold shadow-md transition-all flex items-center justify-center gap-2
                                        ${u?"bg-red-600 hover:bg-red-700 text-white shadow-red-200":"bg-slate-800 hover:bg-slate-900 text-white shadow-slate-200"}
                                    `,children:y?"Saving...":"Update System Status"})})]})]}),r.jsxs("div",{className:"bg-blue-50 p-6 rounded-2xl border border-blue-100",children:[r.jsx("h4",{className:"text-sm font-bold text-blue-900 mb-2",children:"Admin Tips"}),r.jsxs("ul",{className:"text-xs text-blue-700 space-y-2 list-disc pl-4",children:[r.jsx("li",{children:"Broadcasts appear instantly for online users."}),r.jsx("li",{children:"Critical alerts will show a red indicator on the notification bell."}),r.jsx("li",{children:"Lockdown mode does not affect SuperAdmins, allowing you to verify fixes before reopening."})]})]})]})]})]})},Km=({appScriptUrl:e,currentUser:t,showToast:n})=>{const[s,l]=j.useState([]),[o,i]=j.useState(!1);j.useEffect(()=>{a()},[t,e]);const a=async()=>{if(!(!e||!t)){i(!0);try{const x=(await(await fetch(`${e}?t=${new Date().getTime()}`)).json()).Inspection_Requests;if(x&&Array.isArray(x)&&x.length>1){const b=x.slice(1).map(y=>({id:y[0],requester:y[1],truck:y[3],trailer:y[4],type:y[5],reason:y[6],priority:y[7],assignedTo:y[8],status:y[9]||"Pending",timestamp:y[10]})).filter(y=>t.role==="Admin"||t.role==="SuperAdmin"?!0:String(y.requester).toLowerCase()===String(t.name).toLowerCase()).sort((y,L)=>new Date(L.timestamp).getTime()-new Date(y.timestamp).getTime());l(b)}else l([])}catch(u){console.error("Failed to fetch requests",u),n("Failed to load requests.","error")}finally{i(!1)}}},c=s.filter(u=>u.status==="Pending").length,d=s.filter(u=>u.status==="Completed").length,v=s.length>0?Math.round(d/s.length*100):0;return r.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 animate-fadeIn",children:[r.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-3xl font-black text-gray-800 flex items-center gap-3",children:[r.jsx("div",{className:"p-2 bg-indigo-100 text-indigo-700 rounded-xl",children:r.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}),"Track Requests"]}),r.jsx("p",{className:"text-gray-500 font-medium mt-1",children:"Monitor the status of your vehicle inspection requests."})]}),r.jsxs("button",{onClick:a,className:"px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 flex items-center gap-2 transition shadow-sm",children:[r.jsx("svg",{className:`w-4 h-4 ${o?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Status"]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-wide",children:"Pending"}),r.jsx("h3",{className:"text-3xl font-black text-amber-500",children:c})]}),r.jsx("div",{className:"w-10 h-10 rounded-full bg-amber-50 flex items-center justify-center text-amber-500",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),r.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-wide",children:"Completed"}),r.jsx("h3",{className:"text-3xl font-black text-emerald-600",children:d})]}),r.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-50 flex items-center justify-center text-emerald-600",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})})]}),r.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-wide",children:"Fulfilment Rate"}),r.jsxs("h3",{className:"text-3xl font-black text-indigo-600",children:[v,"%"]})]}),r.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-50 flex items-center justify-center text-indigo-600",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})]})]}),r.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:o?r.jsxs("div",{className:"p-12 text-center text-gray-400 flex flex-col items-center",children:[r.jsx("div",{className:"w-8 h-8 border-4 border-gray-200 border-t-indigo-500 rounded-full animate-spin mb-4"}),r.jsx("p",{children:"Updating status..."})]}):s.length===0?r.jsxs("div",{className:"p-16 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-300",children:r.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),r.jsx("h3",{className:"text-gray-800 font-bold mb-1",children:"No Requests Found"}),r.jsx("p",{className:"text-sm text-gray-500",children:"You haven't submitted any inspection requests yet."})]}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-left text-sm",children:[r.jsx("thead",{className:"bg-gray-50 text-xs font-bold text-gray-500 uppercase border-b border-gray-200",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-4",children:"Status"}),r.jsx("th",{className:"px-6 py-4",children:"Vehicle"}),r.jsx("th",{className:"px-6 py-4",children:"Type & Priority"}),r.jsx("th",{className:"px-6 py-4",children:"Inspector"}),r.jsx("th",{className:"px-6 py-4 text-right",children:"Date Requested"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-100",children:s.map(u=>r.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[r.jsx("td",{className:"px-6 py-4",children:u.status==="Completed"?r.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-bold bg-emerald-100 text-emerald-700 border border-emerald-200",children:[r.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),"Completed"]}):r.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-bold bg-amber-100 text-amber-700 border border-amber-200 animate-pulse",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500"}),"Pending"]})}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"font-bold text-gray-800",children:u.truck}),r.jsx("div",{className:"text-xs text-gray-500",children:u.trailer||"No Trailer"})]}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-xs font-bold text-gray-700",children:u.type}),r.jsx("div",{className:`text-[10px] font-bold uppercase mt-1 ${u.priority==="Critical"||u.priority==="Urgent"?"text-red-600":"text-gray-400"}`,children:u.priority})]}),r.jsx("td",{className:"px-6 py-4",children:u.assignedTo&&u.assignedTo!=="Unassigned"?r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-6 h-6 rounded-full bg-slate-200 flex items-center justify-center text-[10px] font-bold text-slate-600",children:u.assignedTo.charAt(0)}),r.jsx("span",{className:"text-gray-600",children:u.assignedTo})]}):r.jsx("span",{className:"text-gray-400 italic text-xs",children:"Pending Assignment"})}),r.jsxs("td",{className:"px-6 py-4 text-right text-gray-500 font-mono text-xs",children:[new Date(u.timestamp).toLocaleDateString(),r.jsx("div",{className:"text-[10px] opacity-60",children:new Date(u.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]},u.id))})]})})})]})},Qm=({queueLength:e,isSyncing:t,isPoorConnection:n,onRetry:s})=>{const[l,o]=j.useState(navigator.onLine);if(j.useEffect(()=>{const u=()=>o(!0),h=()=>o(!1);return window.addEventListener("online",u),window.addEventListener("offline",h),()=>{window.removeEventListener("online",u),window.removeEventListener("offline",h)}},[]),l&&e===0&&!t&&!n)return null;let i="bg-slate-900",a=r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),r.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500 absolute top-0 left-0 animate-ping opacity-75"})]}),c="You are offline",d="Data saved securely to device",v=!1;return t?(i="bg-blue-600",a=r.jsxs("svg",{className:"animate-spin w-5 h-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),c="Syncing Data...",d=`${e} records remaining`):n&&l?(i="bg-amber-600",a=r.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),c="Unstable Connection",d=`${e} pending uploads`,v=!0):e>0&&l?(i="bg-indigo-600",a=r.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),c="Uploads Pending",d=`${e} records waiting`,v=!0):!l&&e>0&&(i="bg-slate-800",c="Offline Mode",d=`${e} records saved locally`),r.jsxs("div",{className:`fixed bottom-4 left-4 z-[90] ${i} text-white px-4 py-3 rounded-lg shadow-xl flex items-center gap-4 animate-fadeIn border border-white/10 max-w-xs transition-colors duration-300`,children:[r.jsx("div",{className:"shrink-0",children:a}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-bold truncate",children:c}),r.jsx("div",{className:"text-[10px] opacity-80 font-medium truncate",children:d})]}),v&&r.jsx("button",{onClick:s,className:"shrink-0 bg-white/20 hover:bg-white/30 text-white text-xs font-bold px-3 py-1.5 rounded transition-colors",children:"Retry"})]})},qm=()=>{const{currentUser:e,setCurrentUser:t,handleLogin:n,handleLogout:s,sessionExpired:l,setSessionExpired:o}=xm(),{settings:i,setSettings:a,appScriptUrl:c,setAppScriptUrl:d,isSavingSettings:v,handleSaveSettings:u}=gm(),{subscription:h,isLocked:x}=bm(c,e);typeof window<"u"&&(window.isSubscriptionLocked=x);const[b,y]=j.useState("overview"),[L,p]=j.useState("dashboard"),[f,m]=j.useState(!1),[g,C]=j.useState(!1),[R,N]=j.useState(null),[k,I]=j.useState(null),[E,w]=j.useState(!1),{historyList:S,isLoadingHistory:P,isBackgroundFetching:M,validationLists:U,stats:Y,fetchHistory:Q}=ym(c,b,e),_=(A,re)=>{I({message:A,type:re}),setTimeout(()=>I(null),4e3)};j.useEffect(()=>{l==="idle"?(_("Session expired due to inactivity.","warning"),o(null)):l==="max_duration"&&(_("Session limit reached. Please log in again.","info"),o(null))},[l]);const{submissionStatus:W,setSubmissionStatus:B,offlineQueue:H,isSyncing:F,isPoorConnection:$,syncOfflineQueue:X,addToQueue:G}=vm(c,_,()=>Q(!0)),{notifications:ie,fetchNotifications:D,handleMarkNotificationRead:K,handleDismissNotification:te,handleGlobalAcknowledge:Z,handleClearAllNotifications:ge}=bu(c,e,_),[it,Kt]=j.useState(!1),[Qt,wu]=j.useState(null),[ju,Ti]=j.useState(!1),[St,Ai]=j.useState(null),[pt,Pi]=j.useState(Ka),[Nu,ul]=j.useState(!1),[ku,zn]=j.useState(!1);j.useEffect(()=>{var A,re,Ce;if(e){const Ke=((A=e.preferences)==null?void 0:A.mustChangePassword)===!0,at=((re=e.preferences)==null?void 0:re.isEmailVerified)!==!0;Ke||at?ul(!0):((Ce=e.preferences)==null?void 0:Ce.hasCompletedTour)!==!0&&zn(!0)}else ul(!1),zn(!1)},[e]);const Su=async A=>{var Ce;const re={...A,preferences:{emailNotifications:!1,...A.preferences,hasCompletedTour:!0}};t(re),localStorage.setItem("safetyCheck_user",JSON.stringify(re)),ul(!1),((Ce=re.preferences)==null?void 0:Ce.hasCompletedTour)!==!0&&setTimeout(()=>zn(!0),500)},Cu=async()=>{if(!e)return;const A={...e,preferences:{emailNotifications:!1,...e.preferences,hasCompletedTour:!0}};if(t(A),localStorage.setItem("safetyCheck_user",JSON.stringify(A)),zn(!1),c)try{await fetch(c,{method:"POST",body:JSON.stringify({action:"update_user",originalUsername:A.username,preferences:A.preferences}),mode:"no-cors"})}catch{}};j.useEffect(()=>{if(e){const A=e.role||"",re=A==="Admin"||A==="SuperAdmin",Ce=A==="SuperAdmin";!re&&(b==="settings"||b==="users")&&(_("Access Restricted to Admins.","error"),y("overview")),!Ce&&b==="maintenance"&&(_("Access Restricted to SuperAdmins.","error"),y("overview"))}},[b,e]),j.useEffect(()=>{if(!e||!c)return;(()=>{navigator.onLine&&(D(),H.length>0&&X(),Q(!1))})();const re=setInterval(()=>{navigator.onLine&&D()},3e4);return()=>clearInterval(re)},[e,c]);const Bn=A=>`sc_draft_${e?`${e.username}_`:"anon_"}${A}`,Mi=A=>!!localStorage.getItem(Bn(A)),Lu=A=>{const re=localStorage.getItem(Bn(A));if(re)try{return JSON.parse(re)}catch{return null}return null},Vn=A=>localStorage.removeItem(Bn(A)),Fn=A=>{if(x){_("Subscription Expired. Cannot start inspection.","error");return}Mi(A)?(wu(A),Kt(!0)):qt(A)},qt=(A,re)=>{Vn(A),Pi({...Ka,timestamp:new Date().toISOString(),inspectedBy:(e==null?void 0:e.name)||"",...re}),p("form")},Eu=A=>{const re=Lu(A);re?(Pi(re),p("form"),_("Draft resumed.","info")):(_("Failed to load draft. Starting new.","error"),qt(A))},Di=A=>{A&&(localStorage.setItem(Bn(b),JSON.stringify(A)),_("Draft saved successfully.","success")),p("dashboard")},Iu=async A=>{if(c)try{await fetch(c,{method:"POST",body:JSON.stringify({action:"request_inspection",requester:e==null?void 0:e.name,role:e==null?void 0:e.role,truckNo:A.truckNo,trailerNo:A.trailerNo,type:A.type,priority:A.priority,reason:A.reason,assignedInspector:A.assignedInspector||""}),mode:"no-cors"}),_("Inspection request sent to inspectors.","success")}catch{_("Failed to submit request.","error")}},Ru=async A=>{if(e!=null&&e.role&&!["Admin","Inspector","SuperAdmin"].includes(e.role)){_("Access Denied: View Only Account.","error");return}if(!c){_("System Not Connected. Please configure Settings.","error"),y("settings");return}B("submitting");const re=crypto.randomUUID();let Ce="General",Ke=xu,at=[],Ve="General Inspection Report";b==="petroleum"?(Ce="Petroleum",Ke=gu,Ve="Petroleum Tanker Inspection",at=il.map(le=>({category:le.category,label:le.label,status:String(A[le.id]||"N/A")}))):b==="petroleum_v2"?(Ce="Petroleum_V2",Ke=yu,Ve="Petroleum Tanker Inspection V2",at=al.map(le=>({category:le.category,label:le.label,status:String(A[le.id]||"N/A")}))):b==="acid"?(Ce="Acid",Ke=vu,Ve="Acid Tanker Inspection",at=rr.map(le=>({category:le.category,label:le.label,status:String(A[le.id]||"N/A")}))):at=ol.map(le=>({category:le.category,label:le.label,status:String(A[le.id]||"N/A")}));const Hr={title:Ve,truckNo:A.truckNo,trailerNo:A.trailerNo,jobCard:A.jobCard||"N/A",driverName:A.driverName,inspectedBy:A.inspectedBy,location:A.location,odometer:A.odometer,timestamp:A.timestamp,remarks:A.remarks,rate:A.rate,items:at,signatures:{inspector:A.inspectorSignature,driver:A.driverSignature},photos:{front:A.photoFront,ls:A.photoLS,rs:A.photoRS,back:A.photoBack,damage:A.photoDamage},companyName:i.companyName,companyLogo:i.companyLogo},fl=Ke.map(le=>{if(le==="id")return re;const Ct=A[le];return Ct??""}),$r={sheet:Ce,action:"create",row:fl,headers:Ke,id:re,reportData:Hr,requestId:A.requestId};if(!navigator.onLine){G($r),Vn(b),B("offline_saved"),setTimeout(()=>{qt(b),p("dashboard"),B("idle"),_("Offline Mode: Report Saved. Will sync when online.","info")},2e3);return}try{const le=new AbortController,Ct=setTimeout(()=>le.abort(),15e3);await fetch(c,{method:"POST",body:JSON.stringify($r),mode:"no-cors",headers:{"Content-Type":"text/plain"},signal:le.signal}),clearTimeout(Ct),Vn(b),B("success"),setTimeout(()=>{qt(b),p("dashboard"),B("idle"),Q(!0),D(),_(A.requestId?"Request Fulfilled & Report Submitted!":"Inspection Submitted & Email Sent!","success")},2500)}catch(le){console.error("Submission Error",le),G($r),Vn(b),B("offline_saved");const ml=le.name==="AbortError"?"Slow Network detected. Saved to offline queue.":"Network Error. Report queued for auto-sync.";setTimeout(()=>{qt(b),p("dashboard"),B("idle"),_(ml,"warning")},2500)}},_u=()=>window.print(),Wn=A=>{Ai(A),setTimeout(()=>window.print(),500)},Wr=A=>{Ai(A),Ti(!0)},Tu=(A,re)=>{K(A,Ce=>{var at;const Ke=ie.find(Ve=>Ve.id===A);if((at=Ke==null?void 0:Ke.actionLink)!=null&&at.startsWith("request:start_inspection")){const Ve=Ke.actionLink.split("|"),Hr=Ve[1].toLowerCase(),fl=Ve[2],$r=Ve[3],le=Ve[4],Ct=Ve[5],ml=Ve[6]||"";let Ur="general";Hr.includes("petroleum_v2")?Ur="petroleum_v2":Hr.includes("petroleum")?Ur="petroleum":Hr.includes("acid")&&(Ur="acid"),y(Ur),qt(Ur,{truckNo:fl,trailerNo:$r,remarks:`** AD-HOC REQUEST **
Initiated by: ${le}
Reason: ${Ct}`,requestId:ml}),_("Starting requested inspection...","info")}else re?re(Ce):(y(Ce),p("dashboard"))})};if(!e)return r.jsxs(r.Fragment,{children:[r.jsx(Xa,{}),k&&r.jsx(Ya,{message:k.message,type:k.type,onClose:()=>I(null)}),r.jsx(Am,{onLogin:n,appScriptUrl:c,setAppScriptUrl:d,settings:i})]});if(Nu&&e)return r.jsx(_m,{user:e,appScriptUrl:c,onComplete:Su});const Au=["Admin","Maintenance","Inspector","SuperAdmin"].includes(e.role||""),Oi=e.role==="SuperAdmin",Pu=i.maintenanceMode&&!Oi;return r.jsxs("div",{className:"min-h-screen bg-gray-50 font-sans text-gray-900 relative",children:[r.jsx(Xa,{}),r.jsx(Nm,{status:W}),ku&&r.jsx(Tm,{onComplete:Cu}),r.jsx(Im,{isActive:!!Pu,message:i.maintenanceMessage||"",onLogout:()=>s()}),r.jsx(Qm,{queueLength:H.length,isSyncing:F,isPoorConnection:$,onRetry:X}),k&&r.jsx(Ya,{message:k.message,type:k.type,onClose:()=>I(null)}),r.jsx(Rm,{isOpen:E,onClose:()=>w(!1),onSubmit:Iu,validationLists:U,currentUserRole:e.role||""}),r.jsx(Lm,{isOpen:it,onClose:()=>Kt(!1),moduleName:Qt||"General",hasDraft:!!Qt&&Mi(Qt),onStartNew:()=>{Qt&&qt(Qt),Kt(!1)},onResume:()=>{Qt&&Eu(Qt),Kt(!1)}}),R&&r.jsx(Cm,{featureName:R,onClose:()=>N(null)}),g&&e&&r.jsx(km,{user:e,appScriptUrl:c,onClose:()=>C(!1),showToast:_,onUpdateSuccess:A=>{t(A),localStorage.setItem("safetyCheck_user",JSON.stringify(A))}}),ju&&r.jsx(jm,{onClose:()=>Ti(!1),onPrint:_u,title:"Inspection Report",children:r.jsx("div",{className:"print-only-container",children:b==="petroleum"?r.jsx(Mo,{data:St||pt,settings:i}):b==="petroleum_v2"?r.jsx(Do,{data:St||pt,settings:i}):b==="acid"?r.jsx(Oo,{data:St||pt,settings:i}):r.jsx(Po,{data:St||pt,settings:i})})}),r.jsx("div",{className:"print-only hidden p-0 bg-white",children:b==="petroleum"?r.jsx(Mo,{data:St||pt,settings:i}):b==="petroleum_v2"?r.jsx(Do,{data:St||pt,settings:i}):b==="acid"?r.jsx(Oo,{data:St||pt,settings:i}):r.jsx(Po,{data:St||pt,settings:i})}),r.jsxs("div",{className:"relative z-10 bg-gray-50 min-h-screen",children:[r.jsx(wm,{isOpen:f,onClose:()=>m(!1),activeModule:b,onSelectModule:A=>{y(A),p("dashboard")},onLockedItemClick:A=>N(A),settings:i,user:e,onLogout:()=>s(),onEditProfile:()=>C(!0),subscription:h,onRequestInspection:()=>{Q(!1),w(!0)}}),r.jsxs("div",{className:"lg:pl-64 min-h-screen flex flex-col transition-all duration-300",children:[r.jsx(Em,{subscription:h,user:e,onManage:()=>{y("settings"),p("dashboard")}}),r.jsx("header",{className:"bg-emerald-950 border-b border-emerald-900 sticky top-0 z-40 shadow-sm",children:r.jsxs("div",{className:"px-4 py-3 flex justify-between items-center text-white",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{id:"sidebar-toggle",onClick:()=>m(!0),className:"lg:hidden p-1 hover:bg-slate-800 rounded",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("h1",{className:"text-lg md:text-xl font-bold flex items-center gap-2",children:b==="overview"?"Executive Dashboard":b==="petroleum"?"Petroleum V1":b==="petroleum_v2"?"Petroleum V2":b==="acid"?"Acid":b==="settings"?"System":b==="users"?"Users":b==="support"?"Support Hub":b==="track_requests"?"My Requests":b==="maintenance"?"Superadmin Console":"SafetyCheck"}),M&&r.jsx("div",{className:"flex items-center gap-1.5 text-[10px] text-emerald-300 animate-pulse",children:"Checking for updates..."})]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[H.length>0&&r.jsx("button",{id:"sync-status-btn",onClick:X,disabled:F,className:`hidden md:flex items-center gap-2 px-3 py-1 rounded-full text-xs font-bold transition-all shadow-sm
                                ${F?"bg-blue-600 text-white cursor-wait":$?"bg-red-500 text-white hover:bg-red-600 animate-pulse":"bg-amber-500 text-white hover:bg-amber-600"}
                            `,children:F?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"animate-spin w-3 h-3",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r.jsx("span",{children:"Syncing..."})]}):r.jsx("span",{children:$?"Retry Upload":`Pending (${H.length})`})}),r.jsx("div",{id:"notification-bell",children:r.jsx(Sm,{notifications:ie,onMarkAsRead:A=>Tu(A,re=>{y(re),p("dashboard")}),onDismiss:te,onClearAll:ge,onAcknowledge:Z,canAcknowledge:Au})})]})]})}),L==="form"?r.jsx(Wm,{initialData:pt,activeModule:b,validationLists:U,settings:i,onSaveDraft:Di,onExit:()=>Di(),onSubmit:Ru,submissionStatus:W,onViewReport:Wr}):r.jsxs("main",{className:"flex-1 p-4 md:p-6 lg:p-8 max-w-6xl mx-auto w-full",children:[b==="overview"&&r.jsx(Fm,{appScriptUrl:c,onNavigate:A=>{y(A),p("dashboard")},userRole:e==null?void 0:e.role}),b==="settings"&&r.jsx(Pm,{settings:i,setSettings:a,appScriptUrl:c,setAppScriptUrl:d,handleSaveSettings:u,isSavingSettings:v,showToast:_,user:e}),b==="users"&&r.jsx(Vm,{currentUser:e,appScriptUrl:c,showToast:_,validationLists:U,settings:i}),b==="support"&&r.jsx(Um,{appScriptUrl:c,currentUser:e,showToast:_,settings:i,validationLists:U}),b==="track_requests"&&r.jsx(Km,{appScriptUrl:c,currentUser:e,showToast:_}),b==="maintenance"&&Oi&&r.jsx(Gm,{user:e,appScriptUrl:c,settings:i,onSettingsUpdate:A=>a(re=>({...re,...A})),showToast:_}),b==="general"&&r.jsx(Dm,{stats:Y,startNewInspection:()=>Fn("general"),fetchHistory:()=>Q(!0),isLoadingHistory:P,historyList:S,onViewReport:Wr,onPrint:Wn,userRole:e==null?void 0:e.role}),b==="petroleum"&&r.jsx(Om,{stats:Y,startNewInspection:()=>Fn("petroleum"),fetchHistory:()=>Q(!0),isLoadingHistory:P,historyList:S,onViewReport:Wr,onPrint:Wn,userRole:e==null?void 0:e.role}),b==="petroleum_v2"&&r.jsx(zm,{stats:Y,startNewInspection:()=>Fn("petroleum_v2"),fetchHistory:()=>Q(!0),isLoadingHistory:P,historyList:S,onViewReport:Wr,onPrint:Wn,userRole:e==null?void 0:e.role}),b==="acid"&&r.jsx(Bm,{stats:Y,startNewInspection:()=>Fn("acid"),fetchHistory:()=>Q(!0),isLoadingHistory:P,historyList:S,onViewReport:Wr,onPrint:Wn,userRole:e==null?void 0:e.role})]})]})]})]})},tc=document.getElementById("root");tc&&hu(tc).render(r.jsx(qm,{}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js").then(e=>{console.log("ServiceWorker registration successful with scope: ",e.scope)}).catch(e=>{console.log("ServiceWorker registration failed: ",e)})});
